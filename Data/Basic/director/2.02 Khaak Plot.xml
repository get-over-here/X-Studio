<?xml version="1.0" encoding="ISO-8859-1" ?>
<?xml-stylesheet href="director.xsl" type="text/xsl" ?>
<director name="template" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="director.xsd">
  <documentation>
    <author name="Al Main, Owen Lake" alias="al_main, Xenon_Slayer" contact="e-mail: al_main@hotmail.com, E-Mail: Owen_Lake@eogsoft.com Skype: Owen Lake"/>
    <content reference="L2M02" name="Khaak Plot" description="Khaak Plot"/>
    <version number="0.1" date="12/04/2008" status="release"/>
  </documentation>
  <cues>
    <cue name="L2M02" library="1">
      <documentation>
        <content reference="L2M002" name="Khaak Plot"  type="L2"/>
        <version number="0.1" date="12/04/2008" status="release"/>
        <history>
          <change date="07/09/08" author="al_main" description="remove_briefing and incoming message added at line 2169 - 2171 added"/>
          <change date="31/08/08" author="al_main" description="Adjusted enemy limits for khaak ships created by L2M02 US Create"/>
          <change date="29/08/08" author="al_main" description="RC6 version"/>
          <change date="26/08/08" author="al_main" description="Adjusted eq dock search to search for typename instead of class
            Adjusted talk to objectives to dock at"/>
          <change date="21/08/08" author="al_main" description="Removed exact attributes from count_ conditions
            Re-balanced mission rank increases, EQ now set as friend aswell as factories, fixed priority of play_text in 5B
            Aded OBS min points in 5b. Fixed object name passed to 0.35. Adjustment to hidden base position and khaak station location.
            L2M02 HiddenBase now highlighted"/>
          <change date="20/08/08" author="al_main" description="Added flyby group in scene6, readded sc5A
            Fixed Sc2St2 reward, fixed briefing of docking at base after picking up data recorder, added bonus param to 0.8
            Scan: High Yield asteroid now Find: High Yield Asteroid, Scene3 reward added, fixed delay in Sc3St2 Enemy Check
            Adjjusted unknown sector khaak positions, and obs max points. Sector check added before starting scene6
            Destsector param added in Sc5stA, sc5stA title fixed. Added escort/convoy tags to sc4 ships"/>
          <change date="19/08/08" author="al_main" description="Adjusted all briefing backgrounds to match missions
            adjusted rewards to end of sc2, added return to command objective after picking up jesans data recorder
            0.8 used instead of 0.35 in scene6"/>
          <change date="18/08/08" author="al_main" description="Fixed scene4 title and description"/>
          <change date="17/08/08" author="al_main" description="Fixed Scene4, Scene5 0.19 step params, upped scan asteroid mission to average"/>
          <change date="15/08/08" author="al_main" description="Improved voice timing in scene1 xenon invasion, adjusted attack position to look better
            changed object names towork with COM01, added OfferRace params to L0M19, added tunings to convoy ships"/>
          <change date="14/08/08" author="al_main" description="Increased khaak activity in sc3, brought roids closer to ecliptic
            added enemies to attack the TL, added speed and rudder to TL, adjusted destination positions of TL and roid 1 position
            improved mine building code, reordered sc4 and 5 progress value for debug purposes, missing speech 282402 added
            282403 used when not spoken, fixed. Fixed postioning of Sc 6 and 7 cues, fixed sc5 to use same docking system as rest of plot"/>
          <change date="13/08/08" author="al_main" description="Adjusted khaak positions in Unknown Sector, added L2M02 Sc3 St2 TL IS
            adjusted objectie updates in sc3, fixed exact bug in L2M02 Sc3 St2 TL Orders"/>
          <change date="13/08/08" author="al_main" description="Added cue for fly to sector objective in sc3"/>
          <change date="12/08/08" author="al_main" description="Starting mission now fails when attacking Jesan
          Scene 1 Xenon now not talked about till entered the sector, fixed play_text priorities, base now known when needed to dock there
          Fixed timing on L2M02 Sc2 St2 so T'Scct's voice is heard, moved corvettes away from sector centre at start of scene2 missions
          Added ECells incase player jumps without enought to get back, lasertowers in military sector now friendly too
          Fixed timings in Scene2, fixed missing set_objective in sc3, reordered progress value for debug purposes"/>
          <change date="12/08/08" author="al_main" description="L2M02 Unknown Sector now used for OBS cue to preserve the list"/>
          <change date="11/08/08" author="al_main" description="Fixed khaak ship positioning in unknown sector"/>
          <change date="06/08/08" author="al_main" description="Fixed killenemiesrangeland -> killenemiesland"/>
          <change date="06/08/08" author="al_main" description="Speeded up scene5, added rank increase to other scenes, fixed TeSaat's location"/>
          <change date="06/08/08" author="al_main" description="Added 'bonus' debris in minefield for player to collect as reward"/>
          <change date="05/08/08" author="al_main" description="Base uses new military outpost, added backup, set station shields to default"/>
          <change date="04/08/08" author="al_main" description="Fixed incorrect mission title and khaak sector names, added map help text"/>
          <change date="04/08/08" author="al_main" description="Removed timing cue so ships created earlier"/>
          <change date="25/07/08" author="al_main" description="Fixed 'valu@' typo, sc6 fixed"/>
          <change date="23/07/08" author="al_main" description="Removed extra param in L2M02 Sc4 St1"/>
          <change date="23/07/08" author="al_main" description="RC2 version"/>
          <change date="22/07/08" author="al_main" description="Added tunings to all fighters"/>
          <change date="21/07/08" author="al_main" description="Added khaak sectors known at correct times"/>
          <change date="18/07/08" author="al_main" description="Added tunings to Jesan's ship"/>
          <change date="02/07/08" author="al_main" description="Fixed mine positioning, unlinked return to base objective from briefing at sc3 start"/>
        </history>
        <todo>
          <item priority="medium" description="STATION BUILDING CUTSCENENE AT L2M02 Sc3 St2 TL Build?"/>
          <item priority="low" description="Add fight rank back in to L2M02 Start Plot Offer"/>
          <item priority="trivial" description="Is 'L2M02 Jesan Destroyed' needed?"/>
        </todo>
      </documentation>
      <action>
        <do_all>
          <find_sector name="L2M02.BHS" x="15" y="6"/>
          <find_gate name="L2M02.BHSNorthGate" gate="north">
            <sector sector="L2M02.BHS"/>
            <jumps exact="0"/>
          </find_gate>
          <find_sector name="L2M02.UnkSec" x="14" y="7"/>
          <find_gate name="L2M02.UnkSecEG" gate="east">
            <sector x="14" y="7"/>
            <jumps exact="0"/>
          </find_gate>
          <find_gate name="L2M02.UnkSecSG" gate="south">
            <sector x="14" y="7"/>
            <jumps exact="0"/>
          </find_gate>
          <find_sector name="L2M02.KhaakSec1" x="16" y="11"/>
          <find_sector name="L2M02.KhaakSec2" x="14" y="12"/>
          <find_sector name="L2M02.KhaakSec3" x="15" y="13"/>
          <find_sector name="L2M02.NathansVoyage" x="15" y="7"/>
          <find_sector name="L2M02.MS148" x="14" y="8"/>
          <find_gate name="L2M02.MS148NG" gate="north">
            <sector x="14" y="8"/>
            <jumps exact="0"/>
          </find_gate>
          <find_station name="L2M02.Base" typename="SS_DOCK_A_MILITARY" race="argon" nearest="1" >
            <position x="-6781250" y="-812500" z="-3468750"/>
            <sector x="14" y="8"/>
            <jumps exact="0"/>
            <distance min="0" max="5km"/>
          </find_station>
          <do_if value="{object.exists@L2M02.Base}" exact="0">
            <create_station name="L2M02.Base" typename="SS_DOCK_A_MILITARY" race="argon">
              <position x="-6781250" y="-812500" z="-3468750" exact="0"/>
              <sector x="14" y="8"/>
              <equipment loadout="default"/>
            </create_station>
          </do_if>
          <set_override_name object="L2M02.Base" textid="16021"/>
          <set_invincible object="L2M02.Base" invincible="1"/>
          <set_value name="L2M02.PlotProgress" exact="0"/>
          <set_value name="L2M02.USKhaakAmt" exact="2"/>
          <set_value name="L2M02.MSKhaakAmt" exact="0"/>
          <create_actor name="L2M02.TeSaat" character="{3895,28}" face="304" race="split" voice="3828"/>
          <!--find and remove roids so player cant scan them before plot-->
          <find_asteroid name="L2M02.Roid1" nearest="1">
            <position x="13431103" y="1569196" z="24468251"/>
            <sector x="14" y="7"/>
          </find_asteroid>
          <find_asteroid name="L2M02.Roid3" nearest="1">
            <position x="-27651370" y="-9928641" z="-15012753"/>
            <sector x="14" y="7"/>
          </find_asteroid>
          <find_asteroid name="L2M02.Roid2" nearest="1">
            <position x="-5216350" y="-15907361" z="26305085"/>
            <sector x="14" y="7"/>
          </find_asteroid>
          <destroy_object object="L2M02.Roid1"/>
          <destroy_object object="L2M02.Roid2"/>
          <destroy_object object="L2M02.Roid3"/>
        </do_all>
      </action>
      <cues>
        <cue name="L2M02 Khaak Plot" delay="500">
          <condition>
            <cue_is_complete cue="L2M02"/>
          </condition>
          <action>
            <do_all>
              <find_gate name="this.gate">
                <sector x="13" y="6"/>
                <jumps exact="0"/>
              </find_gate>
              <do_if value="{object.sector@this.gate}" exact="{player.sector}">
                <do_if value="{object.destination.exists@this.gate}" exact="1">
                  <set_object name="this.gate" value="{object.destination@this.gate}"/>
                </do_if>
              </do_if>
              <do_choose>
                <do_when value="{object.exists@L2M02.Exterminator}" exact="1">
                  <set_command object="L2M02.Exterminator" command="moveposition">
                    <position x="0" min="2km" max="3km"/>
                    <sector x="13" y="6"/>
                  </set_command>
                </do_when>
                <do_otherwise>
                  <create_ship name="L2M02.Exterminator" group="L2M02.Fighters" typename="SS_SH_A_M4P_ENH" textid="13471" capturable="0" race="argon" invincible="1" highlight="1">
                    <position object="this.gate" min="50" max="100m"/>
                    <sector sector="{object.sector@this.gate}"/>
                    <equipment loadout="maximum"/>
                    <command command="moveposition">
                      <position x="0" min="2km" max="5km"/>
                      <sector x="13" y="6"/>
                    </command>
                    <pilot aggression="90" fightskill="99" morale="99"/>
                  </create_ship>
                  <add_equipment object="L2M02.Exterminator">
                    <ware typename="SS_WARE_TECH213" exact="{object.equipment.SS_WARE_TECH213.maxcount@L2M02.Exterminator}-{object.equipment.SS_WARE_TECH213.count@L2M02.Exterminator}+2"/>
                  </add_equipment>
                  <create_actor name="L2M02.Jesan" character="{3895,27}" face="122" voice="3827" gender="male" race="argon" object="L2M02.Exterminator" location="pilot"/>
                </do_otherwise>
              </do_choose>
              <do_choose>
                <do_when value="{object.exists@L2M02.Fighters 2}" exact="1">
                  <set_command object="L2M02.Fighters 2" command="moveposition">
                    <position x="0" min="2km" max="3km"/>
                    <sector x="13" y="6"/>
                  </set_command>
                </do_when>
                <do_otherwise>
                  <create_ship name="L2M02.Fighters 2" group="L2M02.Fighters" typename="SS_SH_A_M3P" capturable="0" race="argon">
                    <position object="this.gate" min="50" max="100m"/>
                    <sector sector="{object.sector@this.gate}"/>
                    <equipment loadout="maximum"/>
                    <command command="moveposition">
                      <position x="0" min="2km" max="5km"/>
                      <sector x="13" y="6"/>
                    </command>
                    <pilot jobtextid="60006"/>
                  </create_ship>
                  <add_equipment object="L2M02.Fighters 2">
                    <ware typename="SS_WARE_TECH213" exact="{object.equipment.SS_WARE_TECH213.maxcount@L2M02.Fighters 2}-{object.equipment.SS_WARE_TECH213.count@L2M02.Fighters 2}+2"/>
                  </add_equipment>
                </do_otherwise>
              </do_choose>
              <do_choose>
                <do_when value="{object.exists@L2M02.Fighters 3}" exact="1">
                  <set_command object="L2M02.Fighters 3" command="moveposition">
                    <position x="0" min="2km" max="3km"/>
                    <sector x="13" y="6"/>
                  </set_command>
                </do_when>
                <do_otherwise>
                  <create_ship name="L2M02.Fighters 3" group="L2M02.Fighters" typename="SS_SH_B_M4P" capturable="0" race="boron">
                    <position object="this.gate" min="50" max="100m"/>
                    <sector sector="{object.sector@this.gate}"/>
                    <equipment loadout="maximum"/>
                    <command command="moveposition">
                      <position x="0" min="2km" max="5km"/>
                      <sector x="13" y="6"/>
                    </command>
                    <pilot jobtextid="60006"/>
                  </create_ship>
                  <add_equipment object="L2M02.Fighters 3">
                    <ware typename="SS_WARE_TECH213" exact="{object.equipment.SS_WARE_TECH213.maxcount@L2M02.Fighters 3}-{object.equipment.SS_WARE_TECH213.count@L2M02.Fighters 3}"/>
                  </add_equipment>
                </do_otherwise>
              </do_choose>
              <do_choose>
                <do_when value="{object.exists@L2M02.Fighters 4}" exact="1">
                  <set_command object="L2M02.Fighters 4" command="moveposition">
                    <position x="0" min="2km" max="3km"/>
                    <sector x="13" y="6"/>
                  </set_command>
                </do_when>
                <do_otherwise>
                  <create_ship name="L2M02.Fighters 4" group="L2M02.Fighters" typename="SS_SH_S_M3_1" capturable="0" race="split">
                    <position object="this.gate" min="50" max="100m"/>
                    <sector sector="{object.sector@this.gate}"/>
                    <equipment loadout="maximum"/>
                    <command command="moveposition">
                      <position x="0" min="2km" max="5km"/>
                      <sector x="13" y="6"/>
                    </command>
                    <pilot jobtextid="60007"/>
                  </create_ship>
                  <add_equipment object="L2M02.Fighters 4">
                    <ware typename="SS_WARE_TECH213" exact="{object.equipment.SS_WARE_TECH213.maxcount@L2M02.Fighters 4}-{object.equipment.SS_WARE_TECH213.count@L2M02.Fighters 4}"/>
                  </add_equipment>
                </do_otherwise>
              </do_choose>
              <do_choose>
                <do_when value="{object.exists@L2M02.Fighters 5}" exact="1">
                  <set_command object="L2M02.Fighters 5" command="moveposition">
                    <position x="0" min="2km" max="3km"/>
                    <sector x="13" y="6"/>
                  </set_command>
                </do_when>
                <do_otherwise>
                  <create_ship name="L2M02.Fighters 5" group="L2M02.Fighters" typename="SS_SH_T_M4_2" capturable="0" race="teladi">
                    <position object="this.gate" min="50" max="100m"/>
                    <sector sector="{object.sector@this.gate}"/>
                    <equipment loadout="maximum"/>
                    <command command="moveposition">
                      <position x="0" min="2km" max="5km"/>
                      <sector x="13" y="6"/>
                    </command>
                    <pilot jobtextid="60007"/>
                  </create_ship>
                  <add_equipment object="L2M02.Fighters 5">
                    <ware typename="SS_WARE_TECH213" exact="{object.equipment.SS_WARE_TECH213.maxcount@L2M02.Fighters 5}-{object.equipment.SS_WARE_TECH213.count@L2M02.Fighters 5}"/>
                  </add_equipment>
                </do_otherwise>
              </do_choose>
              <do_choose>
                <do_when value="{object.exists@L2M02.Fighters 6}" exact="1">
                  <set_command object="L2M02.Fighters 6" command="moveposition">
                    <position x="0" min="2km" max="3km"/>
                    <sector x="13" y="6"/>
                  </set_command>
                </do_when>
                <do_otherwise>
                  <create_ship name="L2M02.Fighters 6" group="L2M02.Fighters" typename="SS_SH_T_M3P" capturable="0" race="teladi">
                    <position object="this.gate" min="50" max="100m"/>
                    <sector sector="{object.sector@this.gate}"/>
                    <equipment loadout="maximum"/>
                    <command command="moveposition">
                      <position x="0" min="2km" max="5km"/>
                      <sector x="13" y="6"/>
                    </command>
                    <pilot jobtextid="60006"/>
                  </create_ship>
                  <add_equipment object="L2M02.Fighters 6">
                    <ware typename="SS_WARE_TECH213" exact="{object.equipment.SS_WARE_TECH213.maxcount@L2M02.Fighters 6}-{object.equipment.SS_WARE_TECH213.count@L2M02.Fighters 6}+3"/>
                  </add_equipment>
                </do_otherwise>
              </do_choose>
              <do_choose>
                <do_when value="{object.exists@L2M02.Fighters 7}" exact="1">
                  <set_command object="L2M02.Fighters 7" command="moveposition">
                    <position x="0" min="2km" max="3km"/>
                    <sector x="13" y="6"/>
                  </set_command>
                </do_when>
                <do_otherwise>
                  <create_ship name="L2M02.Fighters 7" group="L2M02.Fighters" typename="SS_SH_P_M3P_PROTO" race="paranid">
                    <position object="this.gate" min="50" max="100m"/>
                    <sector sector="{object.sector@this.gate}"/>
                    <equipment loadout="maximum"/>
                    <command command="moveposition">
                      <position x="0" min="2km" max="5km"/>
                      <sector x="13" y="6"/>
                    </command>
                    <pilot jobtextid="60007"/>
                  </create_ship>
                  <add_equipment object="L2M02.Fighters 7">
                    <ware typename="SS_WARE_TECH213" exact="{object.equipment.SS_WARE_TECH213.maxcount@L2M02.Fighters 7}-{object.equipment.SS_WARE_TECH213.count@L2M02.Fighters 7}+1"/>
                  </add_equipment>
                </do_otherwise>
              </do_choose>
              <do_choose>
                <do_when value="{object.exists@L2M02.Fighters 8}" exact="1">
                  <set_command object="L2M02.Fighters 8" command="moveposition">
                    <position x="0" min="2km" max="3km"/>
                    <sector x="13" y="6"/>
                  </set_command>
                </do_when>
                <do_otherwise>
                  <create_ship name="L2M02.Fighters 8" group="L2M02.Fighters" typename="{random.type@SS_SH_B_M4|SS_SH_B_M4_1|SS_SH_B_M4_2|SS_SH_B_M3|SS_SH_B_M5_1}" capturable="0" race="boron">
                    <position object="this.gate" min="50" max="100m"/>
                    <sector sector="{object.sector@this.gate}"/>
                    <equipment loadout="maximum"/>
                    <command command="moveposition">
                      <position x="0" min="2km" max="5km"/>
                      <sector x="13" y="6"/>
                    </command>
                    <pilot jobtextid="60006"/>
                  </create_ship>
                  <add_equipment object="L2M02.Fighters 8">
                    <ware typename="SS_WARE_TECH213" exact="{object.equipment.SS_WARE_TECH213.maxcount@L2M02.Fighters 8}-{object.equipment.SS_WARE_TECH213.count@L2M02.Fighters 8}+2"/>
                  </add_equipment>
                </do_otherwise>
              </do_choose>
              <do_choose>
                <do_when value="{object.exists@L2M02.Fighters 9}" exact="1">
                  <set_command object="L2M02.Fighters 9" command="moveposition">
                    <position x="0" min="2km" max="3km"/>
                    <sector x="13" y="6"/>
                  </set_command>
                </do_when>
                <do_otherwise>
                  <create_ship name="L2M02.Fighters 9" group="L2M02.Fighters" typename="{random.type@SS_SH_S_M3_1|SS_SH_S_M4_1|SS_SH_S_M4}" capturable="0" race="split">
                    <position object="this.gate" min="50" max="100m"/>
                    <sector sector="{object.sector@this.gate}"/>
                    <equipment loadout="maximum"/>
                    <command command="moveposition">
                      <position x="0" min="2km" max="5km"/>
                      <sector x="13" y="6"/>
                    </command>
                    <pilot jobtextid="60007"/>
                  </create_ship>
                  <add_equipment object="L2M02.Fighters 9">
                    <ware typename="SS_WARE_TECH213" exact="{object.equipment.SS_WARE_TECH213.maxcount@L2M02.Fighters 9}-{object.equipment.SS_WARE_TECH213.count@L2M02.Fighters 9}+1"/>
                  </add_equipment>
                </do_otherwise>
              </do_choose>
              <do_choose>
                <do_when value="{object.exists@L2M02.Fighters 10}" exact="1">
                  <set_command object="L2M02.Fighters 10" command="moveposition">
                    <position x="0" min="2km" max="3km"/>
                    <sector x="13" y="6"/>
                  </set_command>
                </do_when>
                <do_otherwise>
                  <create_ship name="L2M02.Fighters 10" group="L2M02.Fighters" typename="SS_SH_OTAS_M3" capturable="0" race="argon">
                    <position object="this.gate" min="50" max="100m"/>
                    <sector sector="{object.sector@this.gate}"/>
                    <equipment loadout="maximum"/>
                    <command command="moveposition">
                      <position x="0" min="2km" max="5km"/>
                      <sector x="13" y="6"/>
                    </command>
                    <pilot jobtextid="60006"/>
                  </create_ship>
                  <add_equipment object="L2M02.Fighters 10">
                    <ware typename="SS_WARE_TECH213" exact="{object.equipment.SS_WARE_TECH213.maxcount@L2M02.Fighters 10}-{object.equipment.SS_WARE_TECH213.count@L2M02.Fighters 10}+1"/>
                  </add_equipment>
                </do_otherwise>
              </do_choose>
              <do_choose>
                <do_when value="{object.exists@L2M02.Fighters 11}" exact="1">
                  <set_command object="L2M02.Fighters 11" command="moveposition">
                    <position x="0" min="2km" max="3km"/>
                    <sector x="13" y="6"/>
                  </set_command>
                </do_when>
                <do_otherwise>
                  <create_ship name="L2M02.Fighters 11" group="L2M02.Fighters" typename="SS_SH_OTAS_M4" capturable="0" race="argon">
                    <position object="this.gate" min="50" max="100m"/>
                    <sector sector="{object.sector@this.gate}"/>
                    <equipment loadout="maximum"/>
                    <command command="moveposition">
                      <position x="0" min="2km" max="5km"/>
                      <sector x="13" y="6"/>
                    </command>
                    <pilot jobtextid="60006"/>
                  </create_ship>
                  <add_equipment object="L2M02.Fighters 11">
                    <ware typename="SS_WARE_TECH213" exact="{object.equipment.SS_WARE_TECH213.maxcount@L2M02.Fighters 11}-{object.equipment.SS_WARE_TECH213.count@L2M02.Fighters 11}"/>
                  </add_equipment>
                </do_otherwise>
              </do_choose>
              <do_choose>
                <do_when value="{object.exists@L2M02.Fighters 12}" exact="1">
                  <set_command object="L2M02.Fighters 12" command="moveposition">
                    <position x="0" min="2km" max="3km"/>
                    <sector x="13" y="6"/>
                  </set_command>
                </do_when>
                <do_otherwise>
                  <create_ship name="L2M02.Fighters 12" group="L2M02.Fighters" typename="SS_SH_T_M6M" capturable="0" race="teladi">
                    <position object="this.gate" min="50" max="100m"/>
                    <sector sector="{object.sector@this.gate}"/>
                    <equipment loadout="maximum"/>
                    <command command="moveposition">
                      <position x="0" min="2km" max="5km"/>
                      <sector x="13" y="6"/>
                    </command>
                    <pilot jobtextid="60006"/>
                  </create_ship>
                  <add_equipment object="L2M02.Fighters 12">
                    <ware typename="SS_WARE_TECH213" exact="{object.equipment.SS_WARE_TECH213.maxcount@L2M02.Fighters 12}-{object.equipment.SS_WARE_TECH213.count@L2M02.Fighters 12}+2"/>
                  </add_equipment>
                </do_otherwise>
              </do_choose>
            </do_all>
          </action>
          <cues>
            <cue name="L2M02 Jesan Destroyed" delay="5s">
              <condition>
                <check_value value="{object.exists@L2M02.Exterminator}" exact="0"/>
              </condition>
              <timing>
                <time exact="250"/>
              </timing>
              <action>
                <do_if value="L2M02.PlotProgress" max="1">
                  <destroy_group group="L2M02.Fighters" warp="1"/>
                  <reset_cue cue="L2M02 Khaak Plot"/>
                </do_if>
              </action>
            </cue>
            <cue name="L2M02 Ship Wandering Off" instantiate="static" delay="60s">
              <condition>
                <any_object_position group="L2M02.Fighters" min="8km">
                  <position x="-5km" y="-1km" z="-9km"/>
                </any_object_position>
              </condition>
              <action>
                <do_all exact="{group.object.count@L2M02.Fighters}" counter="ship">
                  <set_value name="this.distsquared" exact="({group.object.{counter@ship}.position.x.km@L2M02.Fighters}+5)*({group.object.{counter@ship}.position.x.km@L2M02.Fighters}+5) + ({group.object.{counter@ship}.position.y.km@L2M02.Fighters}+1)*({group.object.{counter@ship}.position.y.km@L2M02.Fighters}+1) + ({group.object.{counter@ship}.position.z.km@L2M02.Fighters}+9)*({group.object.{counter@ship}.position.z.km@L2M02.Fighters}+9)"/>
                  <do_if value="{value@this.distsquared}" min="62">
                    <set_command object="{group.object.{counter@ship}@L2M02.Fighters}" command="moveposition" distance="2km">
                      <position x="-5km" y="-1km" z="-9km" min="250m" max="800m"/>
                      <sector x="13" y="6"/>
                    </set_command>
                  </do_if>
                </do_all>
              </action>
            </cue>
            <cue name="L2M02 Ship Finished" instantiate="static">
              <condition>
                <any_object_finished group="L2M02.Fighters"/>
              </condition>
              <action>
                <set_command object="{event.object}" command="idle"/>
              </action>
            </cue>
            <cue name="L2M02 Create Plot Offer" delay="10s">
              <condition>
                <check_all>
                  <!--check jesan is in the right sector-->
                  <object_sector object="L2M02.Exterminator" exact="0">
                    <sector x="13" y="6"/>
                  </object_sector>
                  <!--check player meets the entry requirements-->
                  <check_any>
                    <check_value value="{player.fightrank}" min="333"/>
                    <check_value value="{player.gamestart}" list="103|104"/>
                  </check_any>
                  <check_value value="{player.notoriety.argon}" min="10"/>
                  <check_value value="{player.notoriety.split}" min="-10"/>
                </check_all>
              </condition>
              <action>
                <create_offer actor="L2M02.Jesan" conversation="L2M02Conv11" discipline="XFXX" cue="L2M02 Create Plot Offer"/>
              </action>
              <cues>
                <cue name="L2M02 Start Plot">
                  <condition>
                    <conversation_completed actor="L2M02.Jesan" conversation="L2M02Conv11" answer="accept"/>
                  </condition>
                  <action>
                    <do_all>
                      <remove_offer actor="L2M02.Jesan" conversation="L2M02Conv11" discipline="XFXX"/>
                      <set_value name="L2M02.PlotProgress" exact="1"/>
                    </do_all>
                  </action>
                </cue>
              </cues>
            </cue>
            <cue name="L2M02 Jesan Attacked">
              <condition>
                <object_relation object="L2M02.Exterminator">
                  <relation relation="enemy"/>
                </object_relation>
              </condition>
              <action>
                <remove_offer actor="L2M02.Jesan" conversation="L2M02Conv11" discipline="XFXX"/>
              </action>
              <cues>
                <cue name="L2M02 Jesan Relation" delay="120s">
                  <condition>
                    <object_sector object="L2M02.Exterminator" exact="0" negate="1">
                      <sector sector="{player.sector}"/>
                    </object_sector>
                  </condition>
                  <action>
                    <do_all>
                      <set_relation object="L2M02.Exterminator">
                        <relation relation="friend"/>
                      </set_relation>
                      <reset_cue cue="L2M02 Create Plot Offer"/>
                    </do_all>
                  </action>
                </cue>
              </cues>
            </cue>
            <cue name="L2M02 Scene 1" delay="5s">
              <condition>
                <check_value value="{value@L2M02.PlotProgress}" exact="1"/>
              </condition>
              <action>
                <do_all>
                  <set_mission_rank name="L2OFF" titleid="1" textid="10" exact="-8"/>
                  <set_objective cue="L2M02 Scene 1" story="{3200,2}" chapter="{3200,201}" noabort="1" title="{3202,11}">
                    <briefing cue="L2M02 Scene 1" step="1"/>
                    <mission discipline="XFXX" level="veryeasy"/>
                    <follow object="L2M02.Exterminator"/>
                  </set_objective>
                  <create_briefing cue="L2M02 Scene 1" background="ship_elite_enhanced.tga" title="{3200,2}" text="{3202,101}">
                    <mission discipline="XFXX" level="veryeasy"/>
                    <objectives>
                      <objective step="1">
                        <custom action="{35,2008}" text="{actor.name@L2M02.Jesan}"/>
                      </objective>
                    </objectives>
                  </create_briefing>
                  <set_group_command group="L2M02.Fighters" command="moveposition" distance="3km">
                    <position x="0" min="2km" max="4km"/>
                    <sector x="15" y="6"/>
                  </set_group_command>
                  <cancel_cue cue="L2M02 Ship Wandering Off"/>
                  <cancel_cue cue="L2M02 Jesan Attacked"/>
                </do_all>
              </action>
              <cues>
                <cue name="L2M02 Sc1 St1 Jesan Attacked">
                  <condition>
                    <object_relation object="L2M02.Exterminator">
                      <relation relation="enemy"/>
                    </object_relation>
                  </condition>
                  <action>
                    <do_all>
                      <set_group_command group="L2M02.Fighters" command="moveposition" distance="3km">
                        <position x="0" min="1km" max="2km"/>
                        <sector x="14" y="8"/>
                      </set_group_command>
                      <cancel_cue cue="L2M02 Sc1 St2"/>
                    </do_all>
                  </action>
                  <cues>
                    <cue name="L2M02 St1 Sc2 Relation" delay="300s">
                      <condition>
                        <object_sector object="L2M02.Exterminator" exact="0" negate="1">
                          <sector sector="{player.sector}"/>
                        </object_sector>
                      </condition>
                      <action>
                        <set_relation object="L2M02.Exterminator">
                          <relation relation="friend"/>
                        </set_relation>
                      </action>
                      <cues>
                        <cue name="L2M02 Sc1 St1 Reset" delay="2s">
                          <condition>
                            <check_all>
                              <object_sector object="L2M02.Exterminator" exact="0">
                                <sector x="14" y="8"/>
                              </object_sector>
                              <object_position object="L2M02.Exterminator" max="5000m">
                                <position x="0" y="0" z="0"/>
                              </object_position>
                            </check_all>
                          </condition>
                          <action>
                            <reset_cue cue="L2M02 Khaak Plot"/>
                          </action>
                        </cue>
                      </cues>
                    </cue>
                  </cues>
                </cue>
                <cue name="L2M02 Sc1 St2" delay="1000">
                  <condition>
                    <check_all>
                      <object_sector object="L2M02.Exterminator" exact="0">
                        <sector x="15" y="6"/>
                      </object_sector>
                      <object_sector exact="0">
                        <sector x="15" y="6"/>
                      </object_sector>
                    </check_all>
                  </condition>
                  <action>
                    <cancel_cue cue="L2M02 Sc1 St1 Jesan Attacked"/>
                  </action>
                  <cues>
                    <cue ref="L0M08 B">
                      <params>
                        <param name="Cue" value="L2M02 Scene 1"/>
                        <param name="ID" value="2"/>
                        <param name="OfferRace" value="{lookup.race@argon}"/>
                        <param name="EnemyRace" value="{lookup.race@xenon}"/>
                        <param name="Lv1Guide" value="L2M02.Jesan"/>
                        <param name="Sector" value="L2M02.BHS"/>
                        <param name="Step" value="2"/>
                        <param name="PageID" value="3827"/>
                        <param name="TextID" value="272104"/>
                        <param name="StoryID" value="2"/>
                        <param name="ChapterID" value="201"/>
                        <param name="RewardCr" value="L2M02 Scene 1.RewardCr"/>
                        <param name="Bonus" value="L2M02 Scene 1.RewardBonus"/>
                        <param name="Difficulty" value="{lookup.level@hard}"/>
                        <param name="BriefingBackground" value="ship_xenon_n.tga"/>
                        <param name="RoundReward" value="1"/>
                      </params>
                    </cue>
                    <cue name="L2M02 Sc1 St2 Create Enemies">
                      <action>
                        <do_all>
                          <do_choose>
                            <do_when value="{player.fightrank.rank}" max="25">
                              <set_value name="L2M02 Sc1 St2 Create Enemies.OBSRank" exact="{player.fightrank.rank}+((25-{player.fightrank.rank})/5)"/>
                            </do_when>
                            <do_otherwise>
                              <set_value name="L2M02 Sc1 St2 Create Enemies.OBSRank" exact="{player.fightrank.rank}"/>
                            </do_otherwise>
                          </do_choose>
                          <do_if value="{object.exists@L2M02.BHSNorthGate}" exact="1">
                            <do_if value="{object.destination.exists@L2M02.BHSNorthGate}" exact="1">
                              <set_object name="L2M02.BHSNorthGate" value="{object.destination@L2M02.BHSNorthGate}"/>
                            </do_if>
                          </do_if>
                        </do_all>
                      </action>
                      <cues>
                        <cue name="L2M02 Sc1 St2 OBS Finished"/>
                        <cue ref="OBS">
                          <params>
                            <param name="OBS Cue" value="L2M02 Scene 1"/>
                            <param name="OBS Cancel Cue" value="L2M02 Sc1 St2 OBS Finished"/>
                            <param name="OBS Fleet Group Name" value="Enemies"/>
                            <param name="OBSFleetRace" value="{lookup.race@xenon}"/>
                            <param name="OBSFleetPilotsRace" value="{lookup.race@xenon}"/>
                            <param name="OBSMissionRank" value="{value@L2M02 Sc1 St2 Create Enemies.OBSRank}"/>
                            <param name="OBSDifficultyRank" value="{lookup.level@hard}"/>
                            <param name="OBSSector" value="{object.sector@L2M02.BHSNorthGate}"/>
                            <param name="OBS X" value="{object.position.x.km@L2M02.BHSNorthGate}"/>
                            <param name="OBS Y" value="{object.position.y.km@L2M02.BHSNorthGate}"/>
                            <param name="OBS Z" value="{object.position.z.km@L2M02.BHSNorthGate}"/>
                            <param name="OBSPosition" value="5"/>
                            <param name="OBSFleetCapturable" value="1"/>
                            <param name="OBSFleetCommunicates" value="0"/>
                            <param name="OBS Dock Support" value="1"/>
                            <param name="OBS Support Overflow" value="1"/>
                            <param name="OBS PointsMin" value="3*{value@Constant {lookup.class@m6} Points}-1"/>
                            <param name="OBS PointsMax" value="5*{value@Constant {lookup.class@m2} Points}+1"/>
                            <param name="Include M3P" value="1" comment="Include the M3Plus ships in the M3 search"/>
                            <param name="Include M4P" value="1" comment="Include the M4Plus ships in the M4 search"/>
                            <param name="Include M5P" value="1" comment="Include the M5Plus ships in the M5 search"/>
                            <param name="Include M6M" value="1" comment="Include the M6M ships in the M6 search"/>
                            <param name="Include M7M" value="1" comment="Include the M7M ships in the M7 search"/>
                          </params>
                        </cue>
                        <cue name="L2M02 Sc1 St2 Enemies Created">
                          <condition>
                            <cue_cancelled cue="L2M02 Sc1 St2 OBS Finished"/>
                          </condition>
                          <timing>
                            <time min="100" max="200"/>
                          </timing>
                          <action>
                            <do_all>
                              <set_group_command group="L2M02 Scene 1.Enemies" command="killenemiesrange" distance="40km">
                                <position x="15km" y="0" z="0"/>
                                <sector sector="L2M02.BHS"/>
                              </set_group_command>
                            </do_all>
                          </action>
                        </cue>
                      </cues>
                    </cue>
                    <cue name="L2M02 Sc1 St2 Speak Wait">
                      <condition>
                        <check_all>
                          <cue_is_complete cue="L0M08 B"/>
                          <cue_is_complete cue="L2M02 Sc1 St2 Enemies Created"/>
                          <any_object_sector group="L2M02 Scene 1.Enemies" exact="0">
                            <sector sector="L2M02.BHS"/>
                          </any_object_sector>
                        </check_all>
                      </condition>
                      <timing>
                        <time exact="4s"/>
                      </timing>
                    </cue>
                    <cue name="L2M02 Sc1 St2 Speak">
                      <condition>
                        <check_all>
                          <cue_is_complete cue="L2M02 Sc1 St2 Speak Wait"/>
                          <object_sector exact="0">
                            <sector sector="L2M02.BHS"/>
                          </object_sector>
                        </check_all>
                      </condition>
                      <action>
                        <do_all>
                          <incoming_message author="{actor.name@L2M02.Jesan}" text="{{actor.voice@L2M02.Jesan},272104}" silent="1"/>
                          <play_cutscene file="Khaak Plot S1 C1"/>
                          <set_object name="this.JesanShip" value="{object@L2M02.Exterminator}"/>
                          <set_object name="this.CutSceneShip" value="{group.nearest@L2M02 Scene 1.Enemies}"/>
                          <play_text actor="L2M02.Jesan" textid="272104" priority="99"/>
                        </do_all>
                      </action>
                      <cues>
                        <cue name="L2M02 Sc1 St2 Wait">
                          <condition>
                            <cue_completed cue="L2M02 Sc1 St2 Speak"/>
                          </condition>
                          <cues>
                            <cue ref="L0M08">
                              <params>
                                <param name="Cue" value="L2M02 Scene 1"/>
                                <param name="ID" value="2"/>
                                <param name="OfferRace" value="{lookup.race@argon}"/>
                                <param name="EnemyRace" value="{lookup.race@xenon}"/>
                                <param name="Lv1Guide" value="L2M02.Jesan"/>
                                <param name="PageID" value="3827"/>
                                <param name="TextID" value="272104"/>
                                <param name="AddText" value="1"/>
                                <param name="RewardCr" value="L2M02 Scene 1.RewardCr"/>
                                <param name="Bonus" value="L2M02 Scene 1.RewardBonus"/>
                                <param name="StoryID" value="2"/>
                                <param name="ChapterID" value="201"/>
                                <param name="Difficulty" value="{lookup.level@hard}"/>
                                <param name="Friendlies" value="L2M02.Fighters"/>
                                <param name="Enemies" value="L2M02 Sc1 St2.Enemies"/>
                                <param name="NoStartMessage" value="1"/>
                                <param name="OBS PointsMin" value="{value@Constant {lookup.class@m6} Points}*2-1"/>
                              </params>
                            </cue>
                          </cues>
                        </cue>
                      </cues>
                    </cue>
                    <cue name="L2M02 Sc1 St2 End" delay="500">
                      <condition>
                        <check_value value="{value@L2M02 Scene 1.2 L0M08 Progress}" exact="1"/>
                      </condition>
                      <timing>
                        <time min="10s" max="12s"/>
                      </timing>
                      <action>
                        <do_all>
                          <set_mission_rank name="L2OFF" titleid="1" textid="10" exact="2"/>
                          <set_objective cue="L2M02 Scene 1" title="{3202,11}">
                            <briefing cue="L2M02 Scene 1" step="3"/>
                            <mission discipline="XXXT" level="easy"/>
                            <dockat object="L2M02.Base"/>
                          </set_objective>
                          <create_briefing cue="L2M02 Scene 1" title="{3202,11}" text="{{actor.voice@L2M02.Jesan},272105}" background="sector_argon_m148.tga">
                            <mission discipline="XXXT" level="easy"/>
                            <objectives>
                              <objective step="3">
                                <dockat object="L2M02.Base"/>
                              </objective>
                            </objectives>
                          </create_briefing>
                          <!--incase friendly fire made Jesan red we turn him blue-->
                          <set_relation object="L2M02.Exterminator">
                            <relation mutual="0" relation="friend"/>
                          </set_relation>
                          <!--allow docking at the base now-->
                          <set_relation object="L2M02.Base">
                            <relation mutual="0" relation="friend"/>
                          </set_relation>
                          <reward_player>
                            <!--pay player for helping - paid when player docks
                            <money exact="{value@L2M02 Scene 1.RewardCr}"/>-->
                            <!--let player know the way?-->
                            <map>
                              <sector sector="{object.sector@L2M02.Base}"/>
                              <sector sector="L2M02.UnkSec"/>
                              <sector sector="L2M02.NathansVoyage"/>
                            </map>
                          </reward_player>
                          <set_known object="L2M02.Base" known="1"/>
                          <find_gate name="this.nvwestg" gate="west">
                            <sector sector="L2M02.NathansVoyage"/>
                            <jumps exact="0"/>
                          </find_gate>
                          <set_known object="this.nvwestg" known="1"/>
                          <!--set other stations in the sector now dockable-->
                          <find_station group="L2M02.MilitaryFactories" class="factory" multiple="1" max="999">
                            <sector sector="L2M02.MS148"/>
                            <jumps exact="0"/>
                          </find_station>
                          <set_group_relation group="L2M02.MilitaryFactories">
                            <relation mutual="0" relation="friend"/>
                          </set_group_relation>
                          <find_station group="L2M02.MilitaryEQ" typename="SS_DOCK_A_EQUIP" multiple="1" max="999">
                            <sector sector="L2M02.MS148"/>
                            <jumps exact="0"/>
                          </find_station>
                          <set_group_relation group="L2M02.MilitaryEQ">
                            <relation mutual="0" relation="friend"/>
                          </set_group_relation>
                          <!--set any lasertowers friendly too-->
                          <find_ship group="this.lts" typename="SS_SH_ORBITALLASER" multiple="1" max="999" race="default">
                            <sector sector="L2M02.MS148"/>
                            <jumps exact="0"/>
                          </find_ship>
                          <set_group_relation group="this.lts">
                            <relation mutual="0" relation="friend"/>
                          </set_group_relation>
                          <remove_group group="this.lts"/>
                          <!--cancel sector access cue and set stations hackable-->
                          <set_value name="L2 Sector {sector@L2M02.MS148} No Access" exact="2"/>
                          <do_all exact="{group.object.count@L2M02.MilitaryFactories}" counter="num">
                            <set_value name="L2 Station {group.object.{counter@num}@L2M02.MilitaryFactories} No Access" exact="0"/>
                          </do_all>
                          <do_all exact="{group.object.count@L2M02.MilitaryEQ}" counter="num">
                            <set_value name="L2 Station {group.object.{counter@num}@L2M02.MilitaryEQ} No Access" exact="0"/>
                          </do_all>
                          <!--we dont need these groups-->
                          <remove_group group="L2M02.MilitaryFactories"/>
                          <remove_group group="L2M02.MilitaryEQ"/>
                          <set_value name="L2 Station {group.object.{counter@num}@L2M02.Base} No Access" exact="0"/>
                          <incoming_message author="{actor.name@L2M02.Jesan}" text="{{actor.voice@L2M02.Jesan},272105}" silent="1"/>
                          <play_text actor="L2M02.Jesan" textid="272105" priority="99"/>
                          <set_group_command group="L2M02.Fighters" command="moveposition" distance="3km">
                            <position x="0" min="1km" max="2km"/>
                            <sector x="14" y="8"/>
                          </set_group_command>
                          <cancel_cue cue="L2M02 Sc1 St2 Fail"/>
                        </do_all>
                      </action>
                      <cues>
                        <cue name="L2M02 Sc1 St2 Docked" delay="500">
                          <condition>
                            <object_is_docked dockobject="{object@L2M02.Base}"/>
                          </condition>
                          <action>
                            <do_all>
                              <set_mission_rank name="L2OFF" titleid="1" textid="10" exact="11"/>
                              <remove_objective cue="L2M02 Scene 1"/>
                              <reward_player>
                                <money exact="{value@L2M02 Scene 1.RewardCr}+{value@L2M02 Scene 1.RewardBonus}"/>
                              </reward_player>
                              <set_value name="L2M02.PlotProgress" exact="2"/>
                            </do_all>
                          </action>
                        </cue>
                        <cue name="L2M02 Sc1 St2 Jesan Attacked">
                          <condition>
                            <object_relation object="L2M02.Exterminator">
                              <relation relation="enemy"/>
                            </object_relation>
                          </condition>
                          <action>
                            <do_all>
                              <set_group_command group="L2M02.Fighters" command="moveposition" distance="3km">
                                <position x="0" min="1km" max="2km"/>
                                <sector x="14" y="8"/>
                              </set_group_command>
                              <remove_mission_rank name="L2OFF"/>
                              <cancel_cue cue="L2M02 Sc1 St2 Docked"/>
                            </do_all>
                          </action>
                          <cues>
                            <cue name="L2M02 St1 Sc2 Relation" delay="300s">
                              <condition>
                                <object_sector object="L2M02.Exterminator" exact="0" negate="1">
                                  <sector sector="{player.sector}"/>
                                </object_sector>
                              </condition>
                              <action>
                                <set_relation object="L2M02.Exterminator">
                                  <relation relation="friend"/>
                                </set_relation>
                              </action>
                              <cues>
                                <cue name="L2M02 Sc1 St1 Reset" delay="2s">
                                  <condition>
                                    <check_all>
                                      <object_sector object="L2M02.Exterminator" exact="0">
                                        <sector x="14" y="8"/>
                                      </object_sector>
                                      <object_position object="L2M02.Exterminator" max="5000m">
                                        <position x="0" y="0" z="0"/>
                                      </object_position>
                                    </check_all>
                                  </condition>
                                  <action>
                                    <reset_cue cue="L2M02 Khaak Plot"/>
                                  </action>
                                </cue>
                              </cues>
                            </cue>
                          </cues>
                        </cue>
                      </cues>
                    </cue>
                    <cue name="L2M02 Sc1 St2 Fail" delay="500">
                      <condition>
                        <check_value value="{value@L2M02 Scene 1.2 L0M08 Progress}" min="2"/>
                      </condition>
                      <action>
                        <do_all>
                          <remove_mission_rank name="L2OFF"/>
                          <remove_briefing cue="L2M02 Scene 1"/>
                          <remove_objective cue="L2M02 Scene 1" status="failed"/>
                        </do_all>
                      </action>
                      <cues>
                        <cue name="L2M02 Sc1 St2 Fail Message">
                          <timing>
                            <time min="6s" max="8s"/>
                          </timing>
                          <action>
                            <do_choose>
                              <do_when value="{player.sector}" exact="{actor.sector@L2M02.Jesan}">
                                <incoming_message author="{actor.name@L2M02.Jesan}" text="{{actor.voice@L2M02.Jesan},272106}" silent="1"/>
                                <play_text actor="L2M02.Jesan" textid="272106" priority="99"/>
                              </do_when>
                              <do_otherwise>
                                <incoming_message author="{actor.name@L2M02.Jesan}" text="{{actor.voice@L2M02.Jesan},272106}" popup="1"/>
                              </do_otherwise>
                            </do_choose>
                          </action>
                        </cue>
                        <cue name="L2M02 Sc1 St2 Player OOS Destroy Xenon" delay="250">
                          <condition>
                            <check_value value="{player.sector}" exact="{sector@L2M02.BHS}" negate="1"/>
                          </condition>
                          <action>
                            <do_if value="{group.object.count@L2M02 Scene 1.2 L0M08Enemies}" min="1">
                              <destroy_group group="L2M02 Scene 1.2 L0M08Enemies" warp="1"/>
                            </do_if>
                          </action>
                        </cue>
                        <cue name="L2M02 Sc1 St2 Xenon Dead">
                          <condition>
                            <check_value value="{group.object.count@L2M02 Scene 1.2 L0M08Enemies}" exact="0"/>
                          </condition>
                          <action>
                            <do_all>
                              <set_group_command group="L2M02.Fighters" command="moveposition" distance="3km">
                                <position x="0" min="1km" max="2km"/>
                                <sector x="14" y="8"/>
                              </set_group_command>
                            </do_all>
                          </action>
                        </cue>
                        <cue name="L2M02 Sc1 St2 Reset" delay="2s">
                          <condition>
                            <check_all>
                              <object_sector object="L2M02.Exterminator" exact="0">
                                <sector x="14" y="8"/>
                              </object_sector>
                              <object_position object="L2M02.Exterminator" max="5000m">
                                <position x="0" y="0" z="0"/>
                              </object_position>
                            </check_all>
                          </condition>
                          <action>
                            <reset_cue cue="L2M02 Khaak Plot"/>
                          </action>
                        </cue>
                      </cues>
                    </cue>
                  </cues>
                </cue>
              </cues>
            </cue>
            <cue name="L2M02 Scene 2" delay="5s">
              <condition>
                <check_value value="{value@L2M02.PlotProgress}" exact="2"/>
              </condition>
              <timing>
                <time exact="10s"/>
              </timing>
              <action>
                <do_all>
                  <play_text actor="L2M02.TeSaat" textid="282201" priority="99"/>
                  <clear_actor_location actor="L2M02.Jesan"/>
                  <cancel_cue cue="L2M02 Jesan Destroyed"/>
                  <destroy_object object="L2M02.Exterminator" warp="1"/>
                  <reward_player>
                    <map>
                      <sector sector="L2M02.KhaakSec1"/>
                    </map>
                  </reward_player>
                  <!--create a crate incase the player jumps there without enough energy to get back-->
                  <create_crate name="this.eccrate">
                    <position x="0" height="6km" min="15km" max="22km"/>
                    <sector sector="L2M02.KhaakSec1"/>
                    <ware typename="SS_WARE_ENERGY" exact="62"/>
                  </create_crate>
                  <create_crate>
                    <position object="this.eccrate" min="400m" max="600m"/>
                    <sector sector="L2M02.KhaakSec1"/>
                    <ware typename="SS_LASER_EBC" exact="2"/>
                  </create_crate>
                  <find_station name="L2M02 Scene 2.KhaakStation" race="khaak">
                    <sector sector="L2M02.KhaakSec1"/>
                    <jumps exact="0"/>
                  </find_station>
                  <!--move any big ships away from the sector centre to make the mission possible-->
                  <find_ship group="this.corvettes" class="bigship" race="khaak" multiple="1" max="20">
                    <sector sector="L2M02.KhaakSec1"/>
                    <jumps exact="0"/>
                  </find_ship>
                  <warp_group group="this.corvettes">
                    <position x="0" height="15km" min="120km" max="150km"/>
                    <sector sector="L2M02.KhaakSec1"/>
                  </warp_group>
                  <set_group_command group="this.corvettes" command="killenemiesrange" distance="70km">
                    <position object="L2M02 Scene 2.KhaakStation"/>
                    <sector sector="{object.sector@L2M02 Scene 2.KhaakStation}"/>
                  </set_group_command>
                  <remove_group group="this.corvettes"/>
                </do_all>
              </action>
              <cues>
                <cue name="L2M02 Sc2 St1 Jesan">
                  <timing>
                    <time exact="60s"/>
                  </timing>
                  <action>
                    <do_all>
                      <incoming_message author="{actor.name@L2M02.Jesan}" text="{3895,272201}"/>
                      <destroy_actor actor="L2M02.Jesan"/>
                    </do_all>
                  </action>
                </cue>
                <cue name="L2M02 Sc2 St1 Wait" delay="200">
                  <condition>
                    <cue_is_complete cue="L2M02 Scene 2"/>
                  </condition>
                  <timing>
                    <time exact="{text.duration@3828,282201}"/>
                  </timing>
                  <cues>
                    <cue ref="L0M18 B">
                      <params>
                        <param name="Cue" value="L2M02 Scene 2"/>
                        <param name="ID" value="1"/>
                        <param name="OfferRace" value="{lookup.race@argon}"/>
                        <param name="EnemyRace" value="{lookup.race@khaak}"/>
                        <param name="Lv1Guide" value="L2M02.TeSaat"/>
                        <param name="PageID" value="3202"/>
                        <param name="TextID" value="201"/>
                        <param name="RewardCr" value="L2M02 Scene 2.Step1 RewardCr"/>
                        <param name="StoryID" value="2"/>
                        <param name="ChapterID" value="202"/>
                        <param name="Difficulty" value="{lookup.level@hard}"/>
                        <param name="IsPlot" value="1"/>
                        <param name="Step" value="1"/>
                        <param name="Sector" value="L2M02.KhaakSec1"/>
                        <param name="Satellite" value="100"/>
                        <param name="Object1" value="L2M02 Scene 2.KhaakStation"/>
                        <param name="Difficulty1" value="10"/>
                        <param name="BriefingBackground" value="station_khaak.tga"/>
                      </params>
                    </cue>
                    <cue name="L2M02 Sc2 St1 Wait 2" delay="200">
                      <condition>
                        <cue_is_complete cue="L0M18 B"/>
                      </condition>
                      <cues>
                        <cue ref="L0M18">
                          <params>
                            <param name="Cue" value="L2M02 Scene 2"/>
                            <param name="ID" value="1"/>
                            <param name="OfferRace" value="{lookup.race@argon}"/>
                            <param name="EnemyRace" value="{lookup.race@khaak}"/>
                            <param name="Lv1Guide" value="L2M02.TeSaat"/>
                            <param name="PageID" value="3202"/>
                            <param name="TextID" value="201"/>
                            <param name="RewardCr" value="L2M02 Scene 2.Step1 RewardCr"/>
                            <param name="StoryID" value="2"/>
                            <param name="ChapterID" value="202"/>
                            <param name="Difficulty" value="{lookup.level@hard}"/>
                            <param name="IsPlot" value="1"/>
                            <param name="Step" value="1"/>
                            <param name="NoStartMessage" value="1"/>
                          </params>
                        </cue>
                      </cues>
                    </cue>
                    <cue name="L2M02 Sc2 St1 Map Help" delay="100">
                      <condition>
                        <check_value value="{player.menu.galaxy}" exact="1"/>
                      </condition>
                      <action>
                        <show_help text="{3202,5001}"/>
                      </action>
                    </cue>
                    <cue name="L2M02 Sc2 St1 End">
                      <condition>
                        <check_value value="{value@L2M02 Scene 2.1 L0M18 Progress}" exact="1"/>
                      </condition>
                      <action>
                        <do_all>
                          <set_mission_rank name="L2OFF" titleid="1" textid="10" exact="22"/>
                          <create_briefing cue="L2M02 Scene 2" background="sector_argon_m148.tga">
                            <objectives>
                              <objective step="{value@L2M02 Scene 2.1 L0M18BriStep}">
                                <dockat object="L2M02.Base"/>
                              </objective>
                            </objectives>
                          </create_briefing>
                          <set_objective cue="L2M02 Scene 2" noabort="1">
                            <briefing cue="L2M02 Scene 2" step="{value@L2M02 Scene 2.1 L0M18BriStep}"/>
                            <dockat object="L2M02.Base"/>
                          </set_objective>
                          <!--pay the player-->
                          <reward_player>
                            <money exact="{value@L2M02 Scene 2.Step1 RewardCr}"/>
                          </reward_player>
                          <set_value name="L2M02 Scene 2.1 L0M18BriStep" operation="add"/>
                        </do_all>
                      </action>
                    </cue>
                  </cues>
                </cue>
                <cue name="L2M02 Sc2 St2" delay="500">
                  <condition>
                    <check_all>
                      <object_is_docked dockobject="L2M02.Base"/>
                      <check_value value="{value@L2M02 Scene 2.1 L0M18 Progress}" exact="1"/>
                    </check_all>
                  </condition>
                  <timing>
                    <time exact="10s"/>
                  </timing>
                  <action>
                    <do_all>
                      <play_text actor="L2M02.TeSaat" textid="282202" priority="99"/>
                      <set_mission_rank name="L2OFF" titleid="1" textid="10" exact="27"/>
                      <set_value name="L2M02 Sc2 St2.RewardCr" exact="{reward.money@average.XXXT}"/>
                      <reward_player>
                        <map>
                          <sector sector="L2M02.KhaakSec2"/>
                        </map>
                      </reward_player>
                      <incoming_message author="{actor.name@L2M02.TeSaat}" text="{{actor.voice@L2M02.TeSaat},282202}" silent="1"/>
                      <create_briefing cue="L2M02 Scene 2" title="{3200,202}" text="{{actor.voice@L2M02.TeSaat},282202}" background="sector_khaak_931.tga">
                        <reward money="{value@L2M02 Sc2 St2.RewardCr}"/>
                        <objectives>
                          <objective step="{value@L2M02 Scene 2.1 L0M18BriStep}">
                            <flyto>
                              <sector sector="L2M02.KhaakSec2"/>
                            </flyto>
                          </objective>
                          <objective step="{value@L2M02 Scene 2.1 L0M18BriStep}+1">
                            <custom icon="find" action="{35,2034}" text="{lookup.type.name@SS_WARE_LOGBOOK}"/>
                          </objective>
                        </objectives>
                      </create_briefing>
                      <set_value name="L2M02 Sc2 St2.FlyToStep" exact="{value@L2M02 Scene 2.1 L0M18BriStep}"/>
                      <set_value name="L2M02 Sc2 St2.PickUpStep" exact="{value@L2M02 Scene 2.1 L0M18BriStep}+1"/>
                      <set_objective cue="L2M02 Scene 2" title="{3618,1003}">
                        <briefing cue="L2M02 Scene 2" step="{value@L2M02 Scene 2.1 L0M18BriStep}"/>
                        <reward money="{value@L2M02 Sc2 St2.RewardCr}"/>
                        <flyto>
                          <sector sector="L2M02.KhaakSec2"/>
                        </flyto>
                      </set_objective>
                      <set_value name="L2M02 Scene 2.1 L0M18BriStep" operation="add" exact="2"/>

                      <!--west wall-->
                      <create_stationary group="L2M02 Sc2 St2.Mines" typename="SS_SH_MINE_1" race="enemy" active="1">
                        <position min="0m" max="200m" x="13000m" z="15500m" y="-1300m"/>
                        <sector sector="L2M02.KhaakSec2"/>
                      </create_stationary>
                      <create_stationary group="L2M02 Sc2 St2.Mines" typename="SS_SH_MINE_1" race="enemy" active="1">
                        <position min="0m" max="200m" x="12400m" z="18000m" y="-1400m"/>
                        <sector sector="L2M02.KhaakSec2"/>
                      </create_stationary>
                      <create_stationary group="L2M02 Sc2 St2.Mines" typename="SS_SH_MINE_1" race="enemy" active="1">
                        <position min="0m" max="200m" x="12600m" z="20000m" y="-1000m"/>
                        <sector sector="L2M02.KhaakSec2"/>
                      </create_stationary>
                      <create_stationary group="L2M02 Sc2 St2.Mines" typename="SS_SH_MINE_1" race="enemy" active="1">
                        <position min="0m" max="200m" x="12400m" z="15000m" y="1000m"/>
                        <sector sector="L2M02.KhaakSec2"/>
                      </create_stationary>
                      <create_stationary group="L2M02 Sc2 St2.Mines" typename="SS_SH_MINE_1" race="enemy" active="1">
                        <position min="0m" max="200m" x="12200m" z="18000m" y="1200m"/>
                        <sector sector="L2M02.KhaakSec2"/>
                      </create_stationary>
                      <create_stationary group="L2M02 Sc2 St2.Mines" typename="SS_SH_MINE_1" race="enemy" active="1">
                        <position min="0m" max="200m" x="12500m" z="20200m" y="1500m"/>
                        <sector sector="L2M02.KhaakSec2"/>
                      </create_stationary>
                      <create_stationary group="L2M02 Sc2 St2.Mines" typename="SS_SH_MINE_1" race="enemy" active="1">
                        <position min="0m" max="200m" x="12400m" z="15800m" y="-3000m"/>
                        <sector sector="L2M02.KhaakSec2"/>
                      </create_stationary>
                      <create_stationary group="L2M02 Sc2 St2.Mines" typename="SS_SH_MINE_1" race="enemy" active="1">
                        <position min="0m" max="200m" x="12700m" z="18000m" y="-3400m"/>
                        <sector sector="L2M02.KhaakSec2"/>
                      </create_stationary>
                      <create_stationary group="L2M02 Sc2 St2.Mines" typename="SS_SH_MINE_1" race="enemy" active="1">
                        <position min="0m" max="200m" x="12400m" z="20300m" y="-3000m"/>
                        <sector sector="L2M02.KhaakSec2"/>
                      </create_stationary>

                      <!--east wall-->
                      <create_stationary group="L2M02 Sc2 St2.Mines" typename="SS_SH_MINE_1" race="enemy" active="1">
                        <position min="0m" max="200m" x="17500m" z="15600m" y="-1000m"/>
                        <sector sector="L2M02.KhaakSec2"/>
                      </create_stationary>
                      <create_stationary group="L2M02 Sc2 St2.Mines" typename="SS_SH_MINE_1" race="enemy" active="1">
                        <position min="0m" max="200m" x="17500m" z="18000m" y="-1000m"/>
                        <sector sector="L2M02.KhaakSec2"/>
                      </create_stationary>
                      <create_stationary group="L2M02 Sc2 St2.Mines" typename="SS_SH_MINE_1" race="enemy" active="1">
                        <position min="0m" max="200m" x="17500m" z="20300m" y="-1000m"/>
                        <sector sector="L2M02.KhaakSec2"/>
                      </create_stationary>
                      <create_stationary group="L2M02 Sc2 St2.Mines" typename="SS_SH_MINE_1" race="enemy" active="1">
                        <position min="0m" max="200m" x="17500m" z="15800m" y="1000m"/>
                        <sector sector="L2M02.KhaakSec2"/>
                      </create_stationary>
                      <create_stationary group="L2M02 Sc2 St2.Mines" typename="SS_SH_MINE_1" race="enemy" active="1">
                        <position min="0m" max="200m" x="17500m" z="18000m" y="1500m"/>
                        <sector sector="L2M02.KhaakSec2"/>
                      </create_stationary>
                      <create_stationary group="L2M02 Sc2 St2.Mines" typename="SS_SH_MINE_1" race="enemy" active="1">
                        <position min="0m" max="200m" x="17500m" z="20000m" y="1500m"/>
                        <sector sector="L2M02.KhaakSec2"/>
                      </create_stationary>
                      <create_stationary group="L2M02 Sc2 St2.Mines" typename="SS_SH_MINE_1" race="enemy" active="1">
                        <position min="0m" max="200m" x="17500m" z="16000m" y="-3300m"/>
                        <sector sector="L2M02.KhaakSec2"/>
                      </create_stationary>
                      <create_stationary group="L2M02 Sc2 St2.Mines" typename="SS_SH_MINE_1" race="enemy" active="1">
                        <position min="0m" max="200m" x="17500m" z="18000m" y="-3100m"/>
                        <sector sector="L2M02.KhaakSec2"/>
                      </create_stationary>
                      <create_stationary group="L2M02 Sc2 St2.Mines" typename="SS_SH_MINE_1" race="enemy" active="1">
                        <position min="0m" max="200m" x="17500m" z="21000m" y="-3200m"/>
                        <sector sector="L2M02.KhaakSec2"/>
                      </create_stationary>

                      <!--south 3-->
                      <create_stationary group="L2M02 Sc2 St2.Mines" typename="SS_SH_MINE_1" race="enemy" active="1">
                        <position min="0m" max="200m" x="15000m" z="15400km" y="-1100m"/>
                        <sector sector="L2M02.KhaakSec2"/>
                      </create_stationary>
                      <create_stationary group="L2M02 Sc2 St2.Mines" typename="SS_SH_MINE_1" race="enemy" active="1">
                        <position min="0m" max="200m" x="15000m" z="15500m" y="1800m"/>
                        <sector sector="L2M02.KhaakSec2"/>
                      </create_stationary>
                      <create_stationary group="L2M02 Sc2 St2.Mines" typename="SS_SH_MINE_1" race="enemy" active="1">
                        <position min="0m" max="200m" x="15000m" z="15500m" y="-3500m"/>
                        <sector sector="L2M02.KhaakSec2"/>
                      </create_stationary>

                      <!--above / below-->
                      <create_stationary group="L2M02 Sc2 St2.Mines" typename="SS_SH_MINE_1" race="enemy" active="1">
                        <position min="0m" max="200m" x="15000m" z="18000m" y="2100m"/>
                        <sector sector="L2M02.KhaakSec2"/>
                      </create_stationary>
                      <create_stationary group="L2M02 Sc2 St2.Mines" typename="SS_SH_MINE_1" race="enemy" active="1">
                        <position min="0m" max="200m" x="15000m" z="18000m" y="-3500m"/>
                        <sector sector="L2M02.KhaakSec2"/>
                      </create_stationary>
                      <create_stationary group="L2M02 Sc2 St2.Mines" typename="SS_SH_MINE_1" race="enemy" active="1">
                        <position min="0m" max="200m" x="15000m" z="21000m" y="1100m"/>
                        <sector sector="L2M02.KhaakSec2"/>
                      </create_stationary>
                      <create_stationary group="L2M02 Sc2 St2.Mines" typename="SS_SH_MINE_1" race="enemy" active="1">
                        <position min="0m" max="200m" x="15000m" z="21500m" y="-3500m"/>
                        <sector sector="L2M02.KhaakSec2"/>
                      </create_stationary>

                      <!--additional-->
                      <do_all min="6" max="8">
                        <create_stationary group="L2M02 Sc2 St2.Mines" typename="SS_SH_MINE_1" race="enemy" active="1">
                          <position min="5000m" max="9000m" x="15000m" z="18000m" y="-1000m" profile="decreasing"/>
                          <sector sector="L2M02.KhaakSec2"/>
                        </create_stationary>
                      </do_all>
                      <do_any>
                        <set_value name="L2M02.CreateBonus1" exact="1"/>
                        <set_value name="L2M02.CreateBonus2" exact="1"/>
                        <set_value name="L2M02.CreateBonus3" exact="1"/>
                      </do_any>
                      <!--create a crate incase the player jumps there without enough energy to get back-->
                      <create_crate name="this.eccrate">
                        <position x="-5km" z="-20km" height="2km" min="2km" max="4km"/>
                        <sector sector="L2M02.KhaakSec2"/>
                        <ware typename="SS_WARE_ENERGY" exact="41"/>
                      </create_crate>
                      <create_crate>
                        <position object="this.eccrate" height="3km" min="15km" max="20km"/>
                        <sector sector="L2M02.KhaakSec2"/>
                        <ware typename="SS_WARE_ENERGY" exact="23"/>
                      </create_crate>
                      <!--move any big ships away from the sector centre to make the mission possible-->
                      <find_ship group="this.corvettes" class="bigship" race="khaak" multiple="1" max="20">
                        <sector sector="L2M02.KhaakSec2"/>
                        <jumps exact="0"/>
                      </find_ship>
                      <warp_group group="this.corvettes">
                        <position x="0" height="15km" min="100km" max="120km"/>
                        <sector sector="L2M02.KhaakSec2"/>
                      </warp_group>
                      <set_group_command group="this.corvettes" command="killenemiesrange" distance="60km">
                        <position x="0" y="0" z="0"/>
                        <sector sector="L2M02.KhaakSec2"/>
                      </set_group_command>
                      <remove_group group="this.corvettes"/>
                      <!--increase khaak activity near base-->
                      <set_value name="L2M02.USKhaakAmt" exact="12"/>
                    </do_all>
                  </action>
                  <cues>
                    <cue name="L2M02 Sc2 St2 Sec Change" instantiate="static">
                      <!--because we want to stop the player just collecting the stuff OOS-->
                      <condition>
                        <object_changed_sector/>
                      </condition>
                      <timing>
                        <time exact="50"/>
                      </timing>
                      <action>
                        <do_choose>
                          <do_when value="{player.sector}" exact="{sector@L2M02.KhaakSec2}">
                            <do_if value="{object.exists@L2M02 Sc2 St2.JesanData}" exact="0">
                              <create_crate name="L2M02 Sc2 St2.JesanData">
                                <position x="15km" z="18km" y="-1km" min="50m" max="100m"/>
                                <sector sector="L2M02.KhaakSec2"/>
                                <ware typename="SS_WARE_LOGBOOK" exact="1"/>
                              </create_crate>
                            </do_if>
                            <do_if value="{value@L2M02.CreateBonus1}" exact="1">
                              <create_crate name="L2M02 Sc2 St2.Bonus1">
                                <position x="14905m" z="18150m" y="1100" min="5m" max="10m"/>
                                <sector sector="L2M02.KhaakSec2"/>
                                <ware typename="SS_LASER_PAL" exact="2"/>
                              </create_crate>
                              <set_value name="L2M02.CreateBonus1" exact="0"/>
                            </do_if>
                            <do_if value="{value@L2M02.CreateBonus2}" exact="1">
                              <create_crate name="L2M02 Sc2 St2.Bonus2">
                                <position x="16205m" z="18550m" y="-2150" min="5m" max="10m"/>
                                <sector sector="L2M02.KhaakSec2"/>
                                <ware typename="SS_LASER_HEPT" exact="4"/>
                              </create_crate>
                              <set_value name="L2M02.CreateBonus2" exact="0"/>
                            </do_if>
                            <do_if value="{value@L2M02.CreateBonus3}" exact="1">
                              <create_crate name="L2M02 Sc2 St2.Bonus3">
                                <position x="15km" z="18km" y="-1km" min="1000m" max="1200m"/>
                                <sector sector="L2M02.KhaakSec2"/>
                                <ware typename="SS_WARE_TECH207" exact="3"/>
                              </create_crate>
                              <set_value name="L2M02.CreateBonus3" exact="0"/>
                            </do_if>
                            <set_group_invincible group="L2M02 Sc2 St2.Mines" invincible="0"/>
                            <set_group_active group="L2M02 Sc2 St2.Mines" active="1"/>
                            <set_objective cue="L2M02 Scene 2">
                              <briefing cue="L2M02 Scene 2" step="{value@L2M02 Sc2 St2.PickUpStep}"/>
                              <custom icon="find" action="{35,2034}" text="{lookup.type.name@SS_WARE_LOGBOOK}" object="L2M02 Sc2 St2.JesanData"/>
                            </set_objective>
                          </do_when>
                          <do_otherwise>
                            <destroy_object object="L2M02 Sc2 St2.JesanData"/>
                            <do_if value="{object.exists@L2M02 Sc2 St2.Bonus1}" exact="1">
                              <set_value name="L2M02.CreateBonus1" exact="1"/>
                              <destroy_object object="L2M02 Sc2 St2.Bonus1" explosion="0"/>
                            </do_if>
                            <do_if value="{object.exists@L2M02 Sc2 St2.Bonus2}" exact="1">
                              <set_value name="L2M02.CreateBonus2" exact="1"/>
                              <destroy_object object="L2M02 Sc2 St2.Bonus2" explosion="0"/>
                            </do_if>
                            <do_if value="{object.exists@L2M02 Sc2 St2.Bonus3}" exact="1">
                              <set_value name="L2M02.CreateBonus3" exact="1"/>
                              <destroy_object object="L2M02 Sc2 St2.Bonus3" explosion="0"/>
                            </do_if>
                            <set_group_known group="L2M02 Sc2 St2.Mines" known="0"/>
                            <set_group_invincible group="L2M02 Sc2 St2.Mines" invincible="1"/>
                            <set_group_active group="L2M02 Sc2 St2.Mines" active="0"/>
                            <set_objective cue="L2M02 Scene 2">
                              <briefing cue="L2M02 Scene 2" step="{value@L2M02 Sc2 St2.FlyToStep}"/>
                              <flyto>
                                <sector sector="L2M02.KhaakSec2"/>
                              </flyto>
                            </set_objective>
                          </do_otherwise>
                        </do_choose>
                      </action>
                    </cue>
                    <cue name="L2M02 Sc2 St2 Collected">
                      <condition>
                        <object_destroyed object="L2M02 Sc2 St2.JesanData" param="17"/>
                      </condition>
                      <action>
                        <do_all>
                          <add_cargo>
                            <ware typename="SS_WARE_LOGBOOK" exact="-1"/>
                          </add_cargo>
                          <cancel_cue cue="L2M02 Sc2 St2 Sec Change"/>
                          <set_objective cue="L2M02 Scene 2" title="{3202,11}">
                            <briefing cue="L2M02 Scene 2" step="{value@L2M02 Sc2 St2.PickUpStep}+1"/>
                            <dockat object="L2M02.Base"/>
                          </set_objective>
                          <create_briefing cue="L2M02 Scene 2" background="sector_argon_m148.tga">
                            <objectives>
                              <objective step="{value@L2M02 Sc2 St2.PickUpStep}+1">
                                <dockat object="L2M02.Base"/>
                              </objective>
                            </objectives>
                          </create_briefing>
                          <play_text actor="L2M02.TeSaat" textid="282501" priority="99"/>
                        </do_all>
                      </action>
                      <cues>
                        <cue name="L2M02 Sc2 St2 End">
                          <condition>
                            <object_is_docked dockobject="L2M02.Base"/>
                          </condition>
                          <action>
                            <do_all>
                              <remove_briefing cue="L2M02 Scene 2"/>
                              <remove_objective cue="L2M02 Scene 2" status="complete"/>
                              <reward_player>
                                <money exact="{value@L2M02 Sc2 St2.RewardCr}"/>
                              </reward_player>
                              <play_text actor="L2M02.TeSaat" textid="282203" priority="99"/>
                              <set_mission_rank name="L2OFF" titleid="1" textid="10" exact="36"/>
                              <!--increase khaak activity near base-->
                              <set_value name="L2M02.USKhaakAmt" exact="18"/>
                            </do_all>
                          </action>
                          <cues>
                            <cue name="L2M02 Sc2 St2 End Set Progress">
                              <condition>
                                <cue_completed cue="L2M02 Sc2 St2 End"/>
                              </condition>
                              <timing>
                                <!--<time min="5s" max="6s"/>-->
                                <time min="1200s" max="1800s"/>
                              </timing>
                              <action>
                                <set_value name="L2M02.PlotProgress" exact="3"/>
                              </action>
                            </cue>
                          </cues>
                        </cue>
                      </cues>
                    </cue>
                  </cues>
                </cue>
              </cues>
            </cue>
            <cue name="L2M02 Scene 3" delay="5s">
              <condition>
                <check_value value="{value@L2M02.PlotProgress}" exact="3"/>
              </condition>
              <action>
                <do_all>
                  <incoming_message author="{actor.name@L2M02.TeSaat}" text="{3895,282301}"/>
                  <set_objective cue="L2M02 Scene 3" story="{3200,2}" title="{3202,11}" noabort="1">
                    <mission discipline="XXXT" level="trivial"/>
                    <dockat object="L2M02.Base"/>
                    <!--<custom icon="talkto" action="{35,2012}" text="{actor.name@L2M02.TeSaat}" object="L2M02.Base"/>-->
                  </set_objective>
                  <create_briefing cue="L2M02 Scene 3" title="{3618,1001}" text="{3828,282302}">
                    <objectives>
                      <objective step="1" background="sector_argon_m148.tga">
                        <talkto actor="L2M02.TeSaat"/>
                      </objective>
                    </objectives>
                  </create_briefing>
                  <!--increase khaak activity near base-->
                  <set_value name="L2M02.USKhaakAmt" exact="50"/>
                </do_all>
              </action>
              <cues>
                <cue name="L2M02 Sc3 St1 Docked" delay="2s">
                  <condition>
                    <object_is_docked dockobject="L2M02.Base"/>
                  </condition>
                  <timing>
                    <time exact="10s"/>
                  </timing>
                  <action>
                    <do_all>
                      <play_text actor="L2M02.TeSaat" textid="282302" priority="99"/>
                      <set_mission_rank name="L2OFF" titleid="1" textid="10" exact="39"/>
                      <!--set reward-->
                      <set_value name="L2M02 Scene 3.RewardCr" exact="{reward.money@average.XXXT}"/>
                      <set_objective cue="L2M02 Scene 3" story="{3200,2}" title="{3618,1001}" noabort="1">
                        <briefing cue="L2M02 Scene 3" step="2"/>
                        <mission discipline="XXXT" level="average"/>
                        <reward money="{value@L2M02 Scene 3.RewardCr}"/>
                        <custom icon="flyto" action="{35,2007}" text="{sector.name@L2M02.UnkSec}">
                          <sector sector="L2M02.UnkSec"/>
                        </custom>
                      </set_objective>
                      <create_briefing cue="L2M02 Scene 3" title="{3618,1001}" text="{3828,282302}" background="sector_unknown_14_7.tga">
                        <mission discipline="XXXT" level="average"/>
                        <reward money="{value@L2M02 Scene 3.RewardCr}"/>
                        <objectives>
                          <objective step="2" background="sector_unknown_14_7.tga">
                            <custom icon="flyto" action="{35,2007}" text="{sector.name@L2M02.UnkSec}">
                              <sector sector="L2M02.UnkSec"/>
                            </custom>
                          </objective>
                          <!--now find: asteroid 2006, not scan: asteroid 2026-->
                          <objective step="3" background="space_asteroids.tga">
                            <custom icon="find" action="{35,2006}" text="{35,2148}">
                              <sector sector="L2M02.UnkSec"/>
                            </custom>
                          </objective>
                          <objective step="4" background="space_asteroids.tga">
                            <custom icon="find" action="{35,2006}" text="{35,2148}">
                              <sector sector="L2M02.UnkSec"/>
                            </custom>
                          </objective>
                          <objective step="5" background="space_asteroids.tga">
                            <custom icon="find" action="{35,2006}" text="{35,2148}">
                              <sector sector="L2M02.UnkSec"/>
                            </custom>
                          </objective>
                        </objectives>
                      </create_briefing>
                      <set_value name="L2M02 Scene 3.Step" exact="3"/>
                      <!--create roids for player to find-->
                      <create_asteroid name="L2M02 Scene 3.Roid1" group="L2M02 Scene 3.Roids" invincible="1" minable="0">
                        <position x="13431103" y="1569196" z="28468251"/>
                        <sector x="14" y="7"/>
                        <resource typename="SS_WARE_ORE" exact="27"/>
                      </create_asteroid>
                      <create_asteroid name="L2M02 Scene 3.Roid2" group="L2M02 Scene 3.Roids" invincible="1" minable="0">
                        <position x="-5216350" y="-1907361" z="26305085"/>
                        <sector x="14" y="7"/>
                        <resource typename="SS_WARE_SILICON" exact="36"/>
                      </create_asteroid>
                      <create_asteroid name="L2M02 Scene 3.Roid3" group="L2M02 Scene 3.Roids" invincible="1" minable="0">
                        <position x="-27651370" y="-928641" z="-15012753"/>
                        <sector x="14" y="7"/>
                        <resource typename="SS_WARE_ORE" exact="31"/>
                      </create_asteroid>
                      <add_object_to_group group="L2M02 Scene 3.RoidsToFind" object="L2M02 Scene 3.Roid1"/>
                      <add_object_to_group group="L2M02 Scene 3.RoidsToFind" object="L2M02 Scene 3.Roid2"/>
                      <add_object_to_group group="L2M02 Scene 3.RoidsToFind" object="L2M02 Scene 3.Roid3"/>
                    </do_all>
                  </action>
                  <cues>
                    <cue name="L2M02 Sc3 St1 IS">
                      <condition>
                        <object_sector exact="0">
                          <sector x="14" y="7"/>
                        </object_sector>
                      </condition>
                      <action>
                        <set_objective cue="L2M02 Scene 3">
                          <briefing cue="L2M02 Scene 3" step="3"/>
                          <mission discipline="XXXT" level="average"/>
                          <custom icon="find" action="{35,2006}" text="{35,2148}">
                            <sector sector="L2M02.UnkSec"/>
                          </custom>
                        </set_objective>
                      </action>
                    </cue>
                    <cue name="L2M02 Sc3 St1 Scanned" instantiate="static">
                      <condition>
                        <any_object_scanned group="L2M02 Scene 3.RoidsToFind"/>
                      </condition>
                      <action>
                        <do_all>
                          <cancel_cue cue="L2M02 Sc3 St1 IS"/>
                          <increment_mission_rank name="L2OFF" exact="1"/>
                          <remove_object_from_group object="{event.object}" group="L2M02 Scene 3.RoidsToFind"/>
                          <do_if value="{value@L2M02 Scene 3.Step}+1" max="5">
                            <set_value name="L2M02 Scene 3.Step" operation="add"/>
                          </do_if>
                          <set_objective cue="L2M02 Scene 3">
                            <briefing cue="L2M02 Scene 3" step="{value@L2M02 Scene 3.Step}"/>
                            <mission discipline="XXXT" level="average"/>
                            <custom icon="find" action="{35,2006}" text="{35,2148}">
                              <sector sector="L2M02.UnkSec"/>
                            </custom>
                          </set_objective>
                        </do_all>
                      </action>
                    </cue>
                  </cues>
                </cue>
                <cue name="L2M02 Sc3 St2" delay="2s">
                  <condition>
                    <check_all>
                      <check_value value="{group.object.count@L2M02 Scene 3.Roids}" min="1"/>
                      <check_value value="{group.object.count@L2M02 Scene 3.RoidsToFind}" exact="0"/>
                    </check_all>
                  </condition>
                  <action>
                    <do_all>
                      <set_mission_rank name="L2OFF" titleid="1" textid="10" exact="45"/>
                      <play_text actor="L2M02.TeSaat" textid="282303" priority="99"/>
                      <set_value name="L2M02 Scene 3.Step" operation="add"/>
                      <!--add fight reward to the current reward amount-->
                      <set_value name="L2M02 Scene 3.RewardCr" exact="{value@L2M02 Scene 3.RewardCr}+{reward.money@average.XFXX}"/>
                      <set_objective cue="L2M02 Scene 3">
                        <briefing cue="L2M02 Scene 3" step="{value@L2M02 Scene 3.Step}"/>
                        <mission discipline="XFXX" level="hard"/>
                        <reward money="{value@L2M02 Scene 3.RewardCr}"/>
                        <custom icon="protect" action="{35,2010}" text="{35,2127}">
                          <sector sector="L2M02.UnkSec"/>
                        </custom>
                      </set_objective>
                      <create_briefing cue="L2M02 Scene 3" title="{3618,1001}" text="{3828,282303}">
                        <mission discipline="XFXX" level="hard"/>
                        <reward money="{value@L2M02 Scene 3.RewardCr}"/>
                        <objectives>
                          <objective step="{value@L2M02 Scene 3.Step}" background="combat_buster.tga">
                            <custom icon="protect" action="{35,2010}" text="{35,2127}">
                              <sector sector="L2M02.UnkSec"/>
                            </custom>
                          </objective>
                        </objectives>
                      </create_briefing>
                    </do_all>
                  </action>
                  <cues>
                    <cue name="L2M02 Sc3 St2 Left Sector" delay="250">
                      <condition>
                        <object_sector exact="0" negate="1">
                          <sector x="14" y="7"/>
                        </object_sector>
                      </condition>
                      <action>
                        <incoming_message author="{actor.name@L2M02.TeSaat}" text="{3895,282306}"/>
                      </action>
                    </cue>
                    <cue name="L2M02 Sc3 St2 Create TL" delay="503">
                      <condition>
                        <object_sector exact="0">
                          <sector x="14" y="7"/>
                        </object_sector>
                      </condition>
                      <action>
                        <do_all>
                          <set_object name="L2M02 Sc3 St2.EntryPoint" value="{object.destination@L2M02.UnkSecEG}"/>
                          <do_if value="{player.sector}" exact="{sector@L2M02.NathansVoyage}">
                            <set_object name="L2M02 Sc3 St2.EntryPoint" value="{object@L2M02.UnkSecEG}"/>
                          </do_if>
                          <do_any>
                            <create_ship name="L2M02 Sc3 St2.TL" capturable="0" boardable="0" race="boron" typename="SS_SH_B_TL" chance="60">
                              <position object="L2M02 Sc3 St2.EntryPoint"/>
                              <sector sector="{object.sector@L2M02 Sc3 St2.EntryPoint}"/>
                              <equipment loadout="maximum"/>
                              <cargo>
                                <ware typename="SS_FAC_A_ORE_1" exact="2" critical="1"/>
                                <ware typename="SS_FAC_A_SIL_1" exact="1" critical="1"/>
                                <ware typename="SS_WARE_FREIGHTDRONE" min="60" max="80"/>
                              </cargo>
                            </create_ship>
                            <create_ship name="L2M02 Sc3 St2.TL" capturable="0" boardable="0" race="argon" typename="SS_SH_A_TL" chance="25">
                              <position object="L2M02 Sc3 St2.EntryPoint"/>
                              <sector sector="{object.sector@L2M02 Sc3 St2.EntryPoint}"/>
                              <equipment loadout="maximum"/>
                              <cargo>
                                <ware typename="SS_FAC_A_ORE_1" exact="2" critical="1"/>
                                <ware typename="SS_FAC_A_SIL_1" exact="1" critical="1"/>
                                <ware typename="SS_WARE_FREIGHTDRONE" min="60" max="80"/>
                              </cargo>
                            </create_ship>
                            <create_ship name="L2M02 Sc3 St2.TL" capturable="0" boardable="0" race="teladi" typename="SS_SH_T_TL" chance="15">
                              <position object="L2M02 Sc3 St2.EntryPoint"/>
                              <sector sector="{object.sector@L2M02 Sc3 St2.EntryPoint}"/>
                              <equipment loadout="maximum"/>
                              <cargo>
                                <ware typename="SS_FAC_A_ORE_1" exact="2" critical="1"/>
                                <ware typename="SS_FAC_A_SIL_1" exact="1" critical="1"/>
                                <ware typename="SS_WARE_FREIGHTDRONE" min="60" max="80"/>
                              </cargo>
                            </create_ship>
                          </do_any>
                          <add_equipment object="L2M02 Sc3 St2.TL">
                            <ware typename="SS_WARE_TECH213" exact="{object.equipment.SS_WARE_TECH213.maxcount@L2M02 Sc3 St2.TL}-{object.equipment.SS_WARE_TECH213.count@L2M02 Sc3 St2.TL}"/>
                            <ware typename="SS_WARE_TECH246" exact="{object.equipment.SS_WARE_TECH246.maxcount@L2M02 Sc3 St2.TL}-{object.equipment.SS_WARE_TECH246.count@L2M02 Sc3 St2.TL}+5"/>
                            <ware typename="SS_WARE_BEAMING" exact="1"/>
                            <ware typename="SS_WARE_WARPING" exact="1"/>
                            <ware typename="SS_WARE_TECH275" exact="1"/>
                            <ware typename="SS_WARE_TECH277" exact="1"/>
                            <ware typename="SS_WARE_ORE" min="50" max="120"/>
                          </add_equipment>
                          <do_if value="{actor.exists@L2M02 Sc3 St2.Captain}" exact="1">
                            <destroy_actor actor="L2M02 Sc3 St2.Captain"/>
                          </do_if>
                          <create_actor name="L2M02 Sc3 St2.Captain" race="{object.maker@L2M02 Sc3 St2.TL}" voiceflags="32" object="L2M02 Sc3 St2.TL" location="pilot"/>
                        </do_all>
                      </action>
                      <cues>
                        <cue name="L2M02 Sc3 St2 TL IS" delay="8s">
                          <condition>
                            <check_all>
                              <object_sector object="L2M02 Sc3 St2.TL" exact="0">
                                <sector sector="L2M02.UnkSec"/>
                              </object_sector>
                              <object_sector exact="0">
                                <sector sector="L2M02.UnkSec"/>
                              </object_sector>
                            </check_all>
                          </condition>
                          <action>
                            <do_all>
                              <set_objective cue="L2M02 Scene 3">
                                <briefing cue="L2M02 Scene 3" step="{value@L2M02 Scene 3.Step}"/>
                                <protect object="L2M02 Sc3 St2.TL"/>
                              </set_objective>
                              <create_briefing cue="L2M02 Scene 3">
                                <objectives>
                                  <objective step="{value@L2M02 Scene 3.Step}" background="combat_buster.tga">
                                    <protect object="L2M02 Sc3 St2.TL"/>
                                  </objective>
                                </objectives>
                              </create_briefing>
                              <play_text priority="99">
                                <line actor="L2M02 Sc3 St2.Captain" textid="930"/>
                                <line actor="L2M02 Sc3 St2.Captain" textid="939"/>
                              </play_text>
                              <do_if value="{group.object.count@L2M02 Sc3 St2.KhaakSquad}" min="1">
                                <do_if value="{group.strongest.isclass.bigship@L2M02 Sc3 St2.KhaakSquad}" exact="0">
                                  <set_group_command group="L2M02 Sc3 St2.KhaakSquad" command="attack" commandobject="L2M02 Sc3 St2.TL"/>
                                  <cancel_cue cue="L2M02 Sc3 St2 TL IS Enemies"/>
                                </do_if>
                              </do_if>
                            </do_all>
                          </action>
                          <cues>
                            <cue name="L2M02 Sc3 St2 TL IS Enemies">
                              <action>
                                <do_all>
                                  <create_spacefly name="L2M02 Sc3 St2 TL IS Enemies.Spacefly">
                                    <position x="0" y="0" z="0" min="5km" max="8km"/>
                                    <sector sector="L2M02.UnkSec"/>
                                  </create_spacefly>
                                  <do_if value="{object.distance.m@L2M02 Sc3 St2 TL IS Enemies.Spacefly}" max="8000">
                                    <destroy_object object="L2M02 Sc3 St2 TL IS Enemies.Spacefly"/>
                                    <create_spacefly name="L2M02 Sc3 St2 TL IS Enemies.Spacefly">
                                      <position object="{player.ship}" min="20km" max="25km"/>
                                      <sector sector="L2M02.UnkSec"/>
                                    </create_spacefly>
                                  </do_if>
                                </do_all>
                              </action>
                              <cues>
                                <cue name="L2M02 Sc3 St2 OBS Finished"/>
                                <cue ref="OBS">
                                  <params>
                                    <param name="OBS Cue" value="L2M02 Sc3 St2"/>
                                    <param name="OBS Cancel Cue" value="L2M02 Sc3 St2 OBS Finished"/>
                                    <param name="OBS Fleet Group Name" value="KhaakSquad"/>
                                    <param name="OBSFleetRace" value="{lookup.race@khaak}"/>
                                    <param name="OBSFleetPilotsRace" value="{lookup.race@khaak}"/>
                                    <param name="OBSMissionRank" value="{player.fightrank.rank}"/>
                                    <param name="OBSDifficultyRank" value="{lookup.level@average}"/>
                                    <param name="OBSFleetPositionObject" value="L2M02 Sc3 St2 TL IS Enemies.Spacefly"/>
                                    <param name="OBSSector" value="L2M02.UnkSec"/>
                                    <param name="OBSPosition" value="500m"/>
                                    <param name="OBSFleetCapturable" value="0"/>
                                    <param name="OBSFleetCommunicates" value="0"/>
                                    <param name="OBS Dock Support" value="1"/>
                                    <param name="OBS Support Overflow" value="1"/>
                                    <param name="OBS PointsMin" value="({value@Constant {lookup.class@m6} Points}*3)/2"/>
                                    <param name="OBS PointsMax" value="{value@Constant {lookup.class@m2} Points}+{value@Constant {lookup.class@m6} Points}-1"/>
                                  </params>
                                </cue>
                                <cue name="L2M02 Sc3 St2 Enemy Orders">
                                  <condition>
                                    <cue_cancelled cue="L2M02 Sc3 St2 OBS Finished"/>
                                  </condition>
                                  <action>
                                    <do_all exact="{group.object.count@L2M02 Sc3 St2.KhaakSquad}" counter="num">
                                      <do_choose>
                                        <do_when value="{group.object.{counter@num}@L2M02 Sc3 St2.KhaakSquad}" exact="{group.strongest@L2M02 Sc3 St2.KhaakSquad}">
                                          <set_command object="{group.object.{counter@num}@L2M02 Sc3 St2.KhaakSquad}" command="attack" commandobject="L2M02 Sc3 St2.TL"/>
                                        </do_when>
                                        <do_otherwise>
                                          <do_any>
                                            <set_command object="{group.object.{counter@num}@L2M02 Sc3 St2.KhaakSquad}" command="attack" commandobject="L2M02 Sc3 St2.TL"/>
                                            <set_command object="{group.object.{counter@num}@L2M02 Sc3 St2.KhaakSquad}" command="protect" commandobject="{group.strongest@L2M02 Sc3 St2.KhaakSquad}"/>
                                            <set_command object="{group.object.{counter@num}@L2M02 Sc3 St2.KhaakSquad}" command="killenemies"/>
                                            <set_command object="{group.object.{counter@num}@L2M02 Sc3 St2.KhaakSquad}" command="attack" commandobject="{player.ship}"/>
                                          </do_any>
                                        </do_otherwise>
                                      </do_choose>
                                      <!--<set_group_command group="L2M02 Sc3 St2.KhaakSquad" command="protect" commandobject="{group.strongest@L2M02 Sc3 St2.KhaakSquad}"/>
                                      <set_command object="{group.strongest@L2M02 Sc3 St2.KhaakSquad}" command="attack" commandobject="L2M02 Sc3 St2.TL"/>-->
                                      <destroy_object object="L2M02 Sc3 St2 TL IS Enemies.Spacefly"/>
                                    </do_all>
                                  </action>
                                </cue>
                              </cues>
                            </cue>
                            <cue name="L2M02 Sc3 St2 EnemyCheck" instantiate="static" delay="300s">
                              <condition>
                                <check_all>
                                  <!--less than 4 enemies attacking-->
                                  <count_ships class="ship" maker="khaak" race="khaak" multiple="1" max="4">
                                    <position object="L2M02 Sc3 St2.TL"/>
                                    <sector sector="L2M02.UnkSec"/>
                                    <jumps exact="0"/>
                                    <distance max="10km"/>
                                  </count_ships>
                                  <!--but some nearby!-->
                                  <count_ships class="ship" maker="khaak" race="khaak" multiple="1" min="1">
                                    <position object="L2M02 Sc3 St2.TL"/>
                                    <sector sector="L2M02.UnkSec"/>
                                    <jumps exact="0"/>
                                    <distance min="10km" max="35km"/>
                                  </count_ships>
                                </check_all>
                              </condition>
                              <action>
                                <do_all>
                                  <find_ship group="this.khaakships" class="ship" maker="khaak" race="khaak" multiple="1" nearest="1" max="8">
                                    <position object="L2M02 Sc3 St2.TL" exact="1"/>
                                    <sector sector="L2M02.UnkSec"/>
                                    <jumps exact="0"/>
                                    <distance min="10km" max="35km"/>
                                  </find_ship>
                                  <set_group_command group="this.khaakships" command="attack" commandobject="L2M02 Sc3 St2.TL"/>
                                  <remove_group group="this.khaakships"/>
                                </do_all>
                              </action>
                            </cue>
                          </cues>
                        </cue>
                        <cue name="L2M02 Sc3 St2 TL Orders">
                          <condition>
                            <check_value value="{object.exists@L2M02 Sc3 St2.TL}" exact="1"/>
                          </condition>
                          <timing>
                            <time min="50" max="100"/>
                          </timing>
                          <action>
                            <do_choose>
                              <do_when value="{object.exists@L2M02 Scene 3.Roid1}" exact="1">
                                <set_object name="L2M02 Scene 3.RoidDest" value="{object@L2M02 Scene 3.Roid1}"/>
                                <set_command object="L2M02 Sc3 St2.TL" command="retreat" distance="1km">
                                  <position x="{object.position.x@L2M02 Scene 3.Roid1}" y="{object.position.y@L2M02 Scene 3.Roid1}" z="{object.position.z@L2M02 Scene 3.Roid1}-5km"/>
                                  <sector sector="{object.sector@L2M02 Scene 3.Roid1}"/>
                                </set_command>
                                <set_value name="L2M02 Sc3 St2.Dest" exact="1"/>
                              </do_when>
                              <do_when value="{object.exists@L2M02 Scene 3.Roid2}" exact="1">
                                <set_object name="L2M02 Scene 3.RoidDest" value="{object@L2M02 Scene 3.Roid2}"/>
                                <set_command object="L2M02 Sc3 St2.TL" command="retreat" distance="1km">
                                  <position x="{object.position.x@L2M02 Scene 3.Roid2}" y="{object.position.y@L2M02 Scene 3.Roid2}" z="{object.position.z@L2M02 Scene 3.Roid2}-5km"/>
                                  <sector sector="{object.sector@L2M02 Scene 3.Roid2}"/>
                                </set_command>
                                <set_value name="L2M02 Sc3 St2.Dest" exact="2"/>
                                <reset_cue cue="L2M02 Sc3 St2 TL Dest Reached"/>
                              </do_when>
                              <do_when value="{object.exists@L2M02 Scene 3.Roid3}" exact="1">
                                <set_object name="L2M02 Scene 3.RoidDest" value="{object@L2M02 Scene 3.Roid3}"/>
                                <!--<set_command object="L2M02 Sc3 St2.TL" command="moveposition" distance="5km">-->
                                <set_command object="L2M02 Sc3 St2.TL" command="retreat" distance="5km">
                                  <position object="L2M02 Scene 3.Roid3"/>
                                  <sector sector="{object.sector@L2M02 Scene 3.Roid3}"/>
                                </set_command>
                                <set_value name="L2M02 Sc3 St2.Dest" exact="3"/>
                                <reset_cue cue="L2M02 Sc3 St2 TL Dest Reached"/>
                              </do_when>
                              <do_otherwise>
                                <play_text actor="L2M02 Sc3 St2.Captain" textid="840" priority="99"/>
                                <cancel_cue cue="L2M02 Sc3 St2 Create TL"/>
                              </do_otherwise>
                            </do_choose>
                          </action>
                        </cue>
                        <cue name="L2M02 Sc3 St2 TL Destroyed">
                          <condition>
                            <check_any>
                              <object_destroyed object="L2M02 Sc3 St2.TL"/>
                              <object_destroyed_by_player object="L2M02 Sc3 St2.TL"/>
                            </check_any>
                          </condition>
                          <action>
                            <do_all>
                              <set_objective cue="L2M02 Scene 3" silent="1">
                                <briefing cue="L2M02 Scene 3" step="{value@L2M02 Scene 3.Step}"/>
                                <mission discipline="XFXX" level="hard"/>
                                <custom icon="protect" action="{35,2010}" text="{35,2127}">
                                  <sector sector="L2M02.UnkSec"/>
                                </custom>
                              </set_objective>
                              <create_briefing cue="L2M02 Scene 3" title="{3618,1001}" text="{3828,282303}">
                                <mission discipline="XFXX" level="hard"/>
                                <objectives>
                                  <objective step="{value@L2M02 Scene 3.Step}" background="combat_buster.tga">
                                    <custom icon="protect" action="{35,2010}" text="{35,2127}">
                                      <sector sector="L2M02.UnkSec"/>
                                    </custom>
                                  </objective>
                                </objectives>
                              </create_briefing>
                              <do_if value="{group.object.count@L2M02 Sc3 St2.KhaakSquad}" min="1">
                                <set_group_command group="L2M02 Sc3 St2.KhaakSquad" command="killenemies"/>
                              </do_if>
                              <incoming_message author="{actor.name@L2M02.TeSaat}" text="{3895,282305}"/>
                              <reset_cue cue="L2M02 Sc3 St2 Create TL"/>
                            </do_all>
                          </action>
                        </cue>
                        <cue name="L2M02 Sc3 St2 TL Dest Reached" delay="5s">
                          <condition>
                            <check_all>
                              <check_value value="{value@L2M02 Sc3 St2.Dest}" min="1"/>
                              <check_value value="{object.exists@L2M02 Sc3 St2.TL}" exact="1"/>
                              <check_value value="{object.sector@L2M02 Sc3 St2.TL}" exact="{sector@L2M02.UnkSec}"/>
                              <object_position object="L2M02 Sc3 St2.TL" max="8000m">
                                <position object="L2M02 Scene 3.RoidDest"/>
                                <sector sector="L2M02.UnkSec"/>
                              </object_position>
                              <object_sector exact="0">
                                <sector sector="L2M02.UnkSec"/>
                              </object_sector>
                              <object_sector object="L2M02 Sc3 St2.TL" exact="0">
                                <sector sector="L2M02.UnkSec"/>
                              </object_sector>
                            </check_all>
                          </condition>
                          <action>
                            <do_all>
                              <set_command object="L2M02 Sc3 St2.TL" command="stay"/>
                              <add_cargo object="L2M02 Sc3 St2.TL">
                                <ware typename="SS_WARE_FREIGHTDRONE" exact="-20"/>
                              </add_cargo>
                              <play_text actor="L2M02 Sc3 St2.Captain" textid="928" priority="99"/>
                            </do_all>
                          </action>
                          <cues>
                            <cue name="L2M02 Sc3 St2 TL Build Wait">
                              <timing>
                                <time min="45s" max="60s"/>
                              </timing>
                              <cues>
                                <cue name="L2M02 Sc3 St2 TL Build" delay="1s">
                                  <condition>
                                    <check_all>
                                      <cue_is_complete cue="L2M02 Sc3 St2 TL Build Wait"/>
                                      <object_sector exact="0">
                                        <sector sector="L2M02.UnkSec"/>
                                      </object_sector>
                                    </check_all>
                                  </condition>
                                  <action>
                                    <do_all>
                                      <!--NEED STATION BUILDING CUTSCENE?-->
                                      <do_choose>
                                        <do_when value="{object.exists@L2M02 Sc3 St2.TL}" exact="0">
                                          <reset_cue cue="L2M02 Sc3 St2 Create TL"/>
                                        </do_when>
                                        <do_otherwise>
                                          <!--get position and remove asteroid-->
                                          <set_invincible object="L2M02 Scene 3.RoidDest" invincible="0"/>
                                          <set_minable object="L2M02 Scene 3.RoidDest" minable="1"/>
                                          <set_sector name="this.sec" value="{object.sector@L2M02 Scene 3.RoidDest}"/>
                                          <set_value name="this.x" exact="{object.position.x@L2M02 Scene 3.RoidDest}"/>
                                          <set_value name="this.y" exact="{object.position.y@L2M02 Scene 3.RoidDest}"/>
                                          <set_value name="this.z" exact="{object.position.z@L2M02 Scene 3.RoidDest}"/>
                                          <destroy_object object="L2M02 Scene 3.RoidDest"/>
                                          <set_value name="L2M02 Sc3 St2.Dest" exact="0"/>
                                          <!--build the mine-->
                                          <do_choose>
                                            <do_when value="{value@L2M02 Sc3 St2.Dest}" exact="1">
                                              <create_station name="L2M02 Scene 3.Mine1" typename="SS_FAC_A_ORE_1" race="argon" safety="0">
                                                <position x="{value@this.x}" y="{value@this.y}" z="{value@this.z}"/>
                                                <sector sector="this.sec"/>
                                                <equipment loadout="default"/>
                                              </create_station>
                                              <add_cargo object="L2M02 Sc3 St2.TL">
                                                <ware typename="SS_FAC_A_ORE_1" exact="-1"/>
                                              </add_cargo>
                                              <set_mission_rank name="L2OFF" titleid="1" textid="10" exact="52"/>
                                            </do_when>
                                            <do_when value="{value@L2M02 Sc3 St2.Dest}" exact="2">
                                              <create_station name="L2M02 Scene 3.Mine2" typename="SS_FAC_A_ORE_1" race="argon" safety="0" invincible="1">
                                                <position x="{value@this.x}" y="{value@this.y}" z="{value@this.z}"/>
                                                <sector sector="this.sec"/>
                                                <equipment loadout="default"/>
                                              </create_station>
                                              <add_cargo object="L2M02 Sc3 St2.TL">
                                                <ware typename="SS_FAC_A_ORE_1" exact="-1"/>
                                              </add_cargo>
                                              <set_mission_rank name="L2OFF" titleid="1" textid="10" exact="60"/>
                                              <set_group_command group="L2M02 Sc3 St2.FreightDrones" command="dock" commandobject="L2M02 Scene 3.Mine2"/>
                                            </do_when>
                                            <do_otherwise>
                                              <create_station name="L2M02 Scene 3.Mine3" typename="SS_FAC_A_SIL_1" race="argon" safety="0">
                                                <position x="{value@this.x}" y="{value@this.y}" z="{value@this.z}"/>
                                                <sector sector="this.sec"/>
                                                <equipment loadout="default"/>
                                              </create_station>
                                              <add_cargo object="L2M02 Sc3 St2.TL">
                                                <ware typename="SS_FAC_A_SIL_1" exact="-1"/>
                                              </add_cargo>
                                              <set_mission_rank name="L2OFF" titleid="1" textid="10" exact="80"/>
                                              <set_group_command group="L2M02 Sc3 St2.FreightDrones" command="dock" commandobject="L2M02 Scene 3.Mine3"/>
                                            </do_otherwise>
                                          </do_choose>
                                          <!--play actor speech-->
                                          <do_any>
                                            <play_text priority="99">
                                              <line actor="L2M02 Sc3 St2.Captain" textid="955"/>
                                              <line actor="L2M02 Sc3 St2.Captain" textid="939"/>
                                            </play_text>
                                            <play_text priority="99">
                                              <line actor="L2M02 Sc3 St2.Captain" textid="954"/>
                                              <line actor="L2M02 Sc3 St2.Captain" textid="939"/>
                                              <line actor="L2M02 Sc3 St2.Captain" textid="937"/>
                                            </play_text>
                                          </do_any>
                                          <!--reset cue for next roid-->
                                          <reset_cue cue="L2M02 Sc3 St2 TL Orders"/>
                                        </do_otherwise>
                                      </do_choose>
                                    </do_all>
                                  </action>
                                </cue>
                              </cues>
                            </cue>
                          </cues>
                        </cue>
                      </cues>
                    </cue>
                    <!--<cue name="L2M02 Sc3 St3" delay="2s">
                      <condition>
                        <check_value value="{group.object.count@L2M02 Scene 3.Roids}" exact="0"/>
                      </condition>
                      <timing>
                        <time exact="{text.duration@{actor.voice@L2M02 Sc3 St2.Captain},840}+3s"/>
                      </timing>
                      <action>
                        <do_all>
                          <destroy_object object="L2M02 Sc3 St2.TL" warp="1" explosion="0"/>
                          <play_text actor="L2M02.TeSaat" textid="282304" priority="99"/>
                        </do_all>
                      </action>
                      <cues>
                        <cue name="L2M02 Sc3 St3 Start" delay="1s">
                          <condition>
                            <cue_is_complete cue="L2M02 Sc3 St3"/>
                          </condition>
                          <cues>
                            <cue ref="L0M24 B">
                              <params>
                                <param name="Cue" value="L2M02 Scene 3"/>
                                <param name="ID" value="1"/>
                                <param name="OfferRace" value="{lookup.race@argon}"/>
                                <param name="EnemyRace" value="{lookup.race@khaak}"/>
                                <param name="Lv1Guide" value="L2M02.TeSaat"/>
                                <param name="PageID" value="3828"/>
                                <param name="TextID" value="282304"/>
                                <param name="RewardCr" value="L2M02 Sc3 St3.RewardCr"/>
                                <param name="StoryID" value="2"/>
                                <param name="ChapterID" value="203"/>
                                <param name="Difficulty" value="{lookup.level@hard}"/>
                                <param name="IsPlot" value="1"/>
                                <param name="Step" value="5"/>
                                <param name="Ware" value="{lookup.type@SS_SH_ORBITALLASER}"/>
                                <param name="Amount" value="3"/>
                                <param name="Object" value="L2M02 Scene 3.Roid2"/>
                                <param name="PositionRange" value="10000"/>
                                <param name="BriefingBackground" value="space_asteroids.tga"/>
                              </params>
                            </cue>
                            <cue name="L2M02 Sc3 St3 Wait" delay="100">
                              <condition>
                                <cue_is_complete cue="L0M24 B"/>
                              </condition>
                              <cues>
                                <cue ref="L0M24">
                                  <params>
                                    <param name="Cue" value="L2M02 Scene 3"/>
                                    <param name="ID" value="1"/>
                                    <param name="OfferRace" value="{lookup.race@argon}"/>
                                    <param name="EnemyRace" value="{lookup.race@khaak}"/>
                                    <param name="Lv1Guide" value="L2M02.TeSaat"/>
                                    <param name="PageID" value="3828"/>
                                    <param name="TextID" value="282304"/>
                                    <param name="RewardCr" value="L2M02 Sc3 St3.RewardCr"/>
                                    <param name="StoryID" value="2"/>
                                    <param name="ChapterID" value="203"/>
                                    <param name="Difficulty" value="{lookup.level@hard}"/>
                                    <param name="IsPlot" value="1"/>
                                    <param name="AddText" value="1"/>
                                  </params>
                                </cue>
                                <cue name="L2M02 Sc3 St3 End">
                                  <condition>
                                    <check_value value="L2M02 Scene 3.1 L0M24 Progress" exact="1"/>
                                  </condition>
                                  <action>
                                    <do_all>
                                      <set_mission_rank name="L2OFF" titleid="1" textid="10" exact="101"/>
                                      <play_text priority="99">
                                        <line actor="L2M02.TeSaat" textid="282804"/>
                                        <line actor="L2M02.TeSaat" textid="282608"/>
                                      </play_text>
                                    </do_all>
                                  </action>
                                  <cues>
                                    <cue name="L2M02 Sc3 St3 End Set Progress">
                                      <condition>
                                        <cue_completed cue="L2M02 Sc3 St3 End"/>
                                      </condition>
                                      <timing>
                                        <time min="1200s" max="1800s"/>
                                      </timing>
                                      <action>
                                        <set_value name="L2M02.PlotProgress" exact="4"/>
                                      </action>
                                    </cue>
                                  </cues>
                                </cue>
                              </cues>
                            </cue>
                          </cues>
                        </cue>
                      </cues>
                    </cue>-->
                    <cue name="L2M02 Sc3 St2 End" delay="2s">
                      <condition>
                        <check_value value="{group.object.count@L2M02 Scene 3.Roids}" exact="0"/>
                      </condition>
                      <timing>
                        <time exact="{text.duration@{actor.voice@L2M02 Sc3 St2.Captain},840}+3s"/>
                      </timing>
                      <action>
                        <do_all>
                          <destroy_object object="L2M02 Sc3 St2.TL" warp="1" explosion="0"/>
                          <set_mission_rank name="L2OFF" titleid="1" textid="10" exact="101"/>
                          <play_text priority="99">
                            <line actor="L2M02.TeSaat" textid="282804"/>
                            <line actor="L2M02.TeSaat" textid="282608"/>
                          </play_text>
                          <remove_objective cue="L2M02 Scene 3" status="complete"/>
                          <remove_briefing cue="L2M02 Scene 3"/>
                          <incoming_message author="{actor.name@L2M02.TeSaat}" text="{{actor.voice@L2M02.TeSaat},282804} {{actor.voice@L2M02.TeSaat},282608}"/>
                        </do_all>
                      </action>
                      <cues>
                        <cue name="L2M02 Sc3 St2 End Set Progress">
                          <condition>
                            <cue_completed cue="L2M02 Sc3 St2 End"/>
                          </condition>
                          <timing>
                            <time min="1200s" max="1800s"/>
                          </timing>
                          <action>
                            <set_value name="L2M02.PlotProgress" exact="4"/>
                          </action>
                        </cue>
                      </cues>
                    </cue>
                  </cues>
                </cue>
              </cues>
            </cue>
            <cue name="L2M02 Scene 4" delay="5s">
              <condition>
                <check_value value="{value@L2M02.PlotProgress}" exact="4"/>
              </condition>
              <action>
                <do_all>
                  <set_mission_rank name="L2OFF" titleid="1" textid="10" exact="105"/>
                  <incoming_message author="{actor.name@L2M02.TeSaat}" text="{3895,282401}"/>
                  <set_objective cue="L2M02 Scene 4" story="{3200,2}" title="{3202,11}" noabort="1">
                    <mission discipline="XXXT" level="trivial"/>
                    <dockat object="L2M02.Base"/>
                    <!--<custom icon="talkto" action="{35,2012}" text="{actor.name@L2M02.TeSaat}" object="L2M02.Base"/>-->
                  </set_objective>
                  <create_briefing cue="L2M02 Scene 4" title="{3200,2}" text="{3895,282401}">
                    <objectives>
                      <objective step="1">
                        <talkto actor="L2M02.TeSaat"/>
                      </objective>
                    </objectives>
                  </create_briefing>
                </do_all>
              </action>
              <cues>
                <cue name="L2M02 Sc4 St1" delay="2s">
                  <condition>
                    <object_is_docked dockobject="L2M02.Base"/>
                  </condition>
                  <timing>
                    <time exact="10s"/>
                  </timing>
                  <action>
                    <do_all>
                      <play_text actor="L2M02.TeSaat" textid="282402" priority="99"/>
                      <find_gate name="this.gate" gate="east">
                        <sector sector="L2M02.UnkSec"/>
                      </find_gate>
                      <do_all min="3" max="5" counter="num">
                        <create_ship name="L2M02 Sc4 St1.Convoy Ship" typename="{random.type@SS_SH_T_TM|SS_SH_T_M6|SS_SH_T_M3_1|SS_SH_T_TS|SS_SH_T_TS_1|SS_SH_T_TS_1|SS_SH_T_TS_1|SS_SH_T_TS_5}" capturable="0" race="teladi">
                          <position object="this.gate"/>
                          <sector sector="{object.sector@this.gate}"/>
                          <equipment loadout="default"/>
                          <cargo>
                            <ware typename="SS_WARE_NIVIDIUM2" min="100" max="200"/>
                          </cargo>
                          <command command="dock" commandobject="L2M02.Base"/>
                          <relations>
                            <relation relation="friend" mutual="0"/>
                          </relations>
                          <pilot jobtextid="40001"/>
                        </create_ship>
                        <add_equipment object="L2M02 Sc4 St1.Convoy Ship">
                          <ware typename="SS_WARE_TECH213" min="(({object.equipment.SS_WARE_TECH213.maxcount@L2M02 Sc4 St1.Convoy Ship}-{object.equipment.SS_WARE_TECH213.count@L2M02 Sc4 St1.Convoy Ship}) * 7)/10" max="{object.equipment.SS_WARE_TECH213.maxcount@L2M02 Sc4 St1.Convoy Ship}-{object.equipment.SS_WARE_TECH213.count@L2M02 Sc4 St1.Convoy Ship}"/>
                        </add_equipment>
                        <do_if value="{object.maxspeed@L2M02 Sc4 St1.Convoy Ship}" max="90">
                          <add_equipment object="L2M02 Sc4 St1.Convoy Ship">
                            <ware typename="SS_WARE_TECH213" exact="{object.equipment.SS_WARE_TECH213.maxcount@L2M02 Sc4 St1.Convoy Ship}-{object.equipment.SS_WARE_TECH213.count@L2M02 Sc4 St1.Convoy Ship}"/>
                          </add_equipment>
                        </do_if>
                        <do_if value="{object.type@L2M02 Sc4 St1.Convoy Ship}" exact="{lookup.type@SS_SH_T_TM}">
                          <do_all min="1" max="4" counter="ship" profile="decreasing">
                            <create_ship name="L2M02 Sc4 St1.Convoy Ship {counter@ship}" group="L2M02 Sc4 St1.Convoy Guards" typename="{random.type@SS_SH_T_M4|SS_SH_T_M4_2|SS_SH_T_M4_3|SS_SH_T_M4P|SS_SH_T_M5|SS_SH_T_M5_2|SS_SH_T_M5_3|SS_SH_T_M5P}" dockobject="L2M02 Sc4 St1.Convoy Ship" capturable="0" race="teladi" homebase="L2M02 Sc4 St1.Convoy Ship">
                              <equipment loadout="maximum"/>
                              <command command="none"/>
                              <relations>
                                <relation relation="friend" mutual="0"/>
                              </relations>
                              <pilot jobtextid="40004"/>
                            </create_ship>
                            <add_equipment object="L2M02 Sc4 St1.Convoy Ship {counter@ship}">
                              <ware typename="SS_WARE_TECH213" min="(({object.equipment.SS_WARE_TECH213.maxcount@L2M02 Sc4 St1.Convoy Ship {counter@ship}}-{object.equipment.SS_WARE_TECH213.count@L2M02 Sc4 St1.Convoy Ship {counter@ship}}) * 7)/10" max="{object.equipment.SS_WARE_TECH213.maxcount@L2M02 Sc4 St1.Convoy Ship {counter@ship}}-{object.equipment.SS_WARE_TECH213.count@L2M02 Sc4 St1.Convoy Ship {counter@ship}}"/>
                            </add_equipment>
                          </do_all>
                        </do_if>
                        <set_object name="L2M02 Sc4 St1.Convoy {object@L2M02 Sc4 St1.Convoy Ship}" value="{object@L2M02 Sc4 St1.Convoy Ship}" group="L2M02 Sc4 St1.Convoy"/>
                      </do_all>
                      <set_value name="L2M02 Sc4 St1.GuardStrength" min="{group.object.count@L2M02 Sc4 St1.Convoy Guards}*3" max="{group.object.count@L2M02 Sc4 St1.Convoy Guards}*7"/>
                      <set_value name="L2M02 Sc4 St1.Step" exact="2"/>
                      <set_objective cue="L2M02 Scene 4" title="{3319,1001}" silent="1"/>
                      <create_briefing cue="L2M02 Scene 4" title="{3319,1001}" text="{3828,282402}"/>
                    </do_all>
                  </action>
                  <cues>
                    <cue name="L2M02 Sc4 St1 Wait">
                      <condition>
                        <cue_completed cue="L2M02 Sc4 St1"/>
                      </condition>
                      <cues>
                        <cue ref="COM01">
                          <params>
                            <param name="GroupName" value="L2M02 Sc4 St1.Convoy"/>
                            <param name="DestName" value="L2M02.Base"/>
                            <param name="Follow Leader" value="1"/>
                            <param name="Cleanup Individuals" value="1"/>
                            <param name="CleanupName" value="L2M02 Sc4 St1.ConvoyCleanupShips"/>
                          </params>
                        </cue>
                        <cue ref="L0M19">
                          <params>
                            <param name="Cue" value="L2M02 Scene 4"/>
                            <param name="Step" value="L2M02 Sc4 St1.Step"/>
                            <!--<param name="DestName" value="L2M02.Base"/>-->
                            <param name="DestSector" value="L2M02.MS148"/>
                            <param name="OfferRace" value="{object.maker@L2M02 Sc4 St1.Convoy Ship}"/>
                            <!--not needed?-->
                            <param name="Dockat Dest" value="1"/>
                            <param name="AllowLoss" value="1"/>
                            <param name="Complete Briefing" value="1"/>
                            <param name="SetObjective" value="1"/>
                            <param name="GroupName" value="L2M02 Sc4 St1.Convoy"/>
                            <param name="Difficulty" value="{lookup.level@hard}"/>
                            <param name="StoryID" value="2"/>
                            <param name="ChapterID" value="204"/>
                            <param name="IsPlot" value="1"/>
                            <param name="FeedbackName" value="L2M02 Sc4 St1.1 L0M19 Progress"/>
                            <param name="OBSDelay" value="(500/{lookup.level@hard})"/>
                            <param name="OBS" value="1"/>
                            <param name="MaxOBSRuns" value="0"/>
                            <param name="OBS Counter" value="L2M02 Sc4 St1.OBSCounter"/>
                            <param name="OBS Cue" value="L2M02 Sc4 St1"/>
                            <param name="OBSFleetRace" value="{lookup.race@khaak}"/>
                            <param name="OBSFleetPilotsRace" value="{lookup.race@khaak}"/>
                            <param name="OBSMissionRank" value="{player.fightrank.rank}"/>
                            <param name="OBSDifficultyRank" value="{lookup.level@average}"/>
                            <param name="OBS PointsMin" value="{value@Constant {lookup.class@m4} Points}*2-1"/>
                            <param name="OBS PointsMax" value="{value@Constant {lookup.class@m6} Points}"/>
                            <param name="OBSFleetCapturable" value="0"/>
                            <param name="OBSFleetCommunicates" value="0"/>
                            <param name="Include Clusters" value="1"/>
                            <param name="BriefingBackground" value="ship_argon_mercury.tga"/>
                          </params>
                        </cue>
                        <cue name="L2M02 Sc4 St1 Complete">
                          <condition>
                            <check_value value="{value@L2M02 Sc4 St1.1 L0M19 Progress}" min="1"/>
                          </condition>
                          <action>
                            <do_choose>
                              <do_when value="{value@L2M02 Sc4 St1.1 L0M19 Progress}" exact="1">
                                <cancel_cue cue="L2M02 Sc4 St1 Reset"/>
                              </do_when>
                              <do_otherwise>
                                <cancel_cue cue="L2M02 Sc4 St2"/>
                                <set_mission_rank name="L2OFF" titleid="1" textid="10" exact="128"/>
                                <play_text actor="L2M02.TeSaat" textid="282603" priority="99"/>
                                <remove_briefing cue="L2M02 Scene 4"/>
                                <remove_objective cue="L2M02 Scene 4" status="failed"/>
                              </do_otherwise>
                            </do_choose>
                          </action>
                          <cues>
                            <cue name="L2M02 Sc4 St1 Reset" delay="5s">
                              <condition>
                                <check_value value="{group.object.count@L2M02 Sc4 St1.Convoy}+{group.object.count@L2M02 Sc4 St1.ConvoyCleanupShips}" exact="0"/>
                              </condition>
                              <action>
                                <reset_cue cue="L2M02 Scene 4"/>
                              </action>
                            </cue>
                            <cue name="L2M02 Sc4 St2">
                              <action>
                                <do_all>
                                  <create_ship name="L2M02 Sc4 St2.Cluster" typename="SS_SH_THINKER27" capturable="0" communicates="0" homebase="L2M02 Sc4 St2.KhaakBase" race="khaak" warp="1">
                                    <position x="-15km" z="-50km" min="1km" max="2km"/>
                                    <sector sector="L2M02.UnkSec"/>
                                    <equipment loadout="maximum"/>
                                    <command command="killenemies"/>
                                  </create_ship>
                                  <!--more khaak ships?-->
                                  <do_all exact="3">
                                    <create_ship group="L2M02 Sc4 St2.FollowShips" typename="SS_SH_K_M5" capturable="0" communicates="0" homebase="L2M02 Sc4 St2.KhaakBase" race="khaak" warp="1">
                                      <position object="L2M02 Sc4 St2.Cluster" min="200m" max="400m"/>
                                      <sector sector="{object.sector@L2M02 Sc4 St2.Cluster}"/>
                                      <equipment loadout="maximum"/>
                                      <command command="idle"/>
                                    </create_ship>
                                  </do_all>
                                  <copy_group name="L2M02 Sc4 St2.KhaakDistCheck" group="L2M02 Sc4 St2.FollowShips"/>
                                  <create_station name="L2M02 Sc4 St2.KhaakBase" group="L2M02 Sc4 St2.KhaakDistCheck" typename="SS_DOCK_K" race="khaak" safety="1" invincible="1">
                                    <position x="-73600" y="0" z="6400" />
                                    <sector sector="L2M02.UnkSec"/>
                                    <equipment loadout="default"/>
                                  </create_station>
                                  <set_group_command group="L2M02 Sc4 St2.FollowShips" command="follow" commandobject="L2M02 Sc4 St2.KhaakBase" distance="1km"/>
                                  <incoming_message author="{actor.name@L2M02.TeSaat}" text="{3895,282404}"/>
                                  <!-- not spoken???
                                  <play_text actor="L2M02.TeSaat" textid="282404" priority="99"/>-->
                                  <set_object name="L2M02 Sc4 St2.GuidanceScout" value="{group.strongest@L2M02 Sc4 St2.FollowShips}"/>
                                  <set_objective cue="L2M02 Scene 4">
                                    <briefing cue="L2M02 Scene 4" step="4"/>
                                    <follow object="L2M02 Sc4 St2.GuidanceScout"/>
                                  </set_objective>
                                  <create_briefing cue="L2M02 Scene 4" background="ship_khaak_fighter.tga">
                                    <objectives>
                                      <objective step="4">
                                        <follow object="L2M02 Sc4 St2.GuidanceScout"/>
                                      </objective>
                                    </objectives>
                                  </create_briefing>
                                  <set_object name="this.entryPoint" value="{object@L2M02.UnkSecSG}"/>
                                  <do_if value="{player.sector}" exact="{object.sector@this.entryPoint}">
                                    <do_if value="{object.destination.exists@this.entryPoint}" exact="1">
                                      <set_object name="this.entryPoint" value="{object.destination@L2M02.UnkSecSG}"/>
                                    </do_if>
                                  </do_if>
                                  <create_ship name="L2M02 Sc4 St2.TeladiM1" typename="SS_SH_T_M1" boardable="0" capturable="0" invincible="1" race="teladi" sellable="0" warp="1">
                                    <position object="this.entryPoint"/>
                                    <sector sector="{object.sector@this.entryPoint}"/>
                                    <equipment loadout="maximum"/>
                                    <command command="killenemiesrange" distance="50km">
                                      <position x="0" y="0" z="-30km"/>
                                      <sector sector="L2M02.UnkSec"/>
                                    </command>
                                    <relations>
                                      <relation relation="friend" mutual="0"/>
                                    </relations>
                                  </create_ship>
                                  <create_actor name="L2M02 Sc4 St2.TeladiCaptain" character="{3895,29}" face="505" object="L2M02 Sc4 St2.TeladiM1" race="teladi" voice="510" location="pilot"/>
                                  <do_all exact="20">
                                    <create_ship group="L2M02 Sc4 St2.TeladiFighters" typename="{random.type@SS_SH_T_M8|SS_SH_T_M3P}" dockobject="L2M02 Sc4 St2.TeladiM1" homebase="L2M02 Sc4 St2.TeladiM1" race="teladi" capturable="0">
                                      <equipment loadout="maximum"/>
                                      <command command="follow" commandobject="L2M02 Sc4 St2.KhaakBase" distance="1km"/>
                                    </create_ship>
                                  </do_all>
                                </do_all>
                              </action>
                              <cues>
                                <!--some kind of check to alter the reward if reinforcements used?-->
                                <cue name="L2M02 Sc4 St2 Teladi M1 IS" delay="1s">
                                  <condition>
                                    <check_value value="{object.sector@L2M02 Sc4 St2.TeladiM1}" exact="{player.sector}"/>
                                  </condition>
                                  <timing>
                                    <time exact="5s"/>
                                  </timing>
                                  <action>
                                    <do_if value="{object.exists@L2M02 Sc4 St2.TeladiM1}" exact="1">
                                      <play_text actor="L2M02 Sc4 St2.TeladiCaptain" pageid="510" textid="923" priority="99"/>
                                    </do_if>
                                  </action>
                                  <cues>
                                    <cue name="L2M02 Sc4 St2 Teladi M1 IS 2">
                                      <timing>
                                        <time exact="20s"/>
                                      </timing>
                                      <action>
                                        <do_if value="{object.exists@L2M02 Sc4 St2.TeladiM1}" exact="1">
                                          <play_text actor="L2M02 Sc4 St2.TeladiCaptain" pageid="510" textid="921" priority="99"/>
                                        </do_if>
                                      </action>
                                    </cue>
                                  </cues>
                                </cue>
                                <cue name="L2M02 Sc4 St2 Teladi Conv">
                                  <action>
                                    <do_choose>
                                      <do_when value="{value@L2M02 Sc4 St2.ConvRepeat}" exact="1">
                                        <create_offer actor="L2M02 Sc4 St2.TeladiCaptain" conversation="L2M02Conv43R"/>
                                      </do_when>
                                      <do_otherwise>
                                        <create_offer actor="L2M02 Sc4 St2.TeladiCaptain" conversation="L2M02Conv43"/>
                                      </do_otherwise>
                                    </do_choose>
                                  </action>
                                  <cues>
                                    <cue name="L2M02 Sc4 St2 Reinforcements Used" delay="1s">
                                      <condition>
                                        <check_any>
                                          <check_value value="{group.object.count@L2M02 Sc4 St2.TeladiFighters}" exact="0"/>
                                          <object_relation object="L2M02 Sc4 St2.TeladiM1">
                                            <relation relation="enemy" mutual="0"/>
                                          </object_relation>
                                        </check_any>
                                      </condition>
                                      <action>
                                        <do_all>
                                          <do_choose>
                                            <do_when value="{value@L2M02 Sc4 St2.ConvRepeat}" exact="1">
                                              <remove_offer actor="L2M02 Sc4 St2.TeladiCaptain" conversation="L2M02Conv43R"/>
                                            </do_when>
                                            <do_otherwise>
                                              <remove_offer actor="L2M02 Sc4 St2.TeladiCaptain" conversation="L2M02Conv43"/>
                                            </do_otherwise>
                                          </do_choose>
                                          <cancel_cue cue="L2M02 Sc4 St2 Teladi Conv"/>
                                        </do_all>
                                      </action>
                                    </cue>
                                    <cue name="L2M02 Sc4 St2 Launch Reinforcements">
                                      <condition>
                                        <check_any>
                                          <conversation_completed actor="L2M02 Sc4 St2.TeladiCaptain" conversation="L2M02Conv43" answer="launch"/>
                                          <conversation_completed actor="L2M02 Sc4 St2.TeladiCaptain" conversation="L2M02Conv43R" answer="launch"/>
                                        </check_any>
                                      </condition>
                                      <action>
                                        <do_all>
                                          <do_choose>
                                            <do_when value="{value@L2M02 Sc4 St2.ConvRepeat}" exact="1">
                                              <remove_offer actor="L2M02 Sc4 St2.TeladiCaptain" conversation="L2M02Conv43R"/>
                                            </do_when>
                                            <do_otherwise>
                                              <remove_offer actor="L2M02 Sc4 St2.TeladiCaptain" conversation="L2M02Conv43"/>
                                              <set_value name="L2M02 Sc4 St2.ConvRepeat" exact="1"/>
                                            </do_otherwise>
                                          </do_choose>
                                          <do_if value="{group.object.count@L2M02 Sc4 St2.TeladiFighters}" min="1">
                                            <do_all exact="4" counter="fighter">
                                              <do_if value="{group.object.{counter@fighter}.exists@L2M02 Sc4 St2.TeladiFighters}" exact="1">
                                                <set_object name="L2M02 Sc4 St2.LaunchedFighters {counter@fighter}" group="L2M02 Sc4 St2.LaunchedFighters" value="{group.object.{counter@fighter}@L2M02 Sc4 St2.TeladiFighters}"/>
                                              </do_if>
                                            </do_all>
                                            <set_group_command group="L2M02 Sc4 St2.LaunchedFighters" command="attack" commandobject="L2M02 Sc4 St2.KhaakBase"/>
                                          </do_if>
                                        </do_all>
                                      </action>
                                      <cues>
                                        <cue name="L2M02 Sc4 St2 Reinforcements Destroyed">
                                          <condition>
                                            <all_objects_destroyed group="L2M02 Sc4 St2.LaunchedFighters"/>
                                          </condition>
                                          <action>
                                            <do_all>
                                              <remove_group group="L2M02 Sc4 St2.LaunchedFighters"/>
                                              <do_choose>
                                                <do_when value="{group.object.count@L2M02 Sc4 St2.TeladiFighters}" min="1">
                                                  <reset_cue cue="L2M02 Sc4 St2 Teladi Conv"/>
                                                </do_when>
                                                <do_otherwise>
                                                  <cancel_cue cue="L2M02 Sc4 St2 Teladi Conv"/>
                                                </do_otherwise>
                                              </do_choose>
                                            </do_all>
                                          </action>
                                        </cue>
                                      </cues>
                                    </cue>
                                  </cues>
                                </cue>
                                <cue name="L2M02 Sc4 St2 Scout Orders">
                                  <condition>
                                    <any_object_finished group="L2M02 Sc4 St2.FollowShips"/>
                                  </condition>
                                  <action>
                                    <set_group_command group="L2M02 Sc4 St2.FollowShips" command="killenemies"/>
                                  </action>
                                </cue>
                                <cue name="L2M02 Sc4 St2 Set Guidance" instantiate="static">
                                  <condition>
                                    <check_any>
                                      <object_destroyed object="L2M02 Sc4 St2.GuidanceScout"/>
                                      <object_destroyed_by_player object="L2M02 Sc4 St2.GuidanceScout"/>
                                    </check_any>
                                  </condition>
                                  <action>
                                    <do_all>
                                      <set_object name="L2M02 Sc4 St2.GuidanceScout" value="{group.strongest@L2M02 Sc4 St2.FollowShips}"/>
                                      <set_objective cue="L2M02 Scene 4" silent="1">
                                        <briefing cue="L2M02 Scene 4" step="4"/>
                                        <follow object="L2M02 Sc4 St2.GuidanceScout"/>
                                      </set_objective>
                                      <create_briefing cue="L2M02 Scene 4" background="ship_khaak_fighter.tga">
                                        <objectives>
                                          <objective step="4">
                                            <follow object="L2M02 Sc4 St2.GuidanceScout"/>
                                          </objective>
                                        </objectives>
                                      </create_briefing>
                                    </do_all>
                                  </action>
                                </cue>
                                <cue name="L2M02 Sc4 St2 Destroy Base">
                                  <condition>
                                    <check_any>
                                      <check_all>
                                        <check_value value="{group.distance.km@L2M02 Sc4 St2.KhaakDistCheck}" max="10"/>
                                        <check_value value="{object.distance.km@L2M02 Sc4 St2.KhaakBase}" max="15"/>
                                      </check_all>
                                      <all_objects_destroyed group="L2M02 Sc4 St2.FollowShips"/>
                                    </check_any>
                                  </condition>
                                  <action>
                                    <do_all>
                                      <cancel_cue cue="L2M02 Sc4 St2 Scout Orders"/>
                                      <cancel_cue cue="L2M02 Sc4 St2 Set Guidance" instantiate="static"/>
                                      <do_if value="{group.object.count@L2M02 Sc4 St2.FollowShips}" min="1">
                                        <set_group_command group="L2M02 Sc4 St2.FollowShips" command="killenemies"/>
                                      </do_if>
                                      <set_mission_rank name="L2OFF" titleid="1" textid="10" exact="152"/>
                                      <create_ship name="this.dummyScout" typename="SS_SH_K_M5" capturable="0" communicates="0" race="khaak" warp="1">
                                        <position x="0" height="8km" min="10km" max="30km"/>
                                        <sector sector="L2M02.UnkSec"/>
                                        <equipment loadout="maximum"/>
                                        <command command="killenemies"/>
                                      </create_ship>
                                      <set_objective cue="L2M02 Scene 4">
                                        <briefing cue="L2M02 Scene 4" step="5"/>
                                        <mission discipline="XFXX" level="hard"/>
                                        <destroy object="L2M02 Sc4 St2.KhaakBase"/>
                                      </set_objective>
                                      <create_briefing cue="L2M02 Scene 4" background="combat_missiles.tga">
                                        <mission discipline="XFXX" level="hard"/>
                                        <objectives>
                                          <objective step="4">
                                            <custom icon="follow" action="follow" text="{object.name@this.dummyScout}"/>
                                          </objective>
                                          <objective step="5">
                                            <destroy object="L2M02 Sc4 St2.KhaakBase"/>
                                          </objective>
                                        </objectives>
                                      </create_briefing>
                                      <remove_object object="this.dummyScout"/>
                                      <do_choose>
                                        <do_when value="{player.sector}" exact="{object.sector@L2M02 Sc4 St2.KhaakBase}">
                                          <set_invincible object="L2M02 Sc4 St2.KhaakBase" invincible="0"/>
                                        </do_when>
                                        <do_otherwise>
                                          <set_invincible object="L2M02 Sc4 St2.KhaakBase" invincible="1"/>
                                        </do_otherwise>
                                      </do_choose>
                                    </do_all>
                                  </action>
                                  <cues>
                                    <cue name="L2M02 Sc4 St2 Khaak IS OOS">
                                      <condition>
                                        <object_changed_sector/>
                                      </condition>
                                      <timing>
                                        <time exact="200"/>
                                      </timing>
                                      <action>
                                        <do_choose>
                                          <do_when value="{player.sector}" exact="{object.sector@L2M02 Sc4 St2.KhaakBase}">
                                            <set_invincible object="L2M02 Sc4 St2.KhaakBase" invincible="0"/>
                                          </do_when>
                                          <do_otherwise>
                                            <set_invincible object="L2M02 Sc4 St2.KhaakBase" invincible="1"/>
                                          </do_otherwise>
                                        </do_choose>
                                      </action>
                                    </cue>
                                    <cue name="L2M02 Sc4 St2 End">
                                      <condition>
                                        <check_any>
                                          <object_destroyed object="L2M02 Sc4 St2.KhaakBase"/>
                                          <object_destroyed_by_player object="L2M02 Sc4 St2.KhaakBase"/>
                                        </check_any>
                                      </condition>
                                      <timing>
                                        <time min="8s" max="10s"/>
                                      </timing>
                                      <action>
                                        <do_all>
                                          <set_mission_rank name="L2OFF" titleid="1" textid="10" exact="283"/>
                                          <play_text actor="L2M02.TeSaat" textid="282821" priority="99"/>
                                          <set_command object="L2M02 Sc4 St2.TeladiM1" command="killenemies"/>
                                          <set_group_command group="L2M02 Sc4 St2.TeladiFighters" command="killenemiesland" commandobject="L2M02 Sc4 St2.TeladiM1" distance="10km"/>
                                          <remove_briefing cue="L2M02 Scene 4"/>
                                          <remove_objective cue="L2M02 Scene 4" status="complete"/>
                                        </do_all>
                                      </action>
                                      <cues>
                                        <cue name="L2M02 Sc4 St2 End Set Progress">
                                          <condition>
                                            <cue_completed cue="L2M02 Sc4 St2 End"/>
                                          </condition>
                                          <timing>
                                            <time min="1200s" max="1800s"/>
                                          </timing>
                                          <action>
                                            <set_value name="L2M02.PlotProgress" exact="5"/>
                                          </action>
                                        </cue>
                                      </cues>
                                    </cue>
                                  </cues>
                                </cue>
                              </cues>
                            </cue>
                          </cues>
                        </cue>
                      </cues>
                    </cue>
                  </cues>
                </cue>
              </cues>
            </cue>
            <cue name="L2M02 Scene 5" delay="5s">
              <condition>
                <check_value value="{value@L2M02.PlotProgress}" exact="5"/>
              </condition>
              <action>
                <do_choose>
                  <do_when value="{player.missionrank.L2OFF.rank}" min="7">
                    <set_value name="L2M02.PlotProgress" exact="6"/>
                    <cancel_cue cue="L2M02 Scene 5"/>
                  </do_when>
                  <do_otherwise>
                    <set_value name="L2M02 Scene 5.Mission A Chance" operation="add" exact="10"/>
                    <set_value name="L2M02 Scene 5.Mission B Chance" operation="add" exact="10"/>
                    <set_value name="L2M02 Scene 5.Mission C Chance" operation="add" exact="10"/>
                    <set_value name="L2M02 Scene 5.Mission F Chance" operation="add" exact="10"/>
                    <!--
                  <set_value name="L2M02 Scene 5.Mission D Chance" operation="add" exact="10"/>
                  <set_value name="L2M02 Scene 5.Mission E Chance" operation="add" exact="10"/>
                  -->
                    <do_any>
                      <set_value name="L2M02 Scene 5.NextMission" exact="1" chance="{value@L2M02 Scene 5.Mission A Chance}"/>
                      <set_value name="L2M02 Scene 5.NextMission" exact="2" chance="{value@L2M02 Scene 5.Mission B Chance}"/>
                      <set_value name="L2M02 Scene 5.NextMission" exact="3" chance="{value@L2M02 Scene 5.Mission C Chance}"/>
                      <set_value name="L2M02 Scene 5.NextMission" exact="6" chance="{value@L2M02 Scene 5.Mission F Chance}"/>
                      <!--
                    <set_value name="L2M02 Scene 5.NextMission" exact="4" chance="{value@L2M02 Scene 5.Mission D Chance}"/>
                    <set_value name="L2M02 Scene 5.NextMission" exact="5" chance="{value@L2M02 Scene 5.Mission E Chance}"/>
                    -->
                    </do_any>
                  </do_otherwise>
                </do_choose>
              </action>
              <cues>
                <cue name="L2M02 Scene 5 Next Mission">
                  <condition>
                    <cue_completed cue="L2M02 Scene 5"/>
                  </condition>
                  <action>
                    <do_all>
                      <do_any>
                        <incoming_message author="{actor.name@L2M02.TeSaat}" text="{3828,282501}"/>
                        <incoming_message author="{actor.name@L2M02.TeSaat}" text="{3895,282301}"/>
                        <incoming_message author="{actor.name@L2M02.TeSaat}" text="{3895,282401}"/>
                        <incoming_message author="{actor.name@L2M02.TeSaat}" text="{3895,282502}"/>
                        <incoming_message author="{actor.name@L2M02.TeSaat}" text="{3895,282605}"/>
                      </do_any>
                      <set_objective cue="L2M02 Scene 5" story="{3200,2}" title="{3202,11}" noabort="1">
                        <mission discipline="XXXT" level="trivial"/>
                        <dockat object="L2M02.Base"/>
                        <!--<custom icon="talkto" action="{35,2012}" text="{actor.name@L2M02.TeSaat}" object="L2M02.Base"/>-->
                      </set_objective>
                      <create_briefing cue="L2M02 Scene 5" title="{3200,2}" text="{3895,282401}">
                        <objectives>
                          <objective step="1">
                            <talkto actor="L2M02.TeSaat"/>
                          </objective>
                        </objectives>
                      </create_briefing>
                    </do_all>
                  </action>
                  <cues>
                    <cue name="L2M02 Scene 5 Docked Wait" delay="1857">
                      <condition>
                        <object_is_docked dockobject="L2M02.Base"/>
                      </condition>
                      <timing>
                        <time exact="10s"/>
                      </timing>
                    </cue>
                    <cue name="L2M02 Scene 5 Begin Mission" delay="2007">
                      <condition>
                        <cue_is_complete cue="L2M02 Scene 5 Docked Wait"/>
                      </condition>
                      <cues>
                        <!--Mission A, defend incoming transport-->
                        <cue name="L2M02 Sc5 StA" check="cancel">
                          <condition>
                            <check_value value="{value@L2M02 Scene 5.NextMission}" exact="1"/>
                          </condition>
                          <action>
                            <do_all>
                              <set_value name="L2M02 Scene 5.NextMission" exact="0"/>
                              <set_value name="L2M02 Scene 5.Mission A Chance" exact="0"/>
                              <do_any>
                                <play_text actor="L2M02.TeSaat" textid="282901" priority="99"/>
                                <play_text actor="L2M02.TeSaat" textid="282902" priority="99"/>
                                <play_text actor="L2M02.TeSaat" textid="282903" priority="99"/>
                              </do_any>
                              <set_value name="L2M02 Sc5 StA.Difficulty" exact="{player.missionrank.L2OFF.rank}"/>
                              <do_if value="{value@L2M02 Sc5 StA.Difficulty}" max="{lookup.level@veryeasy}-1">
                                <set_value name="L2M02 Sc5 StA.Difficulty" exact="{lookup.level@veryeasy}"/>
                              </do_if>
                              <do_if value="{value@L2M02 Sc5 StA.Difficulty}" min="{lookup.level@impossible}+1">
                                <set_value name="L2M02 Sc5 StA.Difficulty" exact="{lookup.level@impossible}"/>
                              </do_if>
                              <!--<find_gate name="this.gate">
                                <sector sector="L2M02.MS148"/>
                                <jumps exact="0"/>
                              </find_gate>-->
                              <find_gate name="this.gate" gate="east">
                                <sector sector="L2M02.UnkSec"/>
                                <jumps exact="0"/>
                              </find_gate>
                              <!--player docked so not needed
                              <do_if value="{player.sector}" exact="{object.sector@this.gate}">
                                <do_if value="{object.destination.exists@this.gate}" exact="1">
                                  <set_object name="this.gate" value="{object.destination@this.gate}"/>
                                </do_if>
                              </do_if>-->
                              <do_any comment="Create random convoy">
                                <do_all min="3" max="5" counter="num" comment="argon convoy">
                                  <create_ship name="L2M02 Sc5 StA.Convoy Ship" group="L2M02 Sc5 StA.Convoy" typename="{random.type@SS_SH_A_TM|SS_SH_A_M6|SS_SH_A_M3_1|SS_SH_A_TS|SS_SH_A_TS_1|SS_SH_A_TS_1|SS_SH_A_TS_1|SS_SH_A_TS_5}" capturable="0" race="argon">
                                    <position object="this.gate"/>
                                    <sector sector="{object.sector@this.gate}"/>
                                    <equipment loadout="default"/>
                                    <command command="dock" commandobject="L2M02.Base"/>
                                    <relations>
                                      <relation relation="friend" mutual="0"/>
                                    </relations>
                                    <pilot jobtextid="40001"/>
                                  </create_ship>
                                  <add_equipment object="L2M02 Sc5 StA.Convoy Ship">
                                    <ware typename="SS_WARE_TECH213" min="(({object.equipment.SS_WARE_TECH213.maxcount@L2M02 Sc5 StA.Convoy Ship}-{object.equipment.SS_WARE_TECH213.count@L2M02 Sc5 StA.Convoy Ship}) * 8)/10" max="{object.equipment.SS_WARE_TECH213.maxcount@L2M02 Sc5 StA.Convoy Ship}-{object.equipment.SS_WARE_TECH213.count@L2M02 Sc5 StA.Convoy Ship}"/>
                                  </add_equipment>
                                  <do_any>
                                    <add_cargo object="L2M02 Sc5 StA.Convoy Ship" chance="10">
                                      <ware typename="SS_WARE_NIVIDIUM2" min="20" max="60"/>
                                    </add_cargo>
                                    <add_cargo object="L2M02 Sc5 StA.Convoy Ship" chance="50">
                                      <ware typename="SS_WARE_ORE" min="100" max="1000"/>
                                      <ware typename="SS_WARE_SILICON" min="50" max="500"/>
                                    </add_cargo>
                                    <add_cargo object="L2M02 Sc5 StA.Convoy Ship" chance="40">
                                      <ware typename="SS_WARE_TECH204" min="20" max="40"/>
                                      <ware typename="SS_WARE_TECH206" min="10" max="50"/>
                                      <ware typename="SS_WARE_TECH208" min="20" max="100"/>
                                    </add_cargo>
                                  </do_any>
                                  <do_if value="{object.isclass.tm@L2M02 Sc5 StA.Convoy Ship}" exact="1">
                                    <do_all min="1" max="4" counter="ship" profile="decreasing">
                                      <create_ship name="L2M02 Sc5 StA.Convoy Ship {counter@ship}" group="L2M02 Sc5 StA.Convoy Guards" typename="{random.type@SS_SH_A_M4|SS_SH_A_M4_2|SS_SH_A_M4_3|SS_SH_A_M4P|SS_SH_A_M5|SS_SH_A_M5_2|SS_SH_A_M5_3|SS_SH_A_M5P}" dockobject="L2M02 Sc5 StA.Convoy Ship" capturable="0" race="argon" homebase="L2M02 Sc5 StA.Convoy Ship">
                                        <equipment loadout="maximum"/>
                                        <command command="none"/>
                                        <relations>
                                          <relation relation="friend" mutual="0"/>
                                        </relations>
                                        <pilot jobtextid="40004"/>
                                      </create_ship>
                                      <add_equipment object="L2M02 Sc5 StA.Convoy Ship {counter@ship}">
                                        <ware typename="SS_WARE_TECH213" min="(({object.equipment.SS_WARE_TECH213.maxcount@L2M02 Sc5 StA.Convoy Ship {counter@ship}}-{object.equipment.SS_WARE_TECH213.count@L2M02 Sc5 StA.Convoy Ship {counter@ship}}) * 7)/10" max="{object.equipment.SS_WARE_TECH213.maxcount@L2M02 Sc5 StA.Convoy Ship {counter@ship}}-{object.equipment.SS_WARE_TECH213.count@L2M02 Sc5 StA.Convoy Ship {counter@ship}}"/>
                                      </add_equipment>
                                    </do_all>
                                  </do_if>
                                  <set_object name="L2M02 Sc5 StA.Convoy {object@L2M02 Sc5 StA.Convoy Ship}" value="{object@L2M02 Sc5 StA.Convoy Ship}" group="L2M02 Sc5 StA.Convoy"/>
                                </do_all>
                                <do_all min="3" max="5" counter="num" comment="boron convoy">
                                  <create_ship name="L2M02 Sc5 StA.Convoy Ship" group="L2M02 Sc5 StA.Convoy" typename="{random.type@SS_SH_B_TM|SS_SH_B_M6|SS_SH_B_M3_1|SS_SH_B_TS|SS_SH_B_TS_1|SS_SH_B_TS_1|SS_SH_B_TS_1|SS_SH_B_TS_5}" capturable="0" race="boron">
                                    <position object="this.gate"/>
                                    <sector sector="{object.sector@this.gate}"/>
                                    <equipment loadout="default"/>
                                    <command command="dock" commandobject="L2M02.Base"/>
                                    <relations>
                                      <relation relation="friend" mutual="0"/>
                                    </relations>
                                    <pilot jobtextid="40001"/>
                                  </create_ship>
                                  <add_equipment object="L2M02 Sc5 StA.Convoy Ship">
                                    <ware typename="SS_WARE_TECH213" min="(({object.equipment.SS_WARE_TECH213.maxcount@L2M02 Sc5 StA.Convoy Ship}-{object.equipment.SS_WARE_TECH213.count@L2M02 Sc5 StA.Convoy Ship}) * 8)/10" max="{object.equipment.SS_WARE_TECH213.maxcount@L2M02 Sc5 StA.Convoy Ship}-{object.equipment.SS_WARE_TECH213.count@L2M02 Sc5 StA.Convoy Ship}"/>
                                  </add_equipment>
                                  <do_any>
                                    <add_cargo object="L2M02 Sc5 StA.Convoy Ship" chance="10">
                                      <ware typename="SS_WARE_NIVIDIUM2" min="20" max="60"/>
                                    </add_cargo>
                                    <add_cargo object="L2M02 Sc5 StA.Convoy Ship" chance="50">
                                      <ware typename="SS_WARE_ORE" min="100" max="1000"/>
                                      <ware typename="SS_WARE_SILICON" min="50" max="500"/>
                                    </add_cargo>
                                    <add_cargo object="L2M02 Sc5 StA.Convoy Ship" chance="40">
                                      <ware typename="SS_WARE_TECH204" min="20" max="40"/>
                                      <ware typename="SS_WARE_TECH206" min="10" max="50"/>
                                      <ware typename="SS_WARE_TECH208" min="20" max="100"/>
                                    </add_cargo>
                                  </do_any>
                                  <do_if value="{object.isclass.tm@L2M02 Sc5 StA.Convoy Ship}" exact="1">
                                    <do_all min="1" max="4" counter="ship" profile="decreasing">
                                      <create_ship name="L2M02 Sc5 StA.Convoy Ship {counter@ship}" group="L2M02 Sc5 StA.Convoy Guards" typename="{random.type@SS_SH_B_M4|SS_SH_B_M4_2|SS_SH_B_M4_3|SS_SH_B_M4P|SS_SH_B_M5|SS_SH_B_M5_2|SS_SH_B_M5_3|SS_SH_B_M5P}" dockobject="L2M02 Sc5 StA.Convoy Ship" capturable="0" race="boron" homebase="L2M02 Sc5 StA.Convoy Ship">
                                        <equipment loadout="maximum"/>
                                        <command command="none"/>
                                        <relations>
                                          <relation relation="friend" mutual="0"/>
                                        </relations>
                                        <pilot jobtextid="40004"/>
                                      </create_ship>
                                      <add_equipment object="L2M02 Sc5 StA.Convoy Ship {counter@ship}">
                                        <ware typename="SS_WARE_TECH213" min="(({object.equipment.SS_WARE_TECH213.maxcount@L2M02 Sc5 StA.Convoy Ship {counter@ship}}-{object.equipment.SS_WARE_TECH213.count@L2M02 Sc5 StA.Convoy Ship {counter@ship}}) * 7)/10" max="{object.equipment.SS_WARE_TECH213.maxcount@L2M02 Sc5 StA.Convoy Ship {counter@ship}}-{object.equipment.SS_WARE_TECH213.count@L2M02 Sc5 StA.Convoy Ship {counter@ship}}"/>
                                      </add_equipment>
                                    </do_all>
                                  </do_if>
                                  <set_object name="L2M02 Sc5 StA.Convoy {object@L2M02 Sc5 StA.Convoy Ship}" value="{object@L2M02 Sc5 StA.Convoy Ship}" group="L2M02 Sc5 StA.Convoy"/>
                                </do_all>
                                <do_all min="3" max="5" counter="num" comment="split convoy">
                                  <create_ship name="L2M02 Sc5 StA.Convoy Ship" group="L2M02 Sc5 StA.Convoy" typename="{random.type@SS_SH_S_TM|SS_SH_S_M6|SS_SH_S_M3_1|SS_SH_S_TS|SS_SH_S_TS_1|SS_SH_S_TS_1|SS_SH_S_TS_1|SS_SH_S_TS_5}" capturable="0" race="split">
                                    <position object="this.gate"/>
                                    <sector sector="{object.sector@this.gate}"/>
                                    <equipment loadout="default"/>
                                    <command command="dock" commandobject="L2M02.Base"/>
                                    <relations>
                                      <relation relation="friend" mutual="0"/>
                                    </relations>
                                    <pilot jobtextid="40001"/>
                                  </create_ship>
                                  <add_equipment object="L2M02 Sc5 StA.Convoy Ship">
                                    <ware typename="SS_WARE_TECH213" min="(({object.equipment.SS_WARE_TECH213.maxcount@L2M02 Sc5 StA.Convoy Ship}-{object.equipment.SS_WARE_TECH213.count@L2M02 Sc5 StA.Convoy Ship}) * 8)/10" max="{object.equipment.SS_WARE_TECH213.maxcount@L2M02 Sc5 StA.Convoy Ship}-{object.equipment.SS_WARE_TECH213.count@L2M02 Sc5 StA.Convoy Ship}"/>
                                  </add_equipment>
                                  <do_any>
                                    <add_cargo object="L2M02 Sc5 StA.Convoy Ship" chance="10">
                                      <ware typename="SS_LASER_CIG" min="0" max="20"/>
                                      <ware typename="SS_LASER_PPC" min="0" max="20"/>
                                      <ware typename="SS_LASER_HEPT" min="0" max="20"/>
                                    </add_cargo>
                                    <add_cargo object="L2M02 Sc5 StA.Convoy Ship" chance="50">
                                      <ware typename="SS_WARE_ORE" min="100" max="1000"/>
                                      <ware typename="SS_WARE_SILICON" min="50" max="500"/>
                                    </add_cargo>
                                    <add_cargo object="L2M02 Sc5 StA.Convoy Ship" chance="40">
                                      <ware typename="SS_WARE_TECH204" min="20" max="40"/>
                                      <ware typename="SS_WARE_TECH206" min="10" max="50"/>
                                      <ware typename="SS_WARE_TECH208" min="20" max="100"/>
                                    </add_cargo>
                                  </do_any>
                                  <do_if value="{object.isclass.tm@L2M02 Sc5 StA.Convoy Ship}" exact="1">
                                    <do_all min="1" max="4" counter="ship" profile="decreasing">
                                      <create_ship name="L2M02 Sc5 StA.Convoy Ship {counter@ship}" group="L2M02 Sc5 StA.Convoy Guards" typename="{random.type@SS_SH_S_M4|SS_SH_S_M4_2|SS_SH_S_M4_3|SS_SH_S_M4P|SS_SH_S_M5|SS_SH_S_M5_2|SS_SH_S_M5_3|SS_SH_S_M5P}" dockobject="L2M02 Sc5 StA.Convoy Ship" capturable="0" race="split" homebase="L2M02 Sc5 StA.Convoy Ship">
                                        <equipment loadout="maximum"/>
                                        <command command="none"/>
                                        <relations>
                                          <relation relation="friend" mutual="0"/>
                                        </relations>
                                        <pilot jobtextid="40004"/>
                                      </create_ship>
                                      <add_equipment object="L2M02 Sc5 StA.Convoy Ship {counter@ship}">
                                        <ware typename="SS_WARE_TECH213" min="(({object.equipment.SS_WARE_TECH213.maxcount@L2M02 Sc5 StA.Convoy Ship {counter@ship}}-{object.equipment.SS_WARE_TECH213.count@L2M02 Sc5 StA.Convoy Ship {counter@ship}}) * 7)/10" max="{object.equipment.SS_WARE_TECH213.maxcount@L2M02 Sc5 StA.Convoy Ship {counter@ship}}-{object.equipment.SS_WARE_TECH213.count@L2M02 Sc5 StA.Convoy Ship {counter@ship}}"/>
                                      </add_equipment>
                                    </do_all>
                                  </do_if>
                                  <set_object name="L2M02 Sc5 StA.Convoy {object@L2M02 Sc5 StA.Convoy Ship}" value="{object@L2M02 Sc5 StA.Convoy Ship}" group="L2M02 Sc5 StA.Convoy"/>
                                </do_all>
                                <do_all min="3" max="5" counter="num" comment="paranid convoy">
                                  <create_ship name="L2M02 Sc5 StA.Convoy Ship" group="L2M02 Sc5 StA.Convoy" typename="{random.type@SS_SH_P_TM|SS_SH_P_M6|SS_SH_P_M3_1|SS_SH_P_TS|SS_SH_P_TS_1|SS_SH_P_TS_1|SS_SH_P_TS_1|SS_SH_P_TS_5}" capturable="0" race="paranid">
                                    <position object="this.gate"/>
                                    <sector sector="{object.sector@this.gate}"/>
                                    <equipment loadout="default"/>
                                    <command command="dock" commandobject="L2M02.Base"/>
                                    <relations>
                                      <relation relation="friend" mutual="0"/>
                                    </relations>
                                    <pilot jobtextid="40001"/>
                                  </create_ship>
                                  <add_equipment object="L2M02 Sc5 StA.Convoy Ship">
                                    <ware typename="SS_WARE_TECH213" min="(({object.equipment.SS_WARE_TECH213.maxcount@L2M02 Sc5 StA.Convoy Ship}-{object.equipment.SS_WARE_TECH213.count@L2M02 Sc5 StA.Convoy Ship}) * 8)/10" max="{object.equipment.SS_WARE_TECH213.maxcount@L2M02 Sc5 StA.Convoy Ship}-{object.equipment.SS_WARE_TECH213.count@L2M02 Sc5 StA.Convoy Ship}"/>
                                  </add_equipment>
                                  <do_any>
                                    <add_cargo object="L2M02 Sc5 StA.Convoy Ship" chance="10">
                                      <ware typename="SS_WARE_NIVIDIUM2" min="20" max="60"/>
                                    </add_cargo>
                                    <add_cargo object="L2M02 Sc5 StA.Convoy Ship" chance="50">
                                      <ware typename="SS_WARE_ORE" min="100" max="1000"/>
                                      <ware typename="SS_WARE_SILICON" min="50" max="500"/>
                                    </add_cargo>
                                    <add_cargo object="L2M02 Sc5 StA.Convoy Ship" chance="40">
                                      <ware typename="SS_WARE_TECH204" min="20" max="40"/>
                                      <ware typename="SS_WARE_TECH206" min="10" max="50"/>
                                      <ware typename="SS_WARE_TECH208" min="20" max="100"/>
                                    </add_cargo>
                                  </do_any>
                                  <do_if value="{object.isclass.tm@L2M02 Sc5 StA.Convoy Ship}" exact="1">
                                    <do_all min="1" max="4" counter="ship" profile="decreasing">
                                      <create_ship name="L2M02 Sc5 StA.Convoy Ship {counter@ship}" group="L2M02 Sc5 StA.Convoy Guards" typename="{random.type@SS_SH_P_M4|SS_SH_P_M4_2|SS_SH_P_M4_3|SS_SH_P_M4P|SS_SH_P_M5|SS_SH_P_M5_2|SS_SH_P_M5_3|SS_SH_P_M5P}" dockobject="L2M02 Sc5 StA.Convoy Ship" capturable="0" race="paranid" homebase="L2M02 Sc5 StA.Convoy Ship">
                                        <equipment loadout="maximum"/>
                                        <command command="none"/>
                                        <relations>
                                          <relation relation="friend" mutual="0"/>
                                        </relations>
                                        <pilot jobtextid="40004"/>
                                      </create_ship>
                                      <add_equipment object="L2M02 Sc5 StA.Convoy Ship {counter@ship}">
                                        <ware typename="SS_WARE_TECH213" min="(({object.equipment.SS_WARE_TECH213.maxcount@L2M02 Sc5 StA.Convoy Ship {counter@ship}}-{object.equipment.SS_WARE_TECH213.count@L2M02 Sc5 StA.Convoy Ship {counter@ship}}) * 7)/10" max="{object.equipment.SS_WARE_TECH213.maxcount@L2M02 Sc5 StA.Convoy Ship {counter@ship}}-{object.equipment.SS_WARE_TECH213.count@L2M02 Sc5 StA.Convoy Ship {counter@ship}}"/>
                                      </add_equipment>
                                    </do_all>
                                  </do_if>
                                  <set_object name="L2M02 Sc5 StA.Convoy {object@L2M02 Sc5 StA.Convoy Ship}" value="{object@L2M02 Sc5 StA.Convoy Ship}" group="L2M02 Sc5 StA.Convoy"/>
                                </do_all>
                                <do_all min="3" max="5" counter="num" comment="teladi convoy">
                                  <create_ship name="L2M02 Sc5 StA.Convoy Ship" typename="{random.type@SS_SH_T_TM|SS_SH_T_M6|SS_SH_T_M3_1|SS_SH_T_TS|SS_SH_T_TS_1|SS_SH_T_TS_1|SS_SH_T_TS_1|SS_SH_T_TS_5}" capturable="0" race="teladi">
                                    <position object="this.gate"/>
                                    <sector sector="{object.sector@this.gate}"/>
                                    <equipment loadout="default"/>
                                    <command command="dock" commandobject="L2M02.Base"/>
                                    <relations>
                                      <relation relation="friend" mutual="0"/>
                                    </relations>
                                    <pilot jobtextid="40001"/>
                                  </create_ship>
                                  <add_equipment object="L2M02 Sc5 StA.Convoy Ship">
                                    <ware typename="SS_WARE_TECH213" min="(({object.equipment.SS_WARE_TECH213.maxcount@L2M02 Sc5 StA.Convoy Ship}-{object.equipment.SS_WARE_TECH213.count@L2M02 Sc5 StA.Convoy Ship}) * 8)/10" max="{object.equipment.SS_WARE_TECH213.maxcount@L2M02 Sc5 StA.Convoy Ship}-{object.equipment.SS_WARE_TECH213.count@L2M02 Sc5 StA.Convoy Ship}"/>
                                  </add_equipment>
                                  <do_any>
                                    <add_cargo object="L2M02 Sc5 StA.Convoy Ship" chance="10">
                                      <ware typename="SS_WARE_NIVIDIUM2" min="20" max="60"/>
                                    </add_cargo>
                                    <add_cargo object="L2M02 Sc5 StA.Convoy Ship" chance="50">
                                      <ware typename="SS_WARE_ORE" min="100" max="1000"/>
                                      <ware typename="SS_WARE_SILICON" min="50" max="500"/>
                                    </add_cargo>
                                    <add_cargo object="L2M02 Sc5 StA.Convoy Ship" chance="40">
                                      <ware typename="SS_WARE_TECH204" min="20" max="40"/>
                                      <ware typename="SS_WARE_TECH206" min="10" max="50"/>
                                      <ware typename="SS_WARE_TECH208" min="20" max="100"/>
                                    </add_cargo>
                                  </do_any>
                                  <do_if value="{object.isclass.tm@L2M02 Sc5 StA.Convoy Ship}" exact="1">
                                    <do_all min="1" max="4" counter="ship" profile="decreasing">
                                      <create_ship name="L2M02 Sc5 StA.Convoy Ship {counter@ship}" group="L2M02 Sc5 StA.Convoy Guards" typename="{random.type@SS_SH_T_M4|SS_SH_T_M4_2|SS_SH_T_M4_3|SS_SH_T_M4P|SS_SH_T_M5|SS_SH_T_M5_2|SS_SH_T_M5_3|SS_SH_T_M5P}" dockobject="L2M02 Sc5 StA.Convoy Ship" capturable="0" race="teladi" homebase="L2M02 Sc5 StA.Convoy Ship">
                                        <equipment loadout="maximum"/>
                                        <command command="none"/>
                                        <relations>
                                          <relation relation="friend" mutual="0"/>
                                        </relations>
                                        <pilot jobtextid="40004"/>
                                      </create_ship>
                                      <add_equipment object="L2M02 Sc5 StA.Convoy Ship {counter@ship}">
                                        <ware typename="SS_WARE_TECH213" min="({object.equipment.SS_WARE_TECH213.maxcount@L2M02 Sc5 StA.Convoy Ship {counter@ship}}-{object.equipment.SS_WARE_TECH213.count@L2M02 Sc5 StA.Convoy Ship {counter@ship}} * 5)/10" max="{object.equipment.SS_WARE_TECH213.maxcount@L2M02 Sc5 StA.Convoy Ship {counter@ship}}-{object.equipment.SS_WARE_TECH213.count@L2M02 Sc5 StA.Convoy Ship {counter@ship}}"/>
                                      </add_equipment>
                                    </do_all>
                                  </do_if>
                                  <set_object name="L2M02 Sc5 StA.Convoy {object@L2M02 Sc5 StA.Convoy Ship}" value="{object@L2M02 Sc5 StA.Convoy Ship}" group="L2M02 Sc5 StA.Convoy"/>
                                </do_all>
                              </do_any>
                              <create_briefing cue="L2M02 Scene 5" title="{3200,2}" text="{3828,282901}"/>
                              <set_value name="L2M02 Sc5 StA.Step" exact="2"/>
                            </do_all>
                          </action>
                          <cues>
                            <cue ref="COM01">
                              <params>
                                <param name="GroupName" value="L2M02 Sc5 StA.Convoy"/>
                                <param name="DestName" value="L2M02.Base"/>
                                <param name="Follow Leader" value="1"/>
                                <param name="Cleanup Individuals" value="1"/>
                                <param name="CleanupName" value="L2M02 Sc5 StA.ConvoyCleanupShips"/>
                              </params>
                            </cue>
                            <cue ref="L0M19">
                              <params>
                                <param name="Cue" value="L2M02 Scene 5"/>
                                <param name="Step" value="L2M02 Sc5 StA.Step"/>
                                <param name="ActiveSteps" value="L2M02 Sc5 StA.Next Step"/>
                                <!--<param name="DestName" value="L2M02.Base"/>-->
                                <param name="DestSector" value="L2M02.MS148"/>
                                <param name="OfferRace" value="{object.maker@L2M02 Sc5 StA.Convoy Ship}"/>
                                <param name="Dockat Dest" value="1"/>
                                <param name="AllowLoss" value="1"/>
                                <param name="Complete Briefing" value="1"/>
                                <param name="SetObjective" value="1"/>
                                <param name="GroupName" value="L2M02 Sc5 StA.Convoy"/>
                                <param name="Difficulty" value="{value@L2M02 Sc5 StA.Difficulty}"/>
                                <param name="StoryID" value="2"/>
                                <param name="ChapterID" value="204"/>
                                <param name="IsPlot" value="1"/>
                                <param name="FeedbackName" value="L2M02 Scene 5.1 L0M19 Progress"/>
                                <param name="OBSDelay" value="(500/{value@L2M02 Sc5 StA.Difficulty})s"/>
                                <param name="OBS" value="1"/>
                                <param name="MaxOBSRuns" value="0"/>
                                <param name="OBS Counter" value="L2M02 Sc5 StA.OBSCounter"/>
                                <param name="OBS Cue" value="L2M02 Sc5 StA"/>
                                <param name="OBSFleetRace" value="{lookup.race@khaak}"/>
                                <param name="OBSFleetPilotsRace" value="{lookup.race@khaak}"/>
                                <param name="OBSMissionRank" value="{player.fightrank.rank}"/>
                                <param name="OBSDifficultyRank" value="{value@L2M02 Sc5 StA.Difficulty}"/>
                                <param name="OBS PointsMin" value="{value@Constant {lookup.class@m4} Points}*2-1"/>
                                <param name="OBS PointsMax" value="{value@Constant {lookup.class@m6} Points}"/>
                                <param name="OBSFleetCapturable" value="0"/>
                                <param name="OBSFleetCommunicates" value="0"/>
                                <param name="Include Clusters" value="1"/>
                                <param name="RewardCr" value="L2M02 Sc5 StA.RewardCr"/>
                                <param name="RoundReward" value="1"/>
                                <param name="BriefingBackground" value="ship_argon_mercury.tga"/>
                              </params>
                            </cue>
                            <cue name="L2M02 Sc5 StA End" delay="1s">
                              <condition>
                                <check_all>
                                  <check_value value="{value@L2M02 Scene 5.1 L0M19 Progress}" min="1"/>
                                </check_all>
                              </condition>
                              <timing>
                                <time min="1s" max="3s"/>
                              </timing>
                              <action>
                                <do_all>
                                  <remove_briefing cue="L2M02 Scene 5"/>
                                  <do_choose>
                                    <do_when value="{value@L2M02 Scene 5.1 L0M19 Progress}" exact="1">
                                      <remove_objective cue="L2M02 Scene 5" status="complete"/>
                                      <set_value name="this.textid" min="282951" max="282960"/>
                                      <play_text actor="L2M02.TeSaat" textid="{value@this.textid}" priority="99"/>
                                      <reward_player>
                                        <money exact="{value@L2M02 Sc5 StA.RewardCr}"/>
                                      </reward_player>
                                      <!--increase the players rank points by 33-50% = about 3 or missions per rank level-->
                                      <set_value name="this.increase" min="{player.missionrank.L2OFF}/3" max="{player.missionrank.L2OFF}/2"/>
                                      <do_if value="{value@this.increase}" min="1" negate="1">
                                        <set_value name="this.increase" min="1" max="3" profile="bell"/>
                                      </do_if>
                                      <increment_mission_rank name="L2OFF" exact="{value@this.increase}"/>
                                    </do_when>
                                    <do_when value="{value@L2M02 Scene 5.1 L0M19 Progress}" exact="99">
                                      <remove_objective cue="L2M02 Scene 5" status="aborted"/>
                                      <set_value name="this.textid" min="282812" max="282813"/>
                                      <play_text actor="L2M02.TeSaat" textid="{value@this.textid}" priority="99"/>
                                      <increment_mission_rank name="L2OFF" max="-1" min="-1-{player.missionrank.L2OFF.rank}"/>
                                    </do_when>
                                    <do_otherwise>
                                      <remove_objective cue="L2M02 Scene 5" status="failed"/>
                                      <set_value name="this.textid" min="282812" max="282813"/>
                                      <play_text actor="L2M02.TeSaat" textid="{value@this.textid}" priority="99"/>
                                      <increment_mission_rank name="L2OFF" max="-1" min="-1-{player.missionrank.L2OFF.rank}"/>
                                    </do_otherwise>
                                  </do_choose>
                                </do_all>
                              </action>
                              <cues>
                                <cue name="L2M02 Sc5 StA Reset">
                                  <condition>
                                    <cue_completed cue="L2M02 Sc5 StA End"/>
                                  </condition>
                                  <timing>
                                    <time min="900s" max="1500s"/>
                                  </timing>
                                  <action>
                                    <reset_cue cue="L2M02 Scene 5"/>
                                  </action>
                                </cue>
                              </cues>
                            </cue>
                          </cues>
                        </cue>

                        <!--Mission B, defend the commitee outpost in khaak sector-->
                        <cue name="L2M02 Sc5 StB" check="cancel">
                          <condition>
                            <check_value value="{value@L2M02 Scene 5.NextMission}" exact="2"/>
                          </condition>
                          <action>
                            <do_all>
                              <set_value name="L2M02 Scene 5.NextMission" exact="0"/>
                              <set_value name="L2M02 Scene 5.Mission B Chance" exact="0"/>
                              <play_text actor="L2M02.TeSaat" textid="282502" priority="99"/>
                              <set_value name="L2M02 Sc5 StB.Difficulty" exact="{player.missionrank.L2OFF.rank}"/>
                              <do_if value="{value@L2M02 Sc5 StB.Difficulty}" min="{lookup.level@trivial}" negate="1">
                                <set_value name="L2M02 Sc5 StB.Difficulty" exact="{lookup.level@trivial}"/>
                              </do_if>
                              <do_if value="{value@L2M02 Sc5 StB.Difficulty}" max="{lookup.level@impossible}" negate="1">
                                <set_value name="L2M02 Sc5 StB.Difficulty" exact="{lookup.level@impossible}"/>
                              </do_if>
                              <reward_player>
                                <map>
                                  <sector sector="L2M02.KhaakSec2"/>
                                </map>
                              </reward_player>
                              <do_if value="{object.exists@L2M02.HiddenBase}" exact="1" negate="1">
                                <create_station name="L2M02.HiddenBase" typename="SS_DOCK_S_MILITARY" race="split">
                                  <position x="-25km" y="-10km" z="-30km" min="2km" max="5km" height="1km"/>
                                  <sector sector="L2M02.KhaakSec2"/>
                                  <equipment loadout="default"/>
                                  <relations>
                                    <relation relation="neutral" mutual="0"/>
                                  </relations>
                                </create_station>
                              </do_if>
                              <set_relation object="L2M02.HiddenBase">
                                <relation relation="friend" mutual="0"/>
                              </set_relation>
                              <!--if the khaak station still exists move it further north and adjust IS khaak jobs-->
                              <find_station name="this.khaakstation" nearest="1" race="khaak">
                                <position object="L2M02.HiddenBase"/>
                                <sector sector="L2M02.KhaakSec2"/>
                              </find_station>
                              <do_if value="{object.exists@this.khaakstation}" exact="1">
                                <warp_object object="this.khaakstation">
                                  <position x="32km" y="1km" z="44km" min="50m" max="500m"/>
                                  <sector sector="L2M02.KhaakSec2"/>
                                </warp_object>
                                <set_known object="this.khaakstation" known="0"/>
                                <find_ship group="this.khaakships" race="khaak" multiple="1" max="99">
                                  <position object="L2M02.HiddenBase"/>
                                  <sector sector="L2M02.KhaakSec2"/>
                                  <distance min="500m" max="35km"/>
                                </find_ship>
                                <do_all counter="ship" exact="{group.object.count@this.khaakships}">
                                  <warp_object object="{group.object.{counter@ship}@this.khaakships}">
                                    <position x="32km" y="1km" z="44km" min="2km" max="25km"/>
                                    <sector sector="L2M02.KhaakSec2"/>
                                  </warp_object>
                                </do_all>
                                <set_group_command group="this.khaakships" command="killenemiesrange" distance="40km">
                                  <position object="this.khaakstation"/>
                                  <sector sector="L2M02.KhaakSec2"/>
                                </set_group_command>
                                <remove_object object="this.khaakstation"/>
                                <remove_group group="this.khaakships"/>
                              </do_if>
                              <set_known object="L2M02.HiddenBase" known="1"/>
                              <set_highlight object="L2M02.HiddenBase" highlight="1"/>
                            </do_all>
                          </action>
                          <cues>
                            <cue name="L2M02 Sc5 StB IS" delay="50">
                              <condition>
                                <object_sector exact="0">
                                  <sector sector="L2M02.KhaakSec2"/>
                                </object_sector>
                              </condition>
                              <timing>
                                <time exact="50"/>
                              </timing>
                              <action>
                                <do_all min="4" max="7">
                                  <do_any>
                                    <create_ship name="this.ship" race="argon" typename="{random.type@SS_SH_A_M6M|SS_SH_A_M6|SS_SH_A_M7|SS_SH_A_M7M}" chance="10-{value@L2M02 Sc5 StB.Difficulty}">
                                      <position object="L2M02.HiddenBase" min="4km" max="15km"/>
                                      <sector sector="L2M02.KhaakSec2"/>
                                      <equipment loadout="maximum"/>
                                      <command command="killenemies"/>
                                      <pilot jobtextid="40010"/>
                                    </create_ship>
                                    <create_ship name="this.ship" race="argon" typename="{random.type@SS_SH_A_M3P|SS_SH_A_M3_1|SS_SH_A_M3_3|SS_SH_A_M4_2|SS_SH_A_M4P|SS_SH_OTAS_M4P|SS_SH_OTAS_M3}" chance="10+{value@L2M02 Sc5 StB.Difficulty}">
                                      <position object="L2M02.HiddenBase" min="4km" max="15km"/>
                                      <sector sector="L2M02.KhaakSec2"/>
                                      <equipment loadout="maximum"/>
                                      <command command="killenemies"/>
                                      <pilot jobtextid="30000"/>
                                    </create_ship>
                                    <create_ship name="this.ship" race="split" typename="{random.type@SS_SH_S_M6M|SS_SH_S_M6|SS_SH_S_M7|SS_SH_S_M7M}" chance="10-{value@L2M02 Sc5 StB.Difficulty}">
                                      <position object="L2M02.HiddenBase" min="4km" max="15km"/>
                                      <sector sector="L2M02.KhaakSec2"/>
                                      <equipment loadout="maximum"/>
                                      <command command="killenemies"/>
                                      <pilot jobtextid="40010"/>
                                    </create_ship>
                                    <create_ship name="this.ship" race="split" typename="{random.type@SS_SH_S_M3P|SS_SH_S_M3_1|SS_SH_S_M3_2|SS_SH_S_M4_2|SS_SH_S_M4P|SS_SH_S_M4_2|SS_SH_S_M5_1}" chance="10+{value@L2M02 Sc5 StB.Difficulty}">
                                      <position object="L2M02.HiddenBase" min="4km" max="15km"/>
                                      <sector sector="L2M02.KhaakSec2"/>
                                      <equipment loadout="maximum"/>
                                      <command command="killenemies"/>
                                      <pilot jobtextid="30000"/>
                                    </create_ship>
                                    <create_ship name="this.ship" race="boron" typename="{random.type@SS_SH_B_M6M|SS_SH_B_M6|SS_SH_B_M7|SS_SH_B_M7M}" chance="5-({value@L2M02 Sc5 StB.Difficulty}/2)">
                                      <position object="L2M02.HiddenBase" min="4km" max="15km"/>
                                      <sector sector="L2M02.KhaakSec2"/>
                                      <equipment loadout="maximum"/>
                                      <command command="killenemies"/>
                                      <pilot jobtextid="40010"/>
                                    </create_ship>
                                    <create_ship name="this.ship" race="paranid" typename="{random.type@SS_SH_P_M3P|SS_SH_P_M3_1|SS_SH_P_M3_2|SS_SH_P_M4_2|SS_SH_P_M4P|SS_SH_P_M6M}" chance="5+({value@L2M02 Sc5 StB.Difficulty}/2)">
                                      <position object="L2M02.HiddenBase" min="4km" max="15km"/>
                                      <sector sector="L2M02.KhaakSec2"/>
                                      <equipment loadout="maximum"/>
                                      <command command="killenemies"/>
                                      <pilot jobtextid="30000"/>
                                    </create_ship>
                                  </do_any>
                                  <add_equipment object="this.ship">
                                    <ware typename="SS_WARE_TECH213" min="({object.equipment.SS_WARE_TECH213.maxcount@this.ship}-{object.equipment.SS_WARE_TECH213.count@this.ship})/2" max="{object.equipment.SS_WARE_TECH213.maxcount@this.ship}-{object.equipment.SS_WARE_TECH213.count@this.ship}"/>
                                  </add_equipment>
                                  <set_object name="L2M02.Scene 5 KSec2 Fighters {object@this.ship}" value="{object@this.ship}" group="L2M02.Scene 5 KSec2 Fighters"/>
                                </do_all>
                              </action>
                            </cue>
                            <cue ref="L0M35 B">
                              <params>
                                <param name="Cue" value="L2M02 Scene 5"/>
                                <param name="ID" value="2"/>
                                <param name="Step" value="2"/>
                                <param name="OfferRace" value="{lookup.race@argon}"/>
                                <param name="EnemyRace" value="{lookup.race@khaak}"/>
                                <param name="Lv1Guide" value="L2M02.TeSaat"/>
                                <param name="Object" value="L2M02.HiddenBase"/>
                                <param name="PageID" value="3202"/>
                                <param name="TextID" value="502"/>
                                <param name="StoryID" value="2"/>
                                <param name="ChapterID" value="204"/>
                                <param name="Difficulty" value="{value@L2M02 Sc5 StB.Difficulty}"/>
                                <param name="RewardCr" value="L2M02 Sc5 StB.RewardCr"/>
                                <param name="Bonus" value="L2M02 Sc5 StB.RewardBonus"/>
                                <param name="RoundReward" value="1"/>
                                <param name="BriefingBackground" value="sector_khaak_931.tga"/>
                              </params>
                            </cue>
                            <cue name="L2M02 Sc5 StB Accepted">
                              <condition>
                                <cue_completed cue="L0M35 B"/>
                              </condition>
                              <timing>
                                <time min="250" max="350"/>
                              </timing>
                              <cues>
                                <cue ref="L0M35">
                                  <params>
                                    <param name="Cue" value="L2M02 Scene 5"/>
                                    <param name="ID" value="2"/>
                                    <param name="OfferRace" value="{lookup.race@argon}"/>
                                    <param name="EnemyRace" value="{lookup.race@khaak}"/>
                                    <param name="Lv1Guide" value="L2M02.TeSaat"/>
                                    <param name="PageID" value="3202"/>
                                    <param name="TextID" value="502"/>
                                    <param name="StoryID" value="2"/>
                                    <param name="ChapterID" value="204"/>
                                    <param name="Difficulty" value="{value@L2M02 Sc5 StB.Difficulty}"/>
                                    <param name="RewardCr" value="L2M02 Sc5 StB.RewardCr"/>
                                    <param name="Bonus" value="L2M02 Sc5 StB.RewardBonus"/>
                                    <param name="RoundReward" value="1"/>
                                    <param name="OBS PointsMin" value="2*{value@Constant {lookup.class@m6} Points}-1"/>
                                    <param name="BriefingBackground" value="sector_khaak_931.tga"/>
                                  </params>
                                </cue>
                                <cue name="L2M02 Sc5 StB Cutscene" check="cancel">
                                  <condition>
                                    <check_value value="L2M02.Sc5 StB Cutscene Played" exact="1" negate="1"/>
                                  </condition>
                                  <cues>
                                    <cue name="L2M02 Sc5 StB Play Cutscene" delay="50">
                                      <condition>
                                        <check_all>
                                          <object_sector exact="0">
                                            <sector sector="L2M02.KhaakSec2"/>
                                          </object_sector>
                                          <check_value value="{group.strongest.exists@L0M35.2 Enemies}" exact="1"/>
                                        </check_all>
                                      </condition>
                                      <action>
                                        <do_all>
                                          <find_ship group="L2M02 Sc5 StB Play Cutscene.StopShips" race="khaak" multiple="1" max="50" nearest="1">
                                            <jumps exact="0"/>
                                            <distance max="20km"/>
                                          </find_ship>
                                          <set_group_command group="L2M02 Sc5 StB Play Cutscene.StopShips" command="stay"/>
                                          <play_cutscene file="Khaak Plot S5 C2"/>
                                          <play_text priority="99">
                                            <line face="305" pageid="310" textid="925"/>
                                            <line face="305" pageid="310" textid="939"/>
                                          </play_text>
                                          <set_object name="this.CutSceneStation" value="{object@L2M02.HiddenBase}"/>
                                          <set_object name="this.CutSceneShip" value="{group.strongest@L0M35.2 Enemies}"/>
                                          <!--always play the cutscene?
                                          <set_value name="L2M02.Sc5 StB Cutscene Played" exact="1"/>-->
                                        </do_all>
                                      </action>
                                      <cues>
                                        <cue name="L2M02 Sc5 StB ReStart Ships">
                                          <condition>
                                            <cue_completed cue="L2M02 Sc5 StB Play Cutscene"/>
                                          </condition>
                                          <timing>
                                            <time exact="13000"/>
                                          </timing>
                                          <action>
                                            <do_all>
                                              <set_group_command group="L2M02 Sc5 StB Play Cutscene.StopShips" command="killenemies"/>
                                              <remove_group group="L2M02 Sc5 StB Play Cutscene.StopShips"/>
                                            </do_all>
                                          </action>
                                        </cue>
                                      </cues>
                                    </cue>
                                  </cues>
                                </cue>
                                <cue name="L2M02 Sc5 StB End" delay="1s">
                                  <condition>
                                    <check_value value="{value@L2M02 Scene 5.2 L0M35 Progress}" min="1"/>
                                  </condition>
                                  <timing>
                                    <time min="1s" max="3s"/>
                                  </timing>
                                  <action>
                                    <do_all>
                                      <set_highlight object="L2M02.HiddenBase" highlight="0"/>
                                      <remove_briefing cue="L2M02 Scene 5"/>
                                      <do_choose>
                                        <do_when value="{value@L2M02 Scene 5.2 L0M35 Progress}" exact="1">
                                          <remove_objective cue="L2M02 Scene 5" status="complete"/>
                                          <set_value name="this.textid" min="282951" max="282960"/>
                                          <play_text actor="L2M02.TeSaat" textid="{value@this.textid}" priority="99"/>
                                          <reward_player>
                                            <money exact="{value@L2M02 Sc5 StB.RewardCr}+{value@L2M02 Sc5 StB.RewardBonus}"/>
                                          </reward_player>
                                          <!--increase the players rank points by 33-50% = about 3 or missions per rank level-->
                                          <set_value name="this.increase" min="{player.missionrank.L2OFF}/3" max="{player.missionrank.L2OFF}/2"/>
                                          <do_if value="{value@this.increase}" min="1" negate="1">
                                            <set_value name="this.increase" min="1" max="3" profile="bell"/>
                                          </do_if>
                                          <increment_mission_rank name="L2OFF" exact="{value@this.increase}"/>
                                        </do_when>
                                        <do_when value="{value@L2M02 Scene 5.2 L0M35 Progress}" exact="99">
                                          <remove_objective cue="L2M02 Scene 5" status="aborted"/>
                                          <set_value name="this.textid" min="282812" max="282813"/>
                                          <play_text actor="L2M02.TeSaat" textid="{value@this.textid}" priority="99"/>
                                          <increment_mission_rank name="L2OFF" max="-1" min="-1-{player.missionrank.L2OFF.rank}"/>
                                        </do_when>
                                        <do_otherwise>
                                          <remove_objective cue="L2M02 Scene 5" status="failed"/>
                                          <set_value name="this.textid" min="282812" max="282813"/>
                                          <play_text actor="L2M02.TeSaat" textid="{value@this.textid}" priority="99"/>
                                          <increment_mission_rank name="L2OFF" max="-1" min="-1-{player.missionrank.L2OFF.rank}"/>
                                        </do_otherwise>
                                      </do_choose>
                                    </do_all>
                                  </action>
                                  <cues>
                                    <cue name="L2M02 Sc5 StB Reset">
                                      <condition>
                                        <cue_completed cue="L2M02 Sc5 StB End"/>
                                      </condition>
                                      <timing>
                                        <time min="900s" max="1500s"/>
                                      </timing>
                                      <action>
                                        <reset_cue cue="L2M02 Scene 5"/>
                                      </action>
                                    </cue>
                                  </cues>
                                </cue>
                              </cues>
                            </cue>
                          </cues>
                        </cue>

                        <!--Mission C, kill nearby enemy group-->
                        <cue name="L2M02 Sc5 StC" check="cancel">
                          <condition>
                            <check_value value="{value@L2M02 Scene 5.NextMission}" exact="3"/>
                          </condition>
                          <action>
                            <do_all>
                              <set_value name="L2M02 Scene 5.NextMission" exact="0"/>
                              <set_value name="L2M02 Scene 5.Mission C Chance" exact="0"/>
                              <do_any>
                                <play_text actor="L2M02.TeSaat" textid="282911" priority="99"/>
                                <play_text actor="L2M02.TeSaat" textid="282912" priority="99"/>
                                <play_text actor="L2M02.TeSaat" textid="282913" priority="99"/>
                                <play_text actor="L2M02.TeSaat" textid="282914" priority="99"/>
                                <play_text actor="L2M02.TeSaat" textid="282915" priority="99"/>
                                <play_text actor="L2M02.TeSaat" textid="282916" priority="99"/>
                              </do_any>
                              <set_value name="L2M02 Sc5 StC.Difficulty" exact="{player.missionrank.L2OFF.rank}"/>
                              <do_if value="{value@L2M02 Sc5 StC.Difficulty}" min="{lookup.level@trivial}" negate="1">
                                <set_value name="L2M02 Sc5 StC.Difficulty" exact="{lookup.level@trivial}"/>
                              </do_if>
                              <do_if value="{value@L2M02 Sc5 StC.Difficulty}" max="{lookup.level@impossible}" negate="1">
                                <set_value name="L2M02 Sc5 StC.Difficulty" exact="{lookup.level@impossible}"/>
                              </do_if>
                              <do_any>
                                <do_all chance="35">
                                  <find_sector name="L2M02 Sc5 StC.Sector" x="14" y="8" exact="0"/>
                                  <set_value name="L2M02 Sc5 StC.MinDist" exact="15"/>
                                  <set_value name="L2M02 Sc5 StC.MinDist" exact="25"/>
                                  <set_value name="L2M02 Sc5 StC.FlyToStep" exact="0"/>
                                  <set_value name="L2M02 Sc5 StC.MissionStep" exact="2"/>
                                </do_all>
                                <do_all chance="55">
                                  <find_sector name="L2M02 Sc5 StC.Sector" x="14" y="7" exact="0"/>
                                  <set_value name="L2M02 Sc5 StC.MinDist" exact="45"/>
                                  <set_value name="L2M02 Sc5 StC.MinDist" exact="65"/>
                                  <set_value name="L2M02.USKhaakAmt" exact="0"/>
                                  <set_value name="L2M02 Sc5 StC.FlyToStep" exact="1"/>
                                  <set_value name="L2M02 Sc5 StC.MissionStep" exact="3"/>
                                </do_all>
                                <do_all chance="10">
                                  <find_sector name="L2M02 Sc5 StC.Sector" x="15" y="7" exact="0"/>
                                  <set_value name="L2M02 Sc5 StC.MinDist" exact="15"/>
                                  <set_value name="L2M02 Sc5 StC.MinDist" exact="25"/>
                                  <set_value name="L2M02 Sc5 StC.FlyToStep" exact="1"/>
                                  <set_value name="L2M02 Sc5 StC.MissionStep" exact="3"/>
                                </do_all>
                              </do_any>
                            </do_all>
                          </action>
                          <cues>
                            <cue name="L2M02 Sc5 StC Set Briefing" library="1" check="cancel">
                              <condition>
                                <check_value value="{value@L2M02 Sc5 StC.FlyToStep}" exact="1"/>
                              </condition>
                              <action>
                                <do_all>
                                  <set_objective cue="L2M02 Scene 5" title="{3608,1002}">
                                    <briefing cue="L2M02 Scene 5" step="2"/>
                                    <mission discipline="XXXT" level="easy"/>
                                    <flyto>
                                      <sector sector="L2M02 Sc5 StC.Sector"/>
                                    </flyto>
                                  </set_objective>
                                  <create_briefing cue="L2M02 Scene 5" title="{3608,1002}" text="{3202,503}" background="sector_argon_m148.tga">
                                    <mission discipline="XXXT" level="easy"/>
                                    <objectives>
                                      <objective step="2">
                                        <flyto>
                                          <sector sector="L2M02 Sc5 StC.Sector"/>
                                        </flyto>
                                      </objective>
                                    </objectives>
                                  </create_briefing>
                                </do_all>
                              </action>
                            </cue>
                            <cue ref="L2M02 Sc5 StC Set Briefing">
                              <params>
                                <param name="EnemyRace" value="{lookup.race@khaak}"/>
                              </params>
                            </cue>
                            <cue name="L2M02 Sc5 StC IS" delay="50">
                              <condition>
                                <object_sector exact="0">
                                  <sector sector="L2M02 Sc5 StC.Sector"/>
                                </object_sector>
                              </condition>
                              <cues>
                                <cue ref="L0M08 B">
                                  <params>
                                    <param name="Cue" value="L2M02 Scene 5"/>
                                    <param name="ID" value="2"/>
                                    <param name="Step" value="{value@L2M02 Sc5 StC.MissionStep}"/>
                                    <param name="OfferRace" value="{lookup.race@argon}"/>
                                    <param name="EnemyRace" value="{lookup.race@khaak}"/>
                                    <param name="Lv1Guide" value="L2M02.TeSaat"/>
                                    <param name="Sector" value="L2M02 Sc5 StC.Sector"/>
                                    <param name="SectorMinDist" value="{value@L2M02 Sc5 StC.MinDist}"/>
                                    <param name="SectorMaxDist" value="{value@L2M02 Sc5 StC.MaxDist}"/>
                                    <param name="PageID" value="3202"/>
                                    <param name="TextID" value="503"/>
                                    <param name="StoryID" value="2"/>
                                    <param name="ChapterID" value="204"/>
                                    <param name="Difficulty" value="{value@L2M02 Sc5 StC.Difficulty}"/>
                                    <param name="RewardCr" value="L2M02 Sc5 StC.RewardCr"/>
                                    <param name="Bonus" value="L2M02 Sc5 StC.RewardBonus"/>
                                    <param name="RoundReward" value="1"/>
                                    <param name="BriefingBackground" value="ship_khaak_fighter.tga"/>
                                  </params>
                                </cue>
                                <cue name="L2M02 Sc5 StC Accepted">
                                  <condition>
                                    <cue_completed cue="L0M08 B"/>
                                  </condition>
                                  <timing>
                                    <time min="250" max="350"/>
                                  </timing>
                                  <cues>
                                    <cue ref="L0M08">
                                      <params>
                                        <param name="Cue" value="L2M02 Scene 5"/>
                                        <param name="ID" value="2"/>
                                        <param name="Step" value="{value@L2M02 Sc5 StC.MissionStep}"/>
                                        <param name="OfferRace" value="{lookup.race@argon}"/>
                                        <param name="EnemyRace" value="{lookup.race@khaak}"/>
                                        <param name="Lv1Guide" value="L2M02.TeSaat"/>
                                        <param name="Sector" value="L2M02 Sc5 StC.Sector"/>
                                        <param name="SectorMinDist" value="{value@L2M02 Sc5 StC.MinDist}"/>
                                        <param name="SectorMaxDist" value="{value@L2M02 Sc5 StC.MaxDist}"/>
                                        <param name="PageID" value="3202"/>
                                        <param name="TextID" value="503"/>
                                        <param name="StoryID" value="2"/>
                                        <param name="ChapterID" value="204"/>
                                        <param name="Difficulty" value="{value@L2M02 Sc5 StC.Difficulty}"/>
                                        <param name="RewardCr" value="L2M02 Sc5 StC.RewardCr"/>
                                        <param name="Bonus" value="L2M02 Sc5 StC.RewardBonus"/>
                                        <param name="RoundReward" value="1"/>
                                        <param name="NoStartMessage" value="1"/>
                                        <param name="BriefingBackground" value="ship_khaak_fighter.tga"/>
                                        <param name="OBS PointsMin" value="{value@Constant {lookup.class@m6} Points}+(2*{value@Constant {lookup.class@m3} Points})"/>
                                        <param name="Include Clusters" value="1"/>
                                      </params>
                                    </cue>
                                    <cue name="L2M02 Sc5 StC End" delay="1s">
                                      <condition>
                                        <check_all>
                                          <check_value value="{value@L2M02 Scene 5.2 L0M08 Progress}" min="1"/>
                                        </check_all>
                                      </condition>
                                      <timing>
                                        <time min="1s" max="3s"/>
                                      </timing>
                                      <action>
                                        <do_all>
                                          <remove_briefing cue="L2M02 Scene 5"/>
                                          <set_value name="L2M02.USKhaakAmt" exact="8"/>
                                          <do_choose>
                                            <do_when value="{value@L2M02 Scene 5.2 L0M08 Progress}" exact="1">
                                              <remove_objective cue="L2M02 Scene 5" status="complete"/>
                                              <set_value name="this.textid" min="282951" max="282960"/>
                                              <play_text actor="L2M02.TeSaat" textid="{value@this.textid}" priority="99"/>
                                              <reward_player>
                                                <money exact="{value@L2M02 Sc5 StC.RewardCr}+{value@L2M02 Sc5 StC.RewardBonus}"/>
                                              </reward_player>
                                              <!--increase the players rank points by 33-50% = about 3 or missions per rank level-->
                                              <set_value name="this.increase" min="{player.missionrank.L2OFF}/3" max="{player.missionrank.L2OFF}/2"/>
                                              <do_if value="{value@this.increase}" min="1" negate="1">
                                                <set_value name="this.increase" min="1" max="3" profile="bell"/>
                                              </do_if>
                                              <increment_mission_rank name="L2OFF" exact="{value@this.increase}"/>
                                            </do_when>
                                            <do_when value="{value@L2M02 Scene 5.2 L0M08 Progress}" exact="99">
                                              <remove_objective cue="L2M02 Scene 5" status="aborted"/>
                                              <set_value name="this.textid" min="282812" max="282813"/>
                                              <play_text actor="L2M02.TeSaat" textid="{value@this.textid}" priority="99"/>
                                              <increment_mission_rank name="L2OFF" max="-1" min="-1-{player.missionrank.L2OFF.rank}"/>
                                            </do_when>
                                            <do_otherwise>
                                              <remove_objective cue="L2M02 Scene 5" status="failed"/>
                                              <set_value name="this.textid" min="282812" max="282813"/>
                                              <play_text actor="L2M02.TeSaat" textid="{value@this.textid}" priority="99"/>
                                              <increment_mission_rank name="L2OFF" max="-1" min="-1-{player.missionrank.L2OFF.rank}"/>
                                            </do_otherwise>
                                          </do_choose>
                                        </do_all>
                                      </action>
                                      <cues>
                                        <cue name="L2M02 Sc5 StC Reset">
                                          <condition>
                                            <cue_completed cue="L2M02 Sc5 StC End"/>
                                          </condition>
                                          <timing>
                                            <time min="900s" max="1500s"/>
                                          </timing>
                                          <action>
                                            <reset_cue cue="L2M02 Scene 5"/>
                                          </action>
                                        </cue>
                                      </cues>
                                    </cue>
                                  </cues>
                                </cue>
                              </cues>
                            </cue>
                          </cues>
                        </cue>

                        <!--Mission D, defend a commitee outpost in X universe???-->
                        <!--Mission E, protect nearby civilian transports-->

                        <!--Mission F, kill khaak group in khaak sector-->
                        <cue name="L2M02 Sc5 StF" check="cancel">
                          <condition>
                            <check_value value="{value@L2M02 Scene 5.NextMission}" exact="6"/>
                          </condition>
                          <action>
                            <do_all>
                              <set_value name="L2M02 Scene 5.NextMission" exact="0"/>
                              <set_value name="L2M02 Scene 5.Mission F Chance" exact="0"/>
                              <do_any>
                                <play_text actor="L2M02.TeSaat" textid="282941" priority="99"/>
                                <play_text actor="L2M02.TeSaat" textid="282942" priority="99"/>
                                <play_text actor="L2M02.TeSaat" textid="282943" priority="99"/>
                                <play_text actor="L2M02.TeSaat" textid="282944" priority="99"/>
                                <play_text actor="L2M02.TeSaat" textid="282945" priority="99"/>
                                <play_text actor="L2M02.TeSaat" textid="282946" priority="99"/>
                                <play_text actor="L2M02.TeSaat" textid="282947" priority="99"/>
                                <play_text actor="L2M02.TeSaat" textid="282948" priority="99"/>
                                <play_text actor="L2M02.TeSaat" textid="282949" priority="99"/>
                              </do_any>
                              <set_value name="L2M02 Sc5 StF.Difficulty" exact="{player.missionrank.L2OFF.rank}"/>
                              <do_if value="{value@L2M02 Sc5 StF.Difficulty}" min="{lookup.level@trivial}" negate="1">
                                <set_value name="L2M02 Sc5 StF.Difficulty" exact="{lookup.level@trivial}"/>
                              </do_if>
                              <do_if value="{value@L2M02 Sc5 StF.Difficulty}" max="{lookup.level@impossible}" negate="1">
                                <set_value name="L2M02 Sc5 StF.Difficulty" exact="{lookup.level@impossible}"/>
                              </do_if>
                              <reward_player>
                                <map>
                                  <sector sector="L2M02.KhaakSec1"/>
                                </map>
                              </reward_player>
                              <set_value name="L2M02 Sc5 StF.MinDist" exact="6"/>
                              <set_value name="L2M02 Sc5 StF.MaxDist" exact="20"/>

                              <!--jobs ships respawn very fast, making it impossibleto clear the sector-->
                              <!--move jobs ships away from the sector centre to make the mission possible-->
                              <!--OBS will spawn some mission ships to destroy-->
                              <find_ship group="this.ships" class="ship" race="khaak" multiple="1" max="99">
                                <sector sector="L2M02.KhaakSec1"/>
                                <jumps exact="0"/>
                              </find_ship>
                              <do_if value="{group.object.count@this.ships}" min="1">
                                <warp_group group="this.ships">
                                  <position x="0" height="50km" min="500km" max="600km"/>
                                  <sector sector="L2M02.KhaakSec1"/>
                                </warp_group>
                                <set_group_command group="this.ships" command="killenemiesrange" distance="60km">
                                  <position x="0" y="0" z="0" min="1km" max="5km"/>
                                  <sector sector="L2M02.KhaakSec1"/>
                                </set_group_command>
                              </do_if>
                              <find_ship group="this.corvettes" class="bigship" race="khaak" multiple="1" max="20">
                                <sector sector="L2M02.KhaakSec1"/>
                                <jumps exact="0"/>
                              </find_ship>
                              <do_if value="{group.object.count@this.corvettes}" min="1">
                                <warp_group group="this.corvettes">
                                  <position x="0" height="50km" min="400km" max="500km"/>
                                  <sector sector="L2M02.KhaakSec1"/>
                                </warp_group>
                                <set_group_command group="this.corvettes" command="killenemiesrange" distance="60km">
                                  <position x="0" y="0" z="0" min="1km" max="5km"/>
                                  <sector sector="L2M02.KhaakSec1"/>
                                </set_group_command>
                              </do_if>
                              <remove_group group="this.ships"/>
                              <remove_group group="this.corvettes"/>
                            </do_all>
                          </action>
                          <cues>
                            <cue name="L2M02 Sc5 StF Set Briefing" library="1">
                              <action>
                                <do_all>
                                  <set_objective cue="L2M02 Scene 5" title="{3608,1002}">
                                    <briefing cue="L2M02 Scene 5" step="2"/>
                                    <mission discipline="XXXT" level="easy"/>
                                    <flyto>
                                      <sector sector="L2M02.KhaakSec1"/>
                                    </flyto>
                                  </set_objective>
                                  <create_briefing cue="L2M02 Scene 5" title="{3608,1002}" text="{3202,506}" background="sector_khaak_931.tga">
                                    <mission discipline="XXXT" level="easy"/>
                                    <objectives>
                                      <objective step="2">
                                        <flyto>
                                          <sector sector="L2M02.KhaakSec1"/>
                                        </flyto>
                                      </objective>
                                    </objectives>
                                  </create_briefing>
                                </do_all>
                              </action>
                            </cue>
                            <cue ref="L2M02 Sc5 StF Set Briefing">
                              <params>
                                <param name="EnemyRace" value="{lookup.race@khaak}"/>
                              </params>
                            </cue>
                            <cue name="L2M02 Sc5 StF IS" delay="50">
                              <condition>
                                <object_sector exact="0">
                                  <sector sector="L2M02.KhaakSec1"/>
                                </object_sector>
                              </condition>
                              <timing>
                                <time exact="50"/>
                              </timing>
                              <action>
                                <do_all>
                                  <!--create spacefly to position fighters-->
                                  <create_spacefly name="this.spacefly">
                                    <position x="0" height="5km" min="5km" max="15km"/>
                                    <sector sector="L2M02.KhaakSec1"/>
                                  </create_spacefly>
                                  <!--create fighters-->
                                  <do_all min="4" max="7">
                                    <do_any>
                                      <create_ship name="this.ship" race="argon" typename="{random.type@SS_SH_A_M6M|SS_SH_A_M6|SS_SH_A_M7|SS_SH_A_M7M}" chance="10-{value@L2M02 Sc5 StB.Difficulty}">
                                        <position object="this.spacefly" min="500m" max="1500m"/>
                                        <sector sector="L2M02.KhaakSec1"/>
                                        <equipment loadout="maximum"/>
                                        <command command="killenemies"/>
                                      </create_ship>
                                      <create_ship name="this.ship" race="argon" typename="{random.type@SS_SH_A_M3P|SS_SH_A_M3_1|SS_SH_A_M3_3|SS_SH_A_M4_2|SS_SH_A_M4P|SS_SH_OTAS_M4P|SS_SH_OTAS_M3}" chance="10+{value@L2M02 Sc5 StB.Difficulty}">
                                        <position object="this.spacefly" min="500m" max="1500m"/>
                                        <sector sector="L2M02.KhaakSec1"/>
                                        <equipment loadout="maximum"/>
                                        <command command="killenemies"/>
                                      </create_ship>
                                      <create_ship name="this.ship" race="split" typename="{random.type@SS_SH_S_M6M|SS_SH_S_M6|SS_SH_S_M7|SS_SH_S_M7M}" chance="10-{value@L2M02 Sc5 StB.Difficulty}">
                                        <position object="this.spacefly" min="500m" max="1500m"/>
                                        <sector sector="L2M02.KhaakSec1"/>
                                        <equipment loadout="maximum"/>
                                        <command command="killenemies"/>
                                      </create_ship>
                                      <create_ship name="this.ship" race="split" typename="{random.type@SS_SH_S_M3P|SS_SH_S_M3_1|SS_SH_S_M3_2|SS_SH_S_M4_2|SS_SH_S_M4P|SS_SH_S_M4_2|SS_SH_S_M5_1}" chance="10+{value@L2M02 Sc5 StB.Difficulty}">
                                        <position object="this.spacefly" min="500m" max="1500m"/>
                                        <sector sector="L2M02.KhaakSec1"/>
                                        <equipment loadout="maximum"/>
                                        <command command="killenemies"/>
                                      </create_ship>
                                      <create_ship name="this.ship" race="boron" typename="{random.type@SS_SH_B_M6M|SS_SH_B_M6|SS_SH_B_M7|SS_SH_B_M7M}" chance="5-({value@L2M02 Sc5 StB.Difficulty}/2)">
                                        <position object="this.spacefly" min="500m" max="1500m"/>
                                        <sector sector="L2M02.KhaakSec1"/>
                                        <equipment loadout="maximum"/>
                                        <command command="killenemies"/>
                                      </create_ship>
                                      <create_ship name="this.ship" race="paranid" typename="{random.type@SS_SH_P_M3P|SS_SH_P_M3_1|SS_SH_P_M3_2|SS_SH_P_M4_2|SS_SH_P_M4P|SS_SH_P_M6M}" chance="5+({value@L2M02 Sc5 StB.Difficulty}/2)">
                                        <position object="this.spacefly" min="500m" max="1500m"/>
                                        <sector sector="L2M02.KhaakSec1"/>
                                        <equipment loadout="maximum"/>
                                        <command command="killenemies"/>
                                      </create_ship>
                                    </do_any>
                                    <set_pilot_data object="this.ship" jobtextid="60006"/>
                                    <add_equipment object="this.ship">
                                      <ware typename="SS_WARE_TECH213" min="({object.equipment.SS_WARE_TECH213.maxcount@this.ship}-{object.equipment.SS_WARE_TECH213.count@this.ship})/2" max="{object.equipment.SS_WARE_TECH213.maxcount@this.ship}-{object.equipment.SS_WARE_TECH213.count@this.ship}"/>
                                    </add_equipment>
                                    <set_object name="L2M02.Scene 5 KSec1 Fighters {object@this.ship}" value="{object@this.ship}" group="L2M02.Scene 5 KSec1 Fighters"/>
                                  </do_all>
                                  <destroy_object object="this.spacefly"/>
                                </do_all>
                              </action>
                              <cues>
                                <cue ref="L0M08 B">
                                  <params>
                                    <param name="Cue" value="L2M02 Scene 5"/>
                                    <param name="ID" value="2"/>
                                    <param name="Step" value="3"/>
                                    <param name="OfferRace" value="{lookup.race@argon}"/>
                                    <param name="EnemyRace" value="{lookup.race@khaak}"/>
                                    <param name="Lv1Guide" value="L2M02.TeSaat"/>
                                    <param name="Sector" value="L2M02.KhaakSec1"/>
                                    <param name="SectorMinDist" value="{value@L2M02 Sc5 StF.MinDist}"/>
                                    <param name="SectorMaxDist" value="{value@L2M02 Sc5 StF.MaxDist}"/>
                                    <param name="PageID" value="3202"/>
                                    <param name="TextID" value="506"/>
                                    <param name="StoryID" value="2"/>
                                    <param name="ChapterID" value="204"/>
                                    <param name="Difficulty" value="{value@L2M02 Sc5 StF.Difficulty}"/>
                                    <param name="RewardCr" value="L2M02 Sc5 StF.RewardCr"/>
                                    <param name="Bonus" value="L2M02 Sc5 StF.RewardBonus"/>
                                    <param name="RoundReward" value="1"/>
                                    <param name="BriefingBackground" value="ship_khaak_corvette.tga"/>
                                  </params>
                                </cue>
                                <cue name="L2M02 Sc5 StF Accepted">
                                  <condition>
                                    <cue_completed cue="L0M08 B"/>
                                  </condition>
                                  <timing>
                                    <time min="250" max="350"/>
                                  </timing>
                                  <cues>
                                    <cue ref="L0M08">
                                      <params>
                                        <param name="Cue" value="L2M02 Scene 5"/>
                                        <param name="ID" value="2"/>
                                        <param name="Step" value="3"/>
                                        <param name="OfferRace" value="{lookup.race@argon}"/>
                                        <param name="EnemyRace" value="{lookup.race@khaak}"/>
                                        <param name="Lv1Guide" value="L2M02.TeSaat"/>
                                        <param name="Sector" value="L2M02.KhaakSec1"/>
                                        <param name="SectorMinDist" value="{value@L2M02 Sc5 StF.MinDist}"/>
                                        <param name="SectorMaxDist" value="{value@L2M02 Sc5 StF.MaxDist}"/>
                                        <param name="PageID" value="3202"/>
                                        <param name="TextID" value="506"/>
                                        <param name="StoryID" value="2"/>
                                        <param name="ChapterID" value="204"/>
                                        <param name="Difficulty" value="{value@L2M02 Sc5 StF.Difficulty}"/>
                                        <param name="RewardCr" value="L2M02 Sc5 StF.RewardCr"/>
                                        <param name="Bonus" value="L2M02 Sc5 StF.RewardBonus"/>
                                        <param name="RoundReward" value="1"/>
                                        <param name="NoStartMessage" value="1"/>
                                        <param name="BriefingBackground" value="ship_khaak_corvette.tga"/>
                                        <param name="OBS PointsMin" value="{value@Constant {lookup.class@m6} Points}+(2*{value@Constant {lookup.class@m3} Points})"/>
                                        <param name="Include Clusters" value="1"/>
                                      </params>
                                    </cue>
                                    <cue name="L2M02 Sc5 StF End" delay="1s">
                                      <condition>
                                        <check_all>
                                          <check_value value="{value@L2M02 Scene 5.2 L0M08 Progress}" min="1"/>
                                        </check_all>
                                      </condition>
                                      <timing>
                                        <time min="1s" max="3s"/>
                                      </timing>
                                      <action>
                                        <do_all>
                                          <remove_briefing cue="L2M02 Scene 5"/>
                                          <remove_offer actor="L2M02.TeSaat" conversation="L2ShowBriefing"/>
                                          <do_choose>
                                            <do_when value="{value@L2M02 Scene 5.2 L0M08 Progress}" exact="1">
                                              <remove_objective cue="L2M02 Scene 5" status="complete"/>
                                              <set_value name="this.textid" min="282951" max="282960"/>
                                              <play_text actor="L2M02.TeSaat" textid="{value@this.textid}" priority="99"/>
                                              <reward_player>
                                                <money exact="{value@L2M02 Sc5 StF.RewardCr}+{value@L2M02 Sc5 StF.RewardBonus}"/>
                                              </reward_player>
                                              <!--increase the players rank points by 33-50% = about 3 or missions per rank level-->
                                              <set_value name="this.increase" min="{player.missionrank.L2OFF}/3" max="{player.missionrank.L2OFF}/2"/>
                                              <do_if value="{value@this.increase}" min="1" negate="1">
                                                <set_value name="this.increase" min="1" max="3" profile="bell"/>
                                              </do_if>
                                              <increment_mission_rank name="L2OFF" exact="{value@this.increase}"/>
                                              <!--offer the player an escape route just in case-->
                                              <create_crate>
                                                <position height="8km" min="30km" max="35km"/>
                                                <sector sector="L2M02.KhaakSec1"/>
                                                <ware typename="SS_WARE_ENERGY" min="61" max="74"/>
                                              </create_crate>
                                              <!--find the nearest khaak station to the player-->
                                              <find_station name="L2M02 Sc5 StF End.KhaakStation" race="khaak" nearest="1" typename="SS_DOCK_K">
                                                <sector sector="L2M02.KhaakSec1"/>
                                                <jumps exact="0"/>
                                              </find_station>
                                              <do_choose>
                                                <do_when value="{object.exists@L2M02 Sc5 StF End.KhaakStation}" exact="1">
                                                  <set_value name="L2M02 Sc5 StF End.KhaakStationX" exact="{object.position.x@L2M02 Sc5 StF End.KhaakStation}"/>
                                                  <set_value name="L2M02 Sc5 StF End.KhaakStationY" exact="{object.position.y@L2M02 Sc5 StF End.KhaakStation}"/>
                                                  <set_value name="L2M02 Sc5 StF End.KhaakStationZ" exact="{object.position.z@L2M02 Sc5 StF End.KhaakStation}"/>
                                                </do_when>
                                                <do_otherwise>
                                                  <cancel_cue cue="L2M02 Sc5 StF Loot"/>
                                                </do_otherwise>
                                              </do_choose>
                                            </do_when>
                                            <do_when value="{value@L2M02 Scene 5.2 L0M08 Progress}" exact="99">
                                              <remove_objective cue="L2M02 Scene 5" status="aborted"/>
                                              <set_value name="this.textid" min="282812" max="282813"/>
                                              <play_text actor="L2M02.TeSaat" textid="{value@this.textid}" priority="99"/>
                                              <increment_mission_rank name="L2OFF" max="-1" min="-1-{player.missionrank.L2OFF.rank}"/>
                                            </do_when>
                                            <do_otherwise>
                                              <remove_objective cue="L2M02 Scene 5" status="failed"/>
                                              <set_value name="this.textid" min="282812" max="282813"/>
                                              <play_text actor="L2M02.TeSaat" textid="{value@this.textid}" priority="99"/>
                                              <increment_mission_rank name="L2OFF" max="-1" min="-1-{player.missionrank.L2OFF.rank}"/>
                                            </do_otherwise>
                                          </do_choose>
                                        </do_all>
                                      </action>
                                      <cues>
                                        <cue name="L2M02 Sc5 StF Loot">
                                          <!--a present for the player, and extra way home if they can destroy the khaak station in time-->
                                          <condition>
                                            <object_destroyed_by_player object="L2M02 Sc5 StF End.KhaakStation"/>
                                          </condition>
                                          <action>
                                            <do_all>
                                              <create_crate>
                                                <position x="{value@L2M02 Sc5 StF End.KhaakStationX}" y="{value@L2M02 Sc5 StF End.KhaakStationY}" z="{value@L2M02 Sc5 StF End.KhaakStationZ}" min="10m" max="500m"/>
                                                <sector sector="L2M02.KhaakSec1"/>
                                                <ware typename="SS_WARE_ENERGY" min="61" max="74"/>
                                              </create_crate>
                                              <create_crate chance="75">
                                                <position x="{value@L2M02 Sc5 StF End.KhaakStationX}" y="{value@L2M02 Sc5 StF End.KhaakStationY}" z="{value@L2M02 Sc5 StF End.KhaakStationZ}" min="100m" max="200m"/>
                                                <sector sector="L2M02.KhaakSec1"/>
                                                <ware typename="SS_WARE_ENERGY" min="131" max="274"/>
                                              </create_crate>
                                              <create_crate chance="95">
                                                <position x="{value@L2M02 Sc5 StF End.KhaakStationX}" y="{value@L2M02 Sc5 StF End.KhaakStationY}" z="{value@L2M02 Sc5 StF End.KhaakStationZ}" min="10m" max="500m"/>
                                                <sector sector="L2M02.KhaakSec1"/>
                                                <ware typename="SS_WARE_NIVIDIUM2" min="6" max="24"/>
                                              </create_crate>
                                              <create_crate>
                                                <position x="{value@L2M02 Sc5 StF End.KhaakStationX}" y="{value@L2M02 Sc5 StF End.KhaakStationY}" z="{value@L2M02 Sc5 StF End.KhaakStationZ}" min="10m" max="50m"/>
                                                <sector sector="L2M02.KhaakSec1"/>
                                                <ware typename="SS_WARE_WARPING" exact="1"/>
                                              </create_crate>
                                              <create_crate chance="75">
                                                <position x="{value@L2M02 Sc5 StF End.KhaakStationX}" y="{value@L2M02 Sc5 StF End.KhaakStationY}" z="{value@L2M02 Sc5 StF End.KhaakStationZ}" min="10m" max="500m"/>
                                                <sector sector="L2M02.KhaakSec1"/>
                                                <ware typename="SS_SHIELD_E" exact="1"/>
                                              </create_crate>
                                              <create_crate chance="40">
                                                <position x="{value@L2M02 Sc5 StF End.KhaakStationX}" y="{value@L2M02 Sc5 StF End.KhaakStationY}" z="{value@L2M02 Sc5 StF End.KhaakStationZ}" min="10m" max="500m"/>
                                                <sector sector="L2M02.KhaakSec1"/>
                                                <ware typename="SS_WARE_ORE" min="17" max="89"/>
                                              </create_crate>
                                              <create_crate chance="30">
                                                <position x="{value@L2M02 Sc5 StF End.KhaakStationX}" y="{value@L2M02 Sc5 StF End.KhaakStationY}" z="{value@L2M02 Sc5 StF End.KhaakStationZ}" min="10m" max="500m"/>
                                                <sector sector="L2M02.KhaakSec1"/>
                                                <ware typename="SS_WARE_SILICON" min="17" max="57"/>
                                              </create_crate>
                                              <create_crate chance="50">
                                                <position x="{value@L2M02 Sc5 StF End.KhaakStationX}" y="{value@L2M02 Sc5 StF End.KhaakStationY}" z="{value@L2M02 Sc5 StF End.KhaakStationZ}" min="10m" max="500m"/>
                                                <sector sector="L2M02.KhaakSec1"/>
                                                <ware typename="SS_WARE_TECH205" min="17" max="89"/>
                                              </create_crate>
                                            </do_all>
                                          </action>
                                        </cue>
                                        <cue name="L2M03 Sc5 StF Cleanup">
                                          <condition>
                                            <cue_completed cue="L2M02 Sc5 StF End"/>
                                          </condition>
                                          <timing>
                                            <time min="500s" max="700s"/>
                                          </timing>
                                          <action>
                                            <do_all>
                                              <!--warp back in any jobs ships-->
                                              <find_ship group="this.ships" class="ship" race="khaak" multiple="1" max="99">
                                                <position x="0" y="0" z="0"/>
                                                <sector sector="L2M02.KhaakSec1"/>
                                                <jumps exact="0"/>
                                                <distance min="100km" max="999km"/>
                                              </find_ship>
                                              <do_if value="{group.object.count@this.ships}" min="1">
                                                <warp_group group="this.ships">
                                                  <position x="0" height="5km" min="5km" max="20km"/>
                                                  <sector sector="L2M02.KhaakSec1"/>
                                                </warp_group>
                                                <set_group_command group="this.ships" command="killenemiesrange" distance="60km">
                                                  <position x="0" y="0" z="0" min="1km" max="5km"/>
                                                  <sector sector="L2M02.KhaakSec1"/>
                                                </set_group_command>
                                              </do_if>
                                            </do_all>
                                          </action>
                                          <cues>
                                            <cue name="L2M03 Sc5 StF Cleanup Escape">
                                              <condition>
                                                <cue_completed cue="L2M03 Sc5 StF Cleanup"/>
                                              </condition>
                                              <timing>
                                                <time min="10s" max="20s"/>
                                              </timing>
                                              <action>
                                                <destroy_group group="L2M02.Scene 5 KSec1 Fighters" warp="1"/>
                                              </action>
                                            </cue>
                                          </cues>
                                        </cue>
                                        <cue name="L2M02 Sc5 StF Reset">
                                          <condition>
                                            <cue_completed cue="L2M02 Sc5 StF End"/>
                                          </condition>
                                          <timing>
                                            <time min="900s" max="1500s"/>
                                          </timing>
                                          <action>
                                            <reset_cue cue="L2M02 Scene 5"/>
                                          </action>
                                        </cue>
                                      </cues>
                                    </cue>
                                  </cues>
                                </cue>
                              </cues>
                            </cue>
                          </cues>
                        </cue>
                      </cues>
                    </cue>
                  </cues>
                </cue>
              </cues>
            </cue>
            <cue name="L2M02 Scene 6" delay="19871">
              <condition>
                <check_all>
                  <check_value value="{value@L2M02.PlotProgress}" exact="6"/>
                  <object_sector exact="0" negate="1">
                    <sector sector="L2M02.MS148"/>
                  </object_sector>
                </check_all>
              </condition>
              <action>
                <do_all>
                  <incoming_message author="{actor.name@L2M02.TeSaat}" text="{3828,282601}"/>
                  <set_objective cue="L2M02 Scene 6" story="{3200,2}" title="{3202,11}" noabort="1">
                    <mission discipline="XXXT" level="veryeasy"/>
                    <dockat object="L2M02.Base"/>
                  </set_objective>
                  <create_briefing cue="L2M02 Scene 6" title="{3200,2}" text="{3895,282401}">
                    <mission discipline="XXXT" level="veryeasy"/>
                    <objectives>
                      <objective step="1">
                        <dockat object="L2M02.Base"/>
                      </objective>
                    </objectives>
                  </create_briefing>
                </do_all>
              </action>
              <cues>
                <cue name="L2M02 Sc6 St1 IS">
                  <condition>
                    <object_changed_sector param="{sector@L2M02.MS148}"/>
                  </condition>
                  <action>
                    <do_all>
                      <!--create khaak fleet-->
                      <create_ship group="L2M02 Scene 6.KhaakShips" capturable="0" race="khaak" typename="SS_SH_K_M2">
                        <position x="0" height="5km" min="2km" max="30km"/>
                        <sector sector="L2M02.MS148"/>
                        <equipment loadout="maximum">
                          <ware typename="SS_WARE_TECH213" exact="4"/>
                          <ware typename="SS_WARE_SCANNER3"/>
                        </equipment>
                        <command command="killenemies"/>
                      </create_ship>
                      <create_ship group="L2M02 Scene 6.KhaakShips" capturable="0" race="khaak" typename="SS_SH_K_M1">
                        <position x="0" height="5km" min="2km" max="15km"/>
                        <sector sector="L2M02.MS148"/>
                        <equipment loadout="maximum">
                          <ware typename="SS_WARE_TECH213" exact="5"/>
                          <ware typename="SS_WARE_SCANNER3"/>
                        </equipment>
                        <command command="killenemies"/>
                      </create_ship>
                      <do_all min="2" max="3">
                        <create_ship group="L2M02 Scene 6.KhaakShips" capturable="0" race="khaak" typename="SS_SH_K_M6">
                          <position x="0" height="5km" min="2km" max="25km"/>
                          <sector sector="L2M02.MS148"/>
                          <equipment loadout="maximum">
                            <ware typename="SS_WARE_TECH213" min="3" max="5"/>
                            <ware typename="SS_WARE_SCANNER3"/>
                          </equipment>
                          <command command="killenemies"/>
                          <hull list="56|78|82|90|100|100|100|100|100|100|100|100"/>
                          <shield list="32|57|85|94|88|81|100|100|100|100"/>
                        </create_ship>
                      </do_all>
                      <do_all min="3" max="4">
                        <create_ship group="L2M02 Scene 6.KhaakShips" capturable="0" race="khaak" typename="SS_SH_K_M3">
                          <position x="0" height="5km" min="2km" max="15km"/>
                          <sector sector="L2M02.MS148"/>
                          <equipment loadout="maximum">
                            <ware typename="SS_WARE_TECH213" min="12" max="20"/>
                            <ware typename="SS_WARE_SCANNER3"/>
                          </equipment>
                          <command command="killenemies"/>
                          <hull list="56|78|82|90|100|100|100|100|100|100|100|100"/>
                          <shield list="32|57|85|94|88|81|100|100|100|100"/>
                        </create_ship>
                      </do_all>
                      <do_all min="3" max="6">
                        <create_ship group="L2M02 Scene 6.KhaakShips" capturable="0" race="khaak" typename="SS_SH_K_M4">
                          <position x="0" height="5km" min="2km" max="30km"/>
                          <sector sector="L2M02.MS148"/>
                          <equipment loadout="maximum">
                            <ware typename="SS_WARE_TECH213" min="15" max="20"/>
                            <ware typename="SS_WARE_SCANNER2"/>
                          </equipment>
                          <command command="killenemies"/>
                          <hull list="56|78|82|90|100|100|100|100|100|100|100|100"/>
                          <shield list="32|57|85|94|88|81|100|100|100|100"/>
                        </create_ship>
                      </do_all>
                      <do_all min="2" max="4">
                        <create_ship group="L2M02 Scene 6.KhaakShips" capturable="0" race="khaak" typename="SS_SH_K_M5">
                          <position x="0" height="5km" min="2km" max="30km"/>
                          <sector sector="L2M02.MS148"/>
                          <equipment loadout="maximum">
                            <ware typename="SS_WARE_TECH213" min="20" max="35"/>
                            <ware typename="SS_WARE_SCANNER2"/>
                          </equipment>
                          <command command="killenemies"/>
                          <hull list="45|78|82|92|100|100|100|100|100|100|100|100"/>
                          <shield list="32|57|85|94|88|81|100|100|100|100"/>
                        </create_ship>
                      </do_all>
                      <do_all min="3" max="4">
                        <create_ship group="L2M02 Scene 6.KhaakShips" capturable="0" race="khaak" typename="{random.type@SS_SH_THINKER|SS_SH_THINKER6|SS_SH_THINKER}">
                          <position x="0" z="20km" height="5km" min="2km" max="20km"/>
                          <sector sector="L2M02.MS148"/>
                          <equipment loadout="maximum">
                            <ware typename="SS_WARE_TECH213" min="20" max="35"/>
                            <ware typename="SS_WARE_SCANNER2"/>
                          </equipment>
                          <command command="killenemies"/>
                          <hull list="45|78|82|92|100|100|100|100|100|100|100|100"/>
                          <shield list="32|57|85|94|88|81|100|100|100|100"/>
                        </create_ship>
                      </do_all>
                    </do_all>
                  </action>
                </cue>
                <cue name="L2M02 Sc6 St1 IS Mission">
                  <condition>
                    <cue_completed cue="L2M02 Sc6 St1 IS"/>
                  </condition>
                  <timing>
                    <time min="5s" max="7s"/>
                  </timing>
                  <action>
                    <play_text actor="L2M02.TeSaat" textid="282602" priority="99"/>
                  </action>
                  <cues>
                    <cue name="L2M02 Sc6 St1 Nearby Group" check="cancel">
                      <!--these ships fly past the player as he enters the sector normally-->
                      <condition>
                        <count_gates min="1">
                          <jumps exact="0"/>
                        </count_gates>
                      </condition>
                      <action>
                        <do_all>
                          <!--these ships dont NEED to use the gate, but it makes them fly past the player as he enters sector-->
                          <!--find the gate to create the khaak-->
                          <find_gate name="this.gate" nearest="1">
                            <jumps exact="0"/>
                          </find_gate>
                          <do_if value="{object.destination.exists@this.gate}" exact="1">
                            <set_object name="this.gate" value="{object.destination@this.gate}"/>
                          </do_if>
                          <!--create khaak ships, L0 M08 will assign names and handle them-->
                          <do_all exact="2">
                            <create_ship typename="SS_SH_K_M3" race="khaak" capturable="0">
                              <position object="this.gate" min="10m" max="50m"/>
                              <sector sector="{object.sector@this.gate}"/>
                              <equipment loadout="maximum">
                                <ware typename="SS_WARE_TECH213" min="12" max="20"/>
                                <ware typename="SS_WARE_SCANNER3"/>
                              </equipment>
                              <command command="attack" commandobject="L2M02.Base"/>
                            </create_ship>
                          </do_all>
                          <do_all exact="3">
                            <create_ship typename="SS_SH_K_M5" race="khaak" capturable="0">
                              <position object="this.gate" min="10m" max="50m"/>
                              <sector sector="{object.sector@this.gate}"/>
                              <equipment loadout="maximum">
                                <ware typename="SS_WARE_TECH213" min="26" max="32"/>
                                <ware typename="SS_WARE_SCANNER2"/>
                              </equipment>
                              <command command="attack" commandobject="L2M02.Base"/>
                            </create_ship>
                          </do_all>
                        </do_all>
                      </action>
                    </cue>
                    <cue ref="L0M08 B">
                      <params>
                        <param name="Cue" value="L2M02 Scene 6"/>
                        <param name="ID" value="2"/>
                        <param name="Step" value="2"/>
                        <param name="OfferRace" value="{lookup.race@argon}"/>
                        <param name="EnemyRace" value="{lookup.race@khaak}"/>
                        <param name="Lv1Guide" value="L2M02.TeSaat"/>
                        <param name="Sector" value="L2M02.MS148"/>
                        <param name="PageID" value="3202"/>
                        <param name="TextID" value="601"/>
                        <param name="StoryID" value="2"/>
                        <param name="ChapterID" value="204"/>
                        <param name="Difficulty" value="{lookup.level@veryhard}"/>
                        <param name="RewardCr" value="L2M02 Scene 6.RewardCr"/>
                        <param name="Bonus" value="L2M02 Scene 6.RewardBonus"/>
                        <param name="BriefingBackground" value="sector_argon_m148.tga"/>
                        <param name="RoundReward" value="1"/>
                      </params>
                    </cue>
                    <cue name="L2M02 Sc6 St1 Wait" delay="50">
                      <condition>
                        <cue_is_complete cue="L0M08 B"/>
                      </condition>
                      <cues>
                        <cue ref="L0M08">
                          <params>
                            <param name="Cue" value="L2M02 Scene 6"/>
                            <param name="ID" value="2"/>
                            <param name="OfferRace" value="{lookup.race@argon}"/>
                            <param name="EnemyRace" value="{lookup.race@khaak}"/>
                            <param name="Lv1Guide" value="L2M02.TeSaat"/>
                            <param name="PageID" value="3202"/>
                            <param name="TextID" value="601"/>
                            <param name="AddText" value="1"/>
                            <param name="StoryID" value="2"/>
                            <param name="ChapterID" value="204"/>
                            <param name="Difficulty" value="{lookup.level@veryhard}"/>
                            <param name="RewardCr" value="L2M02 Scene 6.RewardCr"/>
                            <param name="Bonus" value="L2M02 Scene 6.RewardBonus"/>
                            <param name="Enemies" value="L2M02 Scene 6.KhaakShips"/>
                            <param name="NoStartMessage" value="1"/>
                          </params>
                        </cue>
                        <cue name="L2M02 Sc6 St1 End">
                          <condition>
                            <check_all>
                              <check_value value="{value@L2M02 Scene 6.2 L0M08 Progress}" min="1"/>
                            </check_all>
                          </condition>
                          <timing>
                            <time min="1s" max="2s"/>
                          </timing>
                          <action>
                            <do_all>
                              <do_choose>
                                <do_when value="{value@L2M02 Scene 6.2 L0M08 Progress}" exact="1">
                                  <increment_mission_rank name="L2OFF" exact="({player.missionrank.L2OFF}*3)/2"/>
                                  <cancel_cue cue="L2M02 Sc6 St1 Reset"/>
                                </do_when>
                                <do_otherwise>
                                  <remove_briefing cue="L2M02 Scene 6"/>
                                  <remove_objective cue="L2M02 Scene 6" status="failed"/>
                                  <play_text actor="L2M02.TeSaat" textid="282603" priority="99"/>
                                  <increment_mission_rank name="L2OFF" max="-1" min="-1-{player.missionrank.L2OFF.rank}"/>
                                  <cancel_cue cue="L2M02 Sc6 St2"/>
                                </do_otherwise>
                              </do_choose>
                            </do_all>
                          </action>
                          <cues>
                            <cue name="L2M02 Sc6 St1 Reset">
                              <condition>
                                <cue_completed cue="L2M02 Sc6 St1 End"/>
                              </condition>
                              <timing>
                                <time min="1500s" max="1800s"/>
                              </timing>
                              <action>
                                <reset_cue cue="L2M02 Scene 6"/>
                              </action>
                            </cue>
                            <cue name="L2M02 Sc6 St2">
                              <condition>
                                <cue_completed cue="L2M02 Sc6 St1 End"/>
                              </condition>
                              <action>
                                <play_text actor="L2M02.TeSaat" textid="282503" priority="99"/>
                              </action>
                              <cues>
                                <cue name="L2M02 Sc6 St2 OBS Finished"/>
                                <cue ref="OBS">
                                  <params>
                                    <param name="OBS Cue" value="L2M02 Sc6 St2"/>
                                    <param name="OBS Cancel Cue" value="L2M02 Sc6 St2 OBS Finished"/>
                                    <param name="OBS Fleet Group Name" value="3 Enemies"/>
                                    <param name="OBSFleetRace" value="{lookup.race@khaak}"/>
                                    <param name="OBSFleetPilotsRace" value="{lookup.race@khaak}"/>
                                    <param name="OBSMissionRank" value="{player.fightrank.rank}"/>
                                    <param name="OBSDifficultyRank" value="{lookup.level@veryhard}"/>
                                    <param name="OBSSector" value="{object.sector@L2M02.Base}"/>
                                    <param name="OBSPosition" value="500*10000"/>
                                    <param name="OBSFleetPositionObject" value="L2M02.Base"/>
                                    <param name="OBS Dock Support" value="1"/>
                                    <param name="OBS Support Overflow" value="0"/>
                                    <param name="OBSFleetRelation" value="-1"/>
                                    <param name="OBS PointsMin" value="2*({value@Constant {lookup.class@m2} Points}+{value@Constant {lookup.class@m6} Points})-1"/>
                                    <param name="OBS PointsMax" value="4*{value@Constant {lookup.class@m2} Points}"/>
                                  </params>
                                </cue>
                                <cue ref="L0M35 B">
                                  <params>
                                    <param name="Cue" value="L2M02 Scene 6"/>
                                    <param name="ID" value="3"/>
                                    <param name="Step" value="3"/>
                                    <param name="OfferRace" value="{lookup.race@argon}"/>
                                    <param name="EnemyRace" value="{lookup.race@khaak}"/>
                                    <param name="Lv1Guide" value="L2M02.TeSaat"/>
                                    <param name="Object" value="L2M02.Base"/>
                                    <param name="PageID" value="3828"/>
                                    <param name="TextID" value="282503"/>
                                    <param name="StoryID" value="2"/>
                                    <param name="ChapterID" value="204"/>
                                    <param name="Difficulty" value="{lookup.level@veryhard}"/>
                                    <param name="RewardCr" value="L2M02 Scene 6.RewardCr"/>
                                    <param name="Bonus" value="L2M02 Scene 6.RewardBonus"/>
                                    <param name="RoundReward" value="1"/>
                                  </params>
                                </cue>
                                <cue name="L2M02 Sc6 St2 Wait">
                                  <condition>
                                    <check_all>
                                      <cue_is_complete cue="L0M35 B"/>
                                      <cue_is_cancelled cue="L2M02 Sc6 St2 OBS Finished"/>
                                    </check_all>
                                  </condition>
                                  <cues>
                                    <cue ref="L0M35">
                                      <params>
                                        <param name="Cue" value="L2M02 Scene 6"/>
                                        <param name="ID" value="3"/>
                                        <param name="OfferRace" value="{lookup.race@argon}"/>
                                        <param name="EnemyRace" value="{lookup.race@khaak}"/>
                                        <param name="Enemies" value="L2M02 Sc6 St2.3 Enemies"/>
                                        <param name="Lv1Guide" value="L2M02.TeSaat"/>
                                        <param name="PageID" value="3828"/>
                                        <param name="TextID" value="282503"/>
                                        <param name="StoryID" value="2"/>
                                        <param name="ChapterID" value="204"/>
                                        <param name="Difficulty" value="{lookup.level@veryhard}"/>
                                        <param name="RewardCr" value="L2M02 Scene 6.RewardCr"/>
                                        <param name="Bonus" value="L2M02 Scene 6.RewardBonus"/>
                                        <param name="RoundReward" value="1"/>
                                      </params>
                                    </cue>
                                    <cue name="L2M02 Sc6 St2 End" delay="1s">
                                      <condition>
                                        <check_all>
                                          <check_value value="{value@L2M02 Scene 6.3 L0M35 Progress}" min="1"/>
                                        </check_all>
                                      </condition>
                                      <timing>
                                        <time min="1s" max="3s"/>
                                      </timing>
                                      <action>
                                        <do_all>
                                          <remove_briefing cue="L2M02 Scene 6"/>
                                          <do_choose>
                                            <do_when value="{value@L2M02 Scene 6.3 L0M35 Progress}" exact="1">
                                              <play_text actor="L2M02.TeSaat" textid="282604" priority="99"/>
                                              <reward_player>
                                                <money exact="{value@L2M02 Scene 6.RewardCr}+{value@L2M02 Scene 6.RewardBonus}"/>
                                              </reward_player>
                                              <increment_mission_rank name="L2OFF" exact="({player.missionrank.L2OFF}*3)/2"/>
                                              <set_value name="L2M02.PlotProgress" exact="7"/>
                                              <remove_objective cue="L2M02 Scene 6" status="complete"/>
                                              <cancel_cue cue="L2M02 Sc6 St2 Reset"/>
                                            </do_when>
                                            <do_when value="{value@L2M02 Scene 6.3 L0M35 Progress}" exact="99">
                                              <remove_objective cue="L2M02 Scene 6" status="aborted"/>
                                              <play_text actor="L2M02.TeSaat" textid="282603" priority="99"/>
                                              <increment_mission_rank name="L2OFF" exact="-1-{player.missionrank.L2OFF.rank}*2"/>
                                            </do_when>
                                            <do_otherwise>
                                              <remove_objective cue="L2M02 Scene 6" status="failed"/>
                                              <play_text actor="L2M02.TeSaat" textid="282603" priority="99"/>
                                              <increment_mission_rank name="L2OFF" max="-1" min="-1-{player.missionrank.L2OFF.rank}"/>
                                            </do_otherwise>
                                          </do_choose>
                                        </do_all>
                                      </action>
                                      <cues>
                                        <cue name="L2M02 Sc6 St2 Reset">
                                          <condition>
                                            <cue_completed cue="L2M02 Sc6 St1 End"/>
                                          </condition>
                                          <timing>
                                            <time min="1500s" max="1800s"/>
                                          </timing>
                                          <action>
                                            <reset_cue cue="L2M02 Scene 6"/>
                                          </action>
                                        </cue>
                                      </cues>
                                    </cue>
                                  </cues>
                                </cue>
                              </cues>
                            </cue>
                          </cues>
                        </cue>
                      </cues>
                    </cue>
                  </cues>
                </cue>
              </cues>
            </cue>
            <cue name="L2M02 Scene 7" delay="20003">
              <condition>
                <check_value value="{value@L2M02.PlotProgress}" exact="7"/>
              </condition>
              <timing>
                <time min="120s" max="300s"/>
              </timing>
              <action>
                <do_all>
                  <incoming_message author="{actor.name@L2M02.TeSaat}" text="{3895,282605}"/>
                  <set_objective cue="L2M02 Scene 7" story="{3200,2}" chapter="{3200,205}" title="{3202,11}" text="{3828,282501}">
                    <mission discipline="XXXT" level="veryeasy"/>
                    <dockat object="L2M02.Base"/>
                  </set_objective>
                  <create_briefing cue="L2M02 Scene 7" story="{3200,2}" chapter="{3200,205}" title="{3202,11}" text="{3828,282501}">
                    <mission discipline="XXXT" level="veryeasy"/>
                    <objectives>
                      <objective step="1">
                        <dockat object="L2M02.Base"/>
                      </objective>
                    </objectives>
                  </create_briefing>
                </do_all>
              </action>
              <cues>
                <cue name="L2M02 Sc7 Docked At Base" delay="5s">
                  <condition>
                    <check_all>
                      <cue_is_complete cue="L2M02 Scene 7"/>
                      <object_is_docked dockobject="L2M02.Base"/>
                    </check_all>
                  </condition>
                  <timing>
                    <time exact="10s"/>
                  </timing>
                  <action>
                    <play_text actor="L2M02.TeSaat" textid="282702" priority="99"/>
                  </action>
                  <cues>
                    <cue name="L2M02 Sc7 Docked At Base Wait">
                      <condition>
                        <cue_completed cue="L2M02 Sc7 Docked At Base"/>
                      </condition>
                      <timing>
                        <time exact="{text.duration@3828,282702}+2s"/>
                      </timing>
                      <action>
                        <do_all>
                          <incoming_message silent="1" author="{actor.name@L2M02.TeSaat}" text="{3828,282702}"/>
                          <set_objective cue="L2M02 Scene 7" title="{3202,11}" text="{3828,282702}">
                            <briefing cue="L2M02 Scene 7" step="2"/>
                            <mission discipline="XFXX" level="veryhard"/>
                            <flyto>
                              <sector sector="L2M02.KhaakSec3"/>
                            </flyto>
                          </set_objective>
                          <create_briefing cue="L2M02 Scene 7" text="{3828,282702}" background="sector_khaak_hive..tga">
                            <mission discipline="XFXX" level="veryhard"/>
                            <objectives>
                              <objective step="2">
                                <flyto>
                                  <sector sector="L2M02.KhaakSec3"/>
                                </flyto>
                              </objective>
                            </objectives>
                          </create_briefing>
                          <reward_player>
                            <map>
                              <sector sector="L2M02.KhaakSec3"/>
                            </map>
                          </reward_player>
                        </do_all>
                      </action>
                      <cues>
                        <cue name="L2M02 Sc7 Enter Hive">
                          <condition>
                            <!--Al - could be simplified to: 
                                    <object_changed_sector param="{sector@L2M02.KhaakSec3}"/>?-->
                            <check_all>
                              <object_changed_sector/>
                              <check_value value="{player.sector}" exact="{sector@L2M02.KhaakSec3}"/>
                            </check_all>
                          </condition>
                          <action>
                            <do_all>
                              <do_all exact="2">
                                <create_ship typename="SS_SH_S_M7" race="split" boardable="0" warp="1">
                                  <position min="3km" max="7km"/>
                                  <sector sector="L2M02.KhaakSec3"/>
                                  <equipment loadout="maximum"/>
                                  <command command="killenemies"/>
                                </create_ship>
                                <create_ship typename="SS_SH_S_M7M" race="split" boardable="0" warp="1">
                                  <position min="3km" max="7km"/>
                                  <sector sector="L2M02.KhaakSec3"/>
                                  <equipment loadout="maximum"/>
                                  <command command="killenemies"/>
                                </create_ship>
                                <create_ship typename="SS_SH_T_M7" race="teladi" boardable="0" warp="1">
                                  <position min="3km" max="7km"/>
                                  <sector sector="L2M02.KhaakSec3"/>
                                  <equipment loadout="maximum"/>
                                  <command command="killenemies"/>
                                </create_ship>
                              </do_all>
                              <do_all exact="10">
                                <create_ship typename="{random.type@SS_SH_S_M3|SS_SH_S_M3P|SS_SH_S_M3_1|SS_SH_S_M3_2}" race="split" capturable="0" warp="1">
                                  <position min="3km" max="7km"/>
                                  <sector sector="L2M02.KhaakSec3"/>
                                  <equipment loadout="maximum"/>
                                  <command command="killenemies"/>
                                </create_ship>
                                <create_ship typename="{random.type@SS_SH_T_M3|SS_SH_T_M3P|SS_SH_T_M3_1|SS_SH_T_M3_2}" race="teladi" capturable="0" warp="1">
                                  <position min="3km" max="7km"/>
                                  <sector sector="L2M02.KhaakSec3"/>
                                  <equipment loadout="maximum"/>
                                  <command command="killenemies"/>
                                </create_ship>
                              </do_all>
                              <do_all exact="3">
                                <create_station typename="SS_DOCK_K" race="khaak" group="L2M02 Scene 7.K Stations" invincible="1">
                                  <position min="10km" max="30km"/>
                                  <sector sector="L2M02.KhaakSec3"/>
                                </create_station>
                              </do_all>
                              <do_all exact="{group.object.count@L2M02 Scene 7.K Stations}" counter="count">
                                <do_all exact="3">
                                  <create_ship typename="SS_SH_K_HIVEGUARD" group="L2M02 Scene 7.Guardian {group.object.{counter@count}@L2M02 Scene 7.K Stations}" race="khaak">
                                    <position object="{group.object.{counter@count}@L2M02 Scene 7.K Stations}" min="1km" max="3km"/>
                                    <sector sector="L2M02.KhaakSec3"/>
                                    <equipment loadout="maximum"/>
                                    <command command="killenemies"/>
                                  </create_ship>
                                </do_all>
                              </do_all>
                              <set_objective cue="L2M02 Scene 7" title="{3202,11}">
                                <briefing cue="L2M02 Scene 7" step="3"/>
                                <custom action="{35,2004}" icon="destroy" text="{17,16241}"/>
                              </set_objective>
                              <create_briefing cue="L2M02 Scene 7" background="space_blueish.tga">
                                <objectives>
                                  <objective step="3">
                                    <custom action="{35,2004}" icon="destroy" text="{17,16241}"/>
                                  </objective>
                                </objectives>
                              </create_briefing>
                            </do_all>
                          </action>
                          <cues>
                            <cue name="L2M02 Scene 7 Guidance Update" delay="9s" instantiate="static">
                              <condition>
                                <check_any>
                                  <check_all>
                                    <check_value value="{group.object.count@L2M02 Scene 7.Guardian {group.nearest@L2M02 Scene 7.K Stations}}" min="1"/>
                                    <check_any>
                                      <object_exists object="L2M02 Scene 7.LastGuard" negate="1"/>
                                      <check_value value="{group.nearest@L2M02 Scene 7.Guardian {group.nearest@L2M02 Scene 7.K Stations}}" exact="{object@L2M02 Scene 7.LastGuard}" negate="1"/>
                                    </check_any>
                                  </check_all>
                                  <check_all>
                                    <check_value value="{group.object.count@L2M02 Scene 7.Guardian {group.nearest@L2M02 Scene 7.K Stations}}" exact="0"/>
                                    <check_any>
                                      <object_exists object="L2M02 Scene 7.LastStation" negate="1"/>
                                      <check_value value="{group.nearest@L2M02 Scene 7.K Stations}" exact="{object@L2M02 Scene 7.LastStation}" negate="1"/>
                                    </check_any>
                                  </check_all>
                                </check_any>
                              </condition>
                              <action>
                                <do_choose>
                                  <do_when value="{group.object.count@L2M02 Scene 7.Guardian {group.nearest@L2M02 Scene 7.K Stations}}" min="1">
                                    <remove_object object="L2M02 Scene 7.LastStation"/>
                                    <set_object name="L2M02 Scene 7.LastGuard" value="{group.nearest@L2M02 Scene 7.Guardian {group.nearest@L2M02 Scene 7.K Stations}}"/>
                                    <set_objective cue="L2M02 Scene 7">
                                      <briefing cue="L2M02 Scene 7" step="3"/>
                                      <destroy object="L2M02 Scene 7.LastGuard"/>
                                    </set_objective>
                                  </do_when>
                                  <do_otherwise>
                                    <set_object name="L2M02 Scene 7.LastStation" value="{group.nearest@L2M02 Scene 7.K Stations}"/>
                                    <set_invincible object="L2M02 Scene 7.LastStation" invincible="0"/>
                                    <set_objective cue="L2M02 Scene 7">
                                      <briefing cue="L2M02 Scene 7" step="3"/>
                                      <destroy object="L2M02 Scene 7.LastStation"/>
                                    </set_objective>
                                  </do_otherwise>
                                </do_choose>
                              </action>
                            </cue>
                            <cue name="L2M02 Scene 7 Stations Destroyed" delay="1s">
                              <condition>
                                <check_value value="{group.object.count@L2M02 Scene 7.K Stations}" exact="0"/>
                              </condition>
                              <action>
                                <play_movie movieid="8130"/>
                              </action>
                              <cues>
                                <cue name="L2M02 Scene 7 Stations Destroyed Wait">
                                  <condition>
                                    <cue_completed cue="L2M02 Scene 7 Stations Destroyed"/>
                                  </condition>
                                  <timing>
                                    <time exact="11s"/>
                                  </timing>
                                  <action>
                                    <do_all>
                                      <find_ship group="this.Khaak" multiple="1" race="khaak" max="20">
                                        <position object="{player.ship}"/>
                                        <sector sector="L2M02.KhaakSec3"/>
                                        <distance max="5km"/>
                                      </find_ship>
                                      <destroy_group group="this.Khaak" explosion="1"/>
                                      <remove_briefing cue="L2M02 Scene 7"/>
                                      <remove_objective cue="L2M02 Scene 7" status="complete"/>
                                      <set_race_aggression race="khaak" exact="0" comment="Stop Kha'ak respawning"/>
                                      <play_text actor="L2M02.TeSaat" textid="282703" priority="99"/>
                                      <incoming_message silent="1" author="{actor.name@L2M02.TeSaat}" text="{3828,282703}"/>
                                      <destroy_actor actor="L2M02.TeSaat"/>
                                      <cancel_cue cue="L2M02 Scene 7"/>
                                    </do_all>
                                  </action>
                                </cue>
                              </cues>
                            </cue>
                          </cues>
                        </cue>
                      </cues>
                    </cue>
                  </cues>
                </cue>
              </cues>
            </cue>
            <cue name="L2M02 Military Sector">
              <condition>
                <cue_is_complete cue="L2M02"/>
              </condition>
              <action>
                <do_all>
                  <set_value name="L2 Sector {sector@L2M02.MS148} No Access" exact="1"/>
                  <find_station group="L2M02.Military Stations" multiple="1" max="999">
                    <sector sector="L2M02.MS148"/>
                    <jumps exact="0"/>
                  </find_station>
                  <set_group_relation group="L2M02.Military Stations">
                    <relation mutual="0" relation="enemy"/>
                  </set_group_relation>
                  <do_all exact="{group.object.count@L2M02.Military Stations}" counter="num">
                    <set_value name="L2 Station {group.object.{counter@num}@L2M02.Military Stations} No Access" exact="1"/>
                  </do_all>
                </do_all>
              </action>
              <cues>
                <cue name="L2M02 MS Entered" instantiate="static">
                  <condition>
                    <object_changed_sector param="{sector@L2M02.MS148}"/>
                  </condition>
                  <timing>
                    <time min="5s" max="7s"/>
                  </timing>
                  <action>
                    <do_choose>
                      <do_when value="{value@L2 Sector {sector@L2M02.MS148} No Access}" exact="1">
                        <!--NEED voiceflags = 16 working?
                        <do_if value="{actor.exists@L2M02.WarningActor1}" exact="1" negate="1">
                          <create_actor name="L2M02.WarningActor1" race="argon" voice="116"/>
                        </do_if>
                        <do_if value="{actor.exists@L2M02.WarningActor3}" exact="1" negate="1">
                          <create_actor name="L2M02.WarningActor3" race="split" voice="316"/>
                        </do_if>
                        -->
                        <do_any>
                          <do_all>
                            <set_value name="L2M02 MS Entered.Argon" exact="100"/>
                            <set_value name="L2M02 MS Entered.Split" exact="0"/>
                          </do_all>
                          <do_all>
                            <set_value name="L2M02 MS Entered.Argon" exact="0"/>
                            <set_value name="L2M02 MS Entered.Split" exact="100"/>
                          </do_all>
                        </do_any>
                        <do_any>
                          <play_text pageid="116" textid="650" chance="{value@L2M02 MS Entered.Argon}" priority="99"/>
                          <play_text pageid="316" textid="650" chance="{value@L2M02 MS Entered.Split}" priority="99"/>
                        </do_any>
                      </do_when>
                      <do_otherwise>
                        <cancel_cue cue="L2M02 MS Response"/>
                      </do_otherwise>
                    </do_choose>
                  </action>
                  <cues>
                    <cue name="L2M02 MS Response">
                      <condition>
                        <cue_completed cue="L2M02 MS Entered"/>
                      </condition>
                      <timing>
                        <time min="25s" max="35s"/>
                      </timing>
                      <action>
                        <do_choose>
                          <do_when value="{player.sector}" exact="{sector@L2M02.MS148}">
                            <do_any>
                              <play_text pageid="109" textid="12" chance="{value@L2M02 MS Entered.Argon}" priority="99"/>
                              <play_text pageid="310" textid="12" chance="{value@L2M02 MS Entered.Split}" priority="99"/>
                            </do_any>
                          </do_when>
                          <do_otherwise>
                            <cancel_cue cue="L2M02 MS Response"/>
                          </do_otherwise>
                        </do_choose>
                      </action>
                      <cues>
                        <cue name="L2M02 MS Wave" instantiate="static" delay="600s">
                          <action>
                            <do_if value="{group.object.count@L2M02 Military Sector.Fleet}" min="12">
                              <do_if value="{group.strongest.isclass.hugeship@L2M02 Military Sector.Fleet}" exact="1">
                                <cancel_cue cue="OBS"/>
                                <cancel_cue cue="L2M02 MS OBS Finished"/>
                              </do_if>
                            </do_if>
                          </action>
                          <cues>
                            <cue name="L2M02 MS OBS Finished"/>
                            <cue ref="OBS">
                              <params>
                                <param name="OBS Cue" value="L2M02 Military Sector"/>
                                <param name="OBS Cancel Cue" value="L2M02 MS OBS Finished"/>
                                <param name="OBS Fleet Group Name" value="Fleet"/>
                                <param name="OBSFleetRace" value="{lookup.race@argon}"/>
                                <param name="OBSFleetPilotsRace" value="{lookup.race@argon}"/>
                                <param name="OBSMissionRank" value="10"/>
                                <param name="OBSDifficultyRank" value="{lookup.level@impossible}"/>
                                <param name="OBSSector" value="{sector@L2M02.MS148}"/>
                                <param name="OBS X" value="0"/>
                                <param name="OBS Y" value="0"/>
                                <param name="OBS Z" value="0"/>
                                <param name="OBSPosition" value="1"/>
                                <param name="OBSFleetCapturable" value="0"/>
                                <param name="OBSFleetCommunicates" value="0"/>
                                <param name="OBSFleetCovered" value="0"/>
                                <param name="OBS Dock Support" value="1"/>
                                <param name="OBS Support Overflow" value="1"/>
                              </params>
                            </cue>
                            <cue name="L2M02 MS Wave Created">
                              <condition>
                                <cue_cancelled cue="L2M02 MS OBS Finished"/>
                              </condition>
                              <action>
                                <set_group_command group="L2M02 Military Sector.Fleet" command="attack"/>
                              </action>
                            </cue>
                          </cues>
                        </cue>
                      </cues>
                    </cue>
                    <cue name="L2M02 MS Left" delay="2s">
                      <condition>
                        <object_sector exact="0" negate="1">
                          <sector sector="L2M02.MS148"/>
                        </object_sector>
                      </condition>
                      <action>
                        <do_all>
                          <set_group_command group="L2M02 Military Sector.Fleet" command="dock" commandobject="L2M02.Base"/>
                          <cancel_cue cue="L2M02 MS Response"/>
                        </do_all>
                      </action>
                    </cue>
                  </cues>
                </cue>
                <cue name="L2M02 MS Remove Ship" instantiate="static">
                  <condition>
                    <any_object_docked group="L2M02 Military Sector.ResponseFleet"/>
                  </condition>
                  <action>
                    <do_if value="{event.object.dockobject.isclass.shipyard}" exact="1">
                      <destroy_object object="{event.object}" explosion="0" warp="0"/>
                    </do_if>
                  </action>
                </cue>
                <cue name="L2M02 MS Access Granted" delay="5s">
                  <condition>
                    <check_value value="{value@L2 Sector {sector@L2M02.MS148} No Access}" exact="2"/>
                  </condition>
                  <action>
                    <do_all>
                      <cancel_cue cue="L2M02 MS Entered"/>
                      <set_group_command group="L2M02 Military Sector.Fleet" command="dock" commandobject="L2M02.Base"/>
                    </do_all>
                  </action>
                  <cues>
                    <cue name="L2M02 MS Finished" delay="10s">
                      <condition>
                        <check_value value="{group.object.count@L2M02 Military Sector.Fleet}" exact="0"/>
                      </condition>
                      <timing>
                        <time exact="1s"/>
                      </timing>
                      <action>
                        <cancel_cue cue="L2M02 Military Sector"/>
                      </action>
                    </cue>
                  </cues>
                </cue>
              </cues>
            </cue>
            <cue name="L2M02 Unknown Sector">
              <condition>
                <cue_is_complete cue="L2M02"/>
              </condition>
              <cues>
                <cue name="L2M02 US Create" delay="360s" instantiate="static">
                  <condition>
                    <count_ships race="khaak" class="ship" max="{value@L2M02.USKhaakAmt}">
                      <sector sector="L2M02.UnkSec"/>
                      <jumps exact="0"/>
                    </count_ships>
                  </condition>
                  <action>
                    <do_all>
                      <set_value name="L2M02 US Create.Rank" min="2" max="5" profile="decreasing"/>
                      <do_any>
                        <!--bewteen roids 1 and 2-->
                        <create_spacefly name="L2M02 US Create.Spacefly" chance="40">
                          <position x="10km" y="0km" z="40km" min="5km" max="25km"/>
                          <sector sector="L2M02.UnkSec"/>
                        </create_spacefly>
                        <!--towards roid 3-->
                        <create_spacefly name="L2M02 US Create.Spacefly" chance="20">
                          <position x="-50km" y="-2km" z="-25km" height="10km" min="5km" max="25km"/>
                          <sector sector="L2M02.UnkSec"/>
                        </create_spacefly>
                        <!--in the sector centre-->
                        <create_spacefly name="L2M02 US Create.Spacefly" chance="20">
                          <position x="-15km" y="0" z="15km" min="5km" max="15km"/>
                          <sector sector="L2M02.UnkSec"/>
                        </create_spacefly>
                        <!--near north west asteroid group-->
                        <create_spacefly name="L2M02 US Create.Spacefly" chance="10">
                          <position x="-55km" y="10km" z="45km" height="10km" min="10km" max="20km"/>
                          <sector sector="L2M02.UnkSec"/>
                        </create_spacefly>
                        <!--spread out-->
                        <create_spacefly name="L2M02 US Create.Spacefly" chance="10">
                          <position x="0" y="0" z="0" min="5km" max="45km"/>
                          <sector sector="L2M02.UnkSec"/>
                        </create_spacefly>
                      </do_any>
                      <!--we now limit it to small ship when the player is not about-->
                      <set_value name="L2M02 US Create.Limit" exact="(3*{value@Constant {lookup.class@m3} Points})-1"/>
                      <do_if value="{player.sector}" exact="{sector@L2M02.UnkSec}" chance="20">
                        <!--if player is in sector we sometimes allow a corvette to jump in-->
                        <set_value name="L2M02 US Create.Limit" exact="(2*{value@Constant {lookup.class@m6} Points})-1"/>
                        <!--small chance we allow the khaak ships to jump in near the player to keep it interesting-->
                        <warp_object object="L2M02 US Create.Spacefly" chance="30">
                          <position object="{player.ship}" min="4km" max="10km"/>
                          <sector sector="L2M02.UnkSec"/>
                        </warp_object>
                      </do_if>
                    </do_all>
                  </action>
                  <cues>
                    <cue name="L2M02 US OBS Finished"/>
                    <cue ref="OBS">
                      <params>
                        <param name="OBS Cue" value="L2M02 Unknown Sector"/>
                        <param name="OBS Cancel Cue" value="L2M02 US OBS Finished"/>
                        <param name="OBS Fleet Group Name" value="Fleet"/>
                        <param name="OBSFleetRace" value="{lookup.race@khaak}"/>
                        <param name="OBSFleetPilotsRace" value="{lookup.race@khaak}"/>
                        <param name="OBSMissionRank" value="{value@L2M02 US Create.Rank}"/>
                        <param name="OBSDifficultyRank" value="{lookup.level@easy}"/>
                        <param name="OBSFleetPositionObject" value="L2M02 US Create.Spacefly"/>
                        <param name="OBSSector" value="L2M02.UnkSec"/>
                        <param name="OBSPosition" value="500m"/>
                        <param name="OBSFleetCapturable" value="0"/>
                        <param name="OBSFleetCommunicates" value="0"/>
                        <param name="OBS Dock Support" value="1"/>
                        <param name="OBS Support Overflow" value="1"/>
                        <param name="OBS PointsMax" value="{value@L2M02 US Create.Limit}"/>
                      </params>
                    </cue>
                    <cue name="L2M02 US Finish">
                      <condition>
                        <cue_cancelled cue="L2M02 US OBS Finished"/>
                      </condition>
                      <action>
                        <do_all>
                          <set_group_command group="L2M02 Unknown Sector.Fleet" command="killenemies"/>
                          <!--remove group as we dont need to track them after created, are counted above-->
                          <remove_group group="L2M02 Unknown Sector.Fleet"/>
                          <destroy_object object="L2M02 US Create.Spacefly" warp="1"/>
                        </do_all>
                      </action>
                      <cues>
                        <cue name="L2M02 US Reset">
                          <timing>
                            <time min="120s" max="400s"/>
                          </timing>
                          <action>
                            <do_all>
                              <reset_cue cue="L2M02 US Create"/>
                            </do_all>
                          </action>
                        </cue>
                      </cues>
                    </cue>
                  </cues>
                </cue>
              </cues>
            </cue>
          </cues>
        </cue>
      </cues>
    </cue>
  </cues>
  <signature>6fbzHw5pGQcIz+2yPNStCD0M/xvt3lmimVJtyKWA7nV4TSBcDDfPJM6PeztVCRkeBGBgl+r3LOfUtH7hTEUZ7TiknVB1UAM69f99D59IcqKIBLl9vKmsRx1XAO0cQfOuq8W4r1RS50tAzaWdQji9mvvgdzhVM6cdohC9Krk/OjiSO1aoPMXSBWiqz4LyTbCs7EEuQGQltm4NUFZLqNUxncuYFDy0MKYcl/23M3Wl9qZnuVv9QE2iEZOc9MLkqKDrE8q/b7AnDW4npqcR2Lccf33sDb/7o2hE0lmiO6BuRaFBshYabRyuYTYwv1G80ax2KKAv5z1RRwcDPtJ80M4ObA==</signature>
</director>


